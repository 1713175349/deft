// -*- mode: C++; -*-

#include "MinimalFunctionals.h"
#include "utilities.h"
#include "handymath.h"


class WaterSaft_type : public FunctionalInterface {
public:
WaterSaft_type(double R_arg, double epsilon_association_arg, double kappa_association_arg, double epsilon_dispersion_arg, double lambda_dispersion_arg, double length_scaling_arg, double mu_arg) : R(R_arg), epsilon_association(epsilon_association_arg), kappa_association(kappa_association_arg), epsilon_dispersion(epsilon_dispersion_arg), lambda_dispersion(lambda_dispersion_arg), length_scaling(length_scaling_arg), mu(mu_arg)  {
	have_integral = true;
	// TODO: code to evaluate Fourier transforms goes here
	oldkT = sqrt(-1.0);  // initialize to NaN so we'll have to define transforms

}
~WaterSaft_type() {

}

bool I_have_analytic_grad() const {
	return false;}

double integral(const GridDescription &gd, double kT, const VectorXd &x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output=0;
	VectorXcd ktemp0(gd.NxNyNzOver2);
	ktemp0 = fft(gd, x);

	VectorXcd ktemp1(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp1[0] = 50.26548245743669*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp1[i] = 25.132741228718345*R*ktemp0[i]*sin(2.0*R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp2(gd.NxNyNz);
	rtemp2 = ifft(gd, ktemp1);

	ktemp1.resize(0); // KSpace
	VectorXcd ktemp3(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp3[0] = ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		ktemp3[i] = ktemp0[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*(0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0]));
	}

	VectorXd rtemp4(gd.NxNyNz);
	rtemp4 = ifft(gd, ktemp3);

	ktemp3.resize(0); // KSpace
	VectorXcd ktemp5(gd.NxNyNzOver2);
	ktemp5[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp5[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp6(gd.NxNyNz);
	rtemp6 = ifft(gd, ktemp5);

	ktemp5.resize(0); // KSpace
	VectorXcd ktemp7(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp7[0] = 4.188790204786391*R*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp7[i] = 12.566370614359172*ktemp0[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*t2*cos(t2) + sin(t2))/(sqrt(t1)*t1);
	}

	VectorXd rtemp8(gd.NxNyNz);
	rtemp8 = ifft(gd, ktemp7);

	ktemp7.resize(0); // KSpace
	VectorXd rtemp9(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp9[i] = -1.0*rtemp6[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp10(gd.NxNyNzOver2);
	ktemp10 = fft(gd, rtemp9);

	rtemp9.resize(0); // Realspace
	VectorXcd ktemp11(gd.NxNyNzOver2);
	ktemp11[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp11[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp12(gd.NxNyNz);
	rtemp12 = ifft(gd, ktemp11);

	ktemp11.resize(0); // KSpace
	VectorXd rtemp13(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp13[i] = -1.0*rtemp12[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp14(gd.NxNyNzOver2);
	ktemp14 = fft(gd, rtemp13);

	rtemp13.resize(0); // Realspace
	VectorXcd ktemp15(gd.NxNyNzOver2);
	ktemp15[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp15[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp16(gd.NxNyNz);
	rtemp16 = ifft(gd, ktemp15);

	ktemp15.resize(0); // KSpace
	VectorXd rtemp17(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp17[i] = -1.0*rtemp16[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp18(gd.NxNyNzOver2);
	ktemp18 = fft(gd, rtemp17);

	rtemp17.resize(0); // Realspace
	VectorXd rtemp19(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp19[i] = -1.0*log(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp20(gd.NxNyNzOver2);
	ktemp20 = fft(gd, rtemp19);

		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp0[0] = 12.566370614359172*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp0[i] = 12.566370614359172*R*ktemp0[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp22(gd.NxNyNz);
	rtemp22 = ifft(gd, ktemp0);

	ktemp0.resize(0); // KSpace
	VectorXd rtemp23(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp23[i] = rtemp22[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp24(gd.NxNyNzOver2);
	ktemp24 = fft(gd, rtemp23);

	VectorXd rtemp25(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp25[i] = rtemp6[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp26(gd.NxNyNzOver2);
	ktemp26 = fft(gd, rtemp25);

	rtemp25.resize(0); // Realspace
	VectorXd rtemp27(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp27[i] = rtemp12[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp28(gd.NxNyNzOver2);
	ktemp28 = fft(gd, rtemp27);

	rtemp27.resize(0); // Realspace
	VectorXd rtemp29(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp29[i] = rtemp16[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp30(gd.NxNyNzOver2);
	ktemp30 = fft(gd, rtemp29);

	rtemp29.resize(0); // Realspace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = rtemp12[i]*rtemp12[i];
		const double t3 = rtemp16[i]*rtemp16[i];
		const double t4 = rtemp22[i]*rtemp22[i];
		const double t5 = rtemp6[i]*rtemp6[i];
		const double t6 = 1.0/t1;
		const double t7 = 1.0/rtemp8[i];
		rtemp23[i] = t7*t7*rtemp23[i]*(-3.0*t5 + t4 + -3.0*t3 + -3.0*t2)*(t6*((-1.768388256576615e-2*t7 + 1.768388256576615e-2*t6)*(log(t1)/(t6*t6) + rtemp8[i]) + 8.841941282883075e-3) + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i]) + t6*(t6*(-7.957747154594767e-2*t5 + 7.957747154594767e-2*t4 + -7.957747154594767e-2*t3 + -7.957747154594767e-2*t2) + 7.957747154594767e-2*rtemp22[i]/R)/R;
	}

	rtemp19.resize(0); // Realspace
	VectorXcd ktemp32(gd.NxNyNzOver2);
	ktemp32 = fft(gd, rtemp23);

	rtemp23.resize(0); // Realspace
	VectorXd rtemp33(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp33[i] = ((t1*t1*log(t1) + rtemp8[i])*(-2.6525823848649224e-2*rtemp6[i]*rtemp6[i] + 2.6525823848649224e-2*rtemp22[i]*rtemp22[i] + -2.6525823848649224e-2*rtemp16[i]*rtemp16[i] + -2.6525823848649224e-2*rtemp12[i]*rtemp12[i])/(t1*rtemp8[i]*rtemp8[i]) + 7.957747154594767e-2*rtemp22[i]/R)/t1;
	}

	VectorXcd ktemp34(gd.NxNyNzOver2);
	ktemp34 = fft(gd, rtemp33);

	rtemp33.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp34[0] = R*(12.566370614359172*R*ktemp32[i] + 25.132741228718345*ktemp34[i]) + ktemp24[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t2 = 12.566370614359172*sin(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]))/(sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0])) + -12.566370614359172*R*cos(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t3 = ktemp10[i]*k_i[0];
		const complex t4 = ktemp14[i]*k_i[1];
		const complex t5 = ktemp18[i]*k_i[2];
		const complex t6 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t7 = cos(R*sqrt(t6));
		const complex t8 = sin(R*sqrt(t6));
		const complex t9 = R*t7;
		const complex t10 = t8/(sqrt(t6));
		ktemp34[i] = -12.566370614359172*t1*ktemp34[i]*(-1.0*t9 + -1.0*t10) + R*(t1*t8*complex(0,1)*(12.566370614359172*ktemp30[i]*k_i[2]/(sqrt(t6)) + 12.566370614359172*ktemp28[i]*k_i[1]/(sqrt(t6)) + 12.566370614359172*ktemp26[i]*k_i[0]/(sqrt(t6))) + 12.566370614359172*t1*t10*ktemp32[i]) + (t1*t9*ktemp24[i] + R*t1*t8*complex(0,1)*(t5/(sqrt(t6)) + t4/(sqrt(t6)) + t3/(sqrt(t6))) + t1*(-7.957747154594767e-2*t2*ktemp20[i] + -6.332573977646112e-3*t2*complex(0,1)*(12.566370614359172*t5 + 12.566370614359172*t4 + 12.566370614359172*t3)/t6)/R)/R;
	}

	ktemp32.resize(0); // KSpace
	ktemp30.resize(0); // KSpace
	ktemp28.resize(0); // KSpace
	ktemp26.resize(0); // KSpace
	ktemp24.resize(0); // KSpace
	ktemp20.resize(0); // KSpace
	ktemp18.resize(0); // KSpace
	ktemp14.resize(0); // KSpace
	ktemp10.resize(0); // KSpace
	VectorXd rtemp36(gd.NxNyNz);
	rtemp36 = ifft(gd, ktemp34);

	ktemp34.resize(0); // KSpace
	double 	s37 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s37 += gd.dvolume*kT*x[i]*(-6.283185307179586*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)) + 0.5*1.0 + log(12.566370614359172*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT))));
	}

	rtemp36.resize(0); // Realspace
	rtemp2.resize(0); // Realspace
	Fassoc = 4.0*s37;
	double 	s38 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s38 += R*R*R*epsilon_dispersion*gd.dvolume*rtemp4[i]*x[i]*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0));
	}

	a1integrated = -4.1887902047863905*s38;
	double 	s39 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s39 += R*R*R*epsilon_dispersion*epsilon_dispersion*gd.dvolume*rtemp4[i]*x[i]*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)*((-4.1887902047863905*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i] + 1.0))*((-4.1887902047863905*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i] + 1.0))/(kT*(4.0*(4.1887902047863905*R*R*R*rtemp4[i])*(4.1887902047863905*R*R*R*rtemp4[i]) + 16.755160819145562*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0));
	}

	rtemp4.resize(0); // Realspace
	a2integrated = 2.0943951023931953*s39;
	Fdisp = a2integrated + a1integrated;
	double 	s40 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s40 += gd.dvolume*kT*x[i]*(-1.0*1.0 + log(2.646476976618268e-6*x[i]/(sqrt(kT)*kT)));
	}

	Fideal = s40;
	double 	s41 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s41 += gd.dvolume*kT*rtemp22[i]*log(1.0 + -1.0*rtemp8[i])/(R*R);
	}

	kTphi1 = -7.957747154594767e-2*s41;
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp16[i] = -7.957747154594767e-2*rtemp16[i]*rtemp16[i] + -7.957747154594767e-2*rtemp12[i]*rtemp12[i];
	}

	rtemp12.resize(0); // Realspace
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp16[i] = -7.957747154594767e-2*rtemp6[i]*rtemp6[i] + rtemp16[i];
	}

	rtemp6.resize(0); // Realspace
	double 	s44 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s44 += gd.dvolume*kT*(7.957747154594767e-2*rtemp22[i]*rtemp22[i] + rtemp16[i])/(R*(1.0 + -1.0*rtemp8[i]));
	}

	kTphi2 = s44;
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp16[i] = rtemp22[i]*(rtemp22[i]*rtemp22[i] + 37.69911184307752*rtemp16[i]);
	}

	rtemp22.resize(0); // Realspace
	double 	s46 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s46 += gd.dvolume*kT*rtemp16[i]*(log(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]) + rtemp8[i])/(rtemp8[i]*rtemp8[i]*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]));
	}

	rtemp16.resize(0); // Realspace
	rtemp8.resize(0); // Realspace
	kTphi3 = 8.841941282883075e-3*s46;
	whitebear = kTphi3 + kTphi2 + kTphi1;
	double 	s47 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s47 += gd.dvolume*mu*x[i];
	}

	FSAFT = whitebear + s47 + Fideal + Fdisp + Fassoc;
	output = FSAFT;
	// 19 Fourier transform used.
	// 18 temporaries made
	return output;

}

VectorXd transform(const GridDescription &gd, double kT, const VectorXd &x) const {
	assert(0);
}

double transform(double kT, double x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output = 0;
		double 	n = x;
	double 	boltz = -1.0*1.0 + exp(epsilon_association/kT);
	double 	deltak = 12.566370614359172*R*R;
	double 	deltaprime = -25.132741228718345*R;
	double 	n0 = 7.957747154594767e-2*deltak*n/(R*R);
	double 	step = 4.188790204786391*R*R*R;
	double 	n3 = n*step;
	double 	dphi1_by_dn3 = n0/(1.0 + -1.0*n3);
	double 	n1 = 7.957747154594767e-2*deltak*n/R;
	double 	n2 = deltak*n;
	double 	dphi2_by_dn3 = n1*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dphi3_by_dn3 = n2*n2*n2*(1.768388256576615e-2*log(1.0 + -1.0*n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + ((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(1.0 + -1.0*n3) + (-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/n3)/n3)/(1.0 + -1.0*n3);
	double 	dphitot_by_dn3 = dphi3_by_dn3 + dphi2_by_dn3 + dphi1_by_dn3;
	double 	dphitot_by_dn1 = n2/(1.0 + -1.0*n3);
	double 	dphitot_by_dn0 = -1.0*log(1.0 + -1.0*n3);
	double 	dphi2_by_dn2 = n1/(1.0 + -1.0*n3);
	double 	dphi3_by_dn2 = n2*n2*((log(1.0 + -1.0*n3)*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2) + 2.6525823848649224e-2)/n3 + 2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dphitot_by_dn2 = dphi3_by_dn2 + dphi2_by_dn2;
	double 	dAdR = kT*n*(deltaprime*((-7.957747154594767e-2*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/R + -1.0*dphitot_by_dn2) + deltak*((-0.15915494309189535*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/(R*R) + dphitot_by_dn3));
	double 	deltak2 = 50.26548245743669*R*R;
	double 	gSigmaA = dAdR/(deltak2*kT*n*n);
	double 	eta_d = 4.1887902047863905*R*R*R*n;
	double 	c1 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + 2.25855;
	double 	c2 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
	double 	c3 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576;
	double 	eta_eff = eta_d*(eta_d*(c3*eta_d + c2) + c1);
	double 	ghs = (1.0 + -0.5*eta_eff)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	deta_eff_by_deta_d = eta_d*(3.0*c3*eta_d + 2.0*c2) + c1;
	double 	dghs_by_deta_d = deta_eff_by_deta_d*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_deta_d = epsilon_dispersion*(dghs_by_deta_d*eta_d + ghs)*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	dc1_by_dlambda_dispersion = -1.50349*1.0 + 0.498868*lambda_dispersion;
	double 	dc2_by_dlambda_dispersion = 1.40049*1.0 + -1.655478*lambda_dispersion;
	double 	dc3_by_dlambda_dispersion = -15.0427*1.0 + 10.61654*lambda_dispersion;
	double 	deta_eff_by_dlambda_dispersion = eta_d*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion);
	double 	dghs_by_dlambda_dispersion = deta_eff_by_dlambda_dispersion*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_dlambda_dispersion = epsilon_dispersion*eta_d*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0));
	double 	gSW = (-8.333333333333333e-2*da1_by_dlambda_dispersion*lambda_dispersion/eta_d + 0.25*da1_by_deta_d)/kT + gSigmaA;
	double 	deltasaft = boltz*gSW*kappa_association;
	double 	delta2k = 50.26548245743669*R*R;
	double 	nA = 1.9894367886486918e-2*delta2k*n/(R*R);
	double 	X = (0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA);
	double 	Fassoc = kT*n*(2.0*1.0 + 4.0*log(X) + -2.0*X);
	double 	a1 = epsilon_dispersion*eta_d*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	a1integrated = a1*n;
	double 	KHS = (eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0);
	double 	a2 = 0.5*KHS*da1_by_deta_d*epsilon_dispersion*eta_d;
	double 	a2integrated = a2*n/kT;
	double 	Fdisp = a2integrated + a1integrated;
	double 	Fideal = kT*n*(-1.0*1.0 + log(2.646476976618268e-6*n/(sqrt(kT)*kT)));
	double 	phi1 = -1.0*n0*log(1.0 + -1.0*n3);
	double 	kTphi1 = kT*phi1;
	double 	phi2 = n1*n2/(1.0 + -1.0*n3);
	double 	kTphi2 = kT*phi2;
	double 	phi3 = n2*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	kTphi3 = kT*phi3;
	double 	whitebear = kTphi3 + kTphi2 + kTphi1;
	double 	FSAFT = mu*n + whitebear + Fideal + Fdisp + Fassoc;
	output = FSAFT;

	return output;

}

bool append_to_name( std::string) const {
	return false;}

double derive(double kT, double x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output = 0;
	double 	boltz = -1.0*1.0 + exp(epsilon_association/kT);
	double 	n = x;
	double 	deltak = 12.566370614359172*R*R;
	double 	deltaprime = -25.132741228718345*R;
	double 	n0 = 7.957747154594767e-2*deltak*n/(R*R);
	double 	step = 4.188790204786391*R*R*R;
	double 	n3 = n*step;
	double 	dphi1_by_dn3 = n0/(1.0 + -1.0*n3);
	double 	n1 = 7.957747154594767e-2*deltak*n/R;
	double 	n2 = deltak*n;
	double 	dphi2_by_dn3 = n1*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dphi3_by_dn3 = n2*n2*n2*(1.768388256576615e-2*log(1.0 + -1.0*n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + ((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(1.0 + -1.0*n3) + (-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/n3)/n3)/(1.0 + -1.0*n3);
	double 	dphitot_by_dn3 = dphi3_by_dn3 + dphi2_by_dn3 + dphi1_by_dn3;
	double 	dphitot_by_dn1 = n2/(1.0 + -1.0*n3);
	double 	dphitot_by_dn0 = -1.0*log(1.0 + -1.0*n3);
	double 	dphi2_by_dn2 = n1/(1.0 + -1.0*n3);
	double 	dphi3_by_dn2 = n2*n2*((log(1.0 + -1.0*n3)*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2) + 2.6525823848649224e-2)/n3 + 2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dphitot_by_dn2 = dphi3_by_dn2 + dphi2_by_dn2;
	double 	dAdR = kT*n*(deltaprime*((-7.957747154594767e-2*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/R + -1.0*dphitot_by_dn2) + deltak*((-0.15915494309189535*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/(R*R) + dphitot_by_dn3));
	double 	deltak2 = 50.26548245743669*R*R;
	double 	gSigmaA = dAdR/(deltak2*kT*n*n);
	double 	eta_d = 4.1887902047863905*R*R*R*n;
	double 	c1 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + 2.25855;
	double 	c2 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
	double 	c3 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576;
	double 	eta_eff = eta_d*(eta_d*(c3*eta_d + c2) + c1);
	double 	ghs = (1.0 + -0.5*eta_eff)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	deta_eff_by_deta_d = eta_d*(3.0*c3*eta_d + 2.0*c2) + c1;
	double 	dghs_by_deta_d = deta_eff_by_deta_d*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_deta_d = epsilon_dispersion*(dghs_by_deta_d*eta_d + ghs)*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	dc1_by_dlambda_dispersion = -1.50349*1.0 + 0.498868*lambda_dispersion;
	double 	dc2_by_dlambda_dispersion = 1.40049*1.0 + -1.655478*lambda_dispersion;
	double 	dc3_by_dlambda_dispersion = -15.0427*1.0 + 10.61654*lambda_dispersion;
	double 	deta_eff_by_dlambda_dispersion = eta_d*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion);
	double 	dghs_by_dlambda_dispersion = deta_eff_by_dlambda_dispersion*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_dlambda_dispersion = epsilon_dispersion*eta_d*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0));
	double 	gSW = (-8.333333333333333e-2*da1_by_dlambda_dispersion*lambda_dispersion/eta_d + 0.25*da1_by_deta_d)/kT + gSigmaA;
	double 	deltasaft = boltz*gSW*kappa_association;
	double 	delta2k = 50.26548245743669*R*R;
	double 	nA = 1.9894367886486918e-2*delta2k*n/(R*R);
	double 	X = (0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA);
	double 	dn3_by_dx = step;
	double 	ddphitot_by_dn0_by_dx = dn3_by_dx/(1.0 + -1.0*n3);
	double 	dn2_by_dx = deltak;
	double 	ddphitot_by_dn1_by_dx = dn3_by_dx*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn2_by_dx/(1.0 + -1.0*n3);
	double 	dn1_by_dx = 7.957747154594767e-2*deltak/R;
	double 	ddphi2_by_dn2_by_dx = dn3_by_dx*n1/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn1_by_dx/(1.0 + -1.0*n3);
	double 	ddphi3_by_dn2_by_dx = 2.0*dn3_by_dx*n2*n2*((log(1.0 + -1.0*n3)*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2) + 2.6525823848649224e-2)/n3 + 2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -2.6525823848649224e-2*dn3_by_dx*n2*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*(log(1.0 + -1.0*n3)*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2) + 2.6525823848649224e-2)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -2.6525823848649224e-2*dn3_by_dx*n2*n2*log(1.0 + -1.0*n3)/(n3*n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 2.0*dn2_by_dx*n2*((log(1.0 + -1.0*n3)*(2.6525823848649224e-2*1.0/n3 + -5.305164769729845e-2) + 2.6525823848649224e-2)/n3 + 2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	ddphitot_by_dn2_by_dx = ddphi3_by_dn2_by_dx + ddphi2_by_dn2_by_dx;
	double 	dn0_by_dx = 7.957747154594767e-2*deltak/(R*R);
	double 	ddphi1_by_dn3_by_dx = dn3_by_dx*n0/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn0_by_dx/(1.0 + -1.0*n3);
	double 	ddphi2_by_dn3_by_dx = 2.0*dn3_by_dx*n1*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn2_by_dx*n1/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn1_by_dx*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	ddphi3_by_dn3_by_dx = dn3_by_dx*n2*n2*n2*(1.768388256576615e-2*log(1.0 + -1.0*n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + ((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(1.0 + -1.0*n3) + (-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/n3)/n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.768388256576615e-2*dn3_by_dx*n2*n2*n2/(((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + 3.53677651315323e-2*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/(((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + dn3_by_dx*n2*n2*n2*(1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 1.768388256576615e-2*dn3_by_dx*n2*n2*n2/(n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -3.53677651315323e-2*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/(n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -1.0*dn3_by_dx*n2*n2*n2*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(1.0 + -1.0*n3) + (-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/n3)/(n3*n3*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -8.841941282883075e-3*dn3_by_dx*n2*n2*n2/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)*(1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 1.768388256576615e-2*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/(n3*n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -1.0*dn3_by_dx*n2*n2*n2*(-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/(n3*n3*n3*(1.0 + -1.0*n3)) + 1.768388256576615e-2*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/((n3*n3)*(n3*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 3.0*dn2_by_dx*n2*n2*(1.768388256576615e-2*log(1.0 + -1.0*n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + ((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(1.0 + -1.0*n3) + (-8.841941282883075e-3*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + -1.768388256576615e-2*1.0/n3 + 3.53677651315323e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2) + -8.841941282883075e-3)/n3)/n3)/(1.0 + -1.0*n3);
	double 	ddphitot_by_dn3_by_dx = ddphi3_by_dn3_by_dx + ddphi2_by_dn3_by_dx + ddphi1_by_dn3_by_dx;
	double 	ddAdR_by_dx = kT*(deltaprime*((-7.957747154594767e-2*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/R + -1.0*dphitot_by_dn2) + deltak*((-0.15915494309189535*dphitot_by_dn0/R + -7.957747154594767e-2*dphitot_by_dn1)/(R*R) + dphitot_by_dn3)) + ddphitot_by_dn3_by_dx*deltak*kT*n + -1.0*ddphitot_by_dn2_by_dx*deltaprime*kT*n + -7.957747154594767e-2*ddphitot_by_dn1_by_dx*deltaprime*kT*n/R + -7.957747154594767e-2*ddphitot_by_dn1_by_dx*deltak*kT*n/(R*R) + -7.957747154594767e-2*ddphitot_by_dn0_by_dx*deltaprime*kT*n/(R*R) + -0.15915494309189535*ddphitot_by_dn0_by_dx*deltak*kT*n/(R*R*R);
	double 	dgSigmaA_by_dx = ddAdR_by_dx/(deltak2*kT*n*n) + -2.0*dAdR/(deltak2*kT*n*n*n);
	double 	deta_d_by_dx = 4.1887902047863905*R*R*R;
	double 	ddeta_eff_by_deta_d_by_dx = deta_d_by_dx*(3.0*c3*eta_d + 2.0*c2) + 3.0*c3*deta_d_by_dx*eta_d;
	double 	deta_eff_by_dx = deta_d_by_dx*(eta_d*(c3*eta_d + c2) + c1) + deta_d_by_dx*eta_d*(c3*eta_d + c2) + c3*deta_d_by_dx*eta_d*eta_d;
	double 	ddghs_by_deta_d_by_dx = 3.0*deta_eff_by_deta_d*deta_eff_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + -1.5*deta_eff_by_deta_d*deta_eff_by_dx/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + deta_eff_by_deta_d*deta_eff_by_dx*(3.0*1.0 + -1.5*eta_eff)/((1.0 + -1.0*eta_eff)*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + ddeta_eff_by_deta_d_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	dghs_by_dx = -0.5*deta_eff_by_dx/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)) + 3.0*deta_eff_by_dx*(1.0 + -0.5*eta_eff)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)));
	double 	dda1_by_deta_d_by_dx = dghs_by_dx*epsilon_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + deta_d_by_dx*dghs_by_deta_d*epsilon_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + ddghs_by_deta_d_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	ddeta_eff_by_dlambda_dispersion_by_dx = deta_d_by_dx*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion) + deta_d_by_dx*eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc3_by_dlambda_dispersion*deta_d_by_dx*eta_d*eta_d;
	double 	ddghs_by_dlambda_dispersion_by_dx = 3.0*deta_eff_by_dlambda_dispersion*deta_eff_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + -1.5*deta_eff_by_dlambda_dispersion*deta_eff_by_dx/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + deta_eff_by_dlambda_dispersion*deta_eff_by_dx*(3.0*1.0 + -1.5*eta_eff)/((1.0 + -1.0*eta_eff)*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + ddeta_eff_by_dlambda_dispersion_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	dda1_by_dlambda_dispersion_by_dx = -12.0*dghs_by_dx*epsilon_dispersion*eta_d*lambda_dispersion*lambda_dispersion + deta_d_by_dx*epsilon_dispersion*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0)) + ddghs_by_dlambda_dispersion_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	dgSW_by_dx = -8.333333333333333e-2*dda1_by_dlambda_dispersion_by_dx*lambda_dispersion/(eta_d*kT) + 0.25*dda1_by_deta_d_by_dx/kT + 8.333333333333333e-2*da1_by_dlambda_dispersion*deta_d_by_dx*lambda_dispersion/(eta_d*eta_d*kT) + dgSigmaA_by_dx;
	double 	ddeltasaft_by_dx = boltz*dgSW_by_dx*kappa_association;
	double 	dnA_by_dx = 1.9894367886486918e-2*delta2k/(R*R);
	double 	dX_by_dx = dnA_by_dx/(nA*sqrt(8.0*deltasaft*nA + 1.0)) + -1.0*dnA_by_dx*(0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA*nA) + ddeltasaft_by_dx/(deltasaft*sqrt(8.0*deltasaft*nA + 1.0)) + -1.0*ddeltasaft_by_dx*(0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*deltasaft*nA);
	double 	dFassoc_by_dx = kT*(2.0*1.0 + 4.0*log(X) + -2.0*X) + -2.0*dX_by_dx*kT*n + 4.0*dX_by_dx*kT*n/X;
	double 	a1 = epsilon_dispersion*eta_d*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	da1_by_dx = dghs_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + deta_d_by_dx*epsilon_dispersion*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	da1integrated_by_dx = da1_by_dx*n + a1;
	double 	KHS = (eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0);
	double 	a2 = 0.5*KHS*da1_by_deta_d*epsilon_dispersion*eta_d;
	double 	dKHS_by_dx = deta_d_by_dx*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + -1.0*deta_d_by_dx*(4.0*1.0 + 4.0*eta_d)*(eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/((eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)*(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)) + deta_d_by_dx*eta_d*eta_d*eta_d/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + deta_d_by_dx*eta_d*eta_d*(-4.0*1.0 + eta_d)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + deta_d_by_dx*eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + -4.0*deta_d_by_dx*eta_d*(eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/((eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)*(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0));
	double 	da2_by_dx = 0.5*dKHS_by_dx*da1_by_deta_d*epsilon_dispersion*eta_d + 0.5*KHS*dda1_by_deta_d_by_dx*epsilon_dispersion*eta_d + 0.5*KHS*da1_by_deta_d*deta_d_by_dx*epsilon_dispersion;
	double 	da2integrated_by_dx = da2_by_dx*n/kT + a2/kT;
	double 	dFdisp_by_dx = da2integrated_by_dx + da1integrated_by_dx;
	double 	dFideal_by_dx = kT*(-1.0*1.0 + log(2.646476976618268e-6*n/(sqrt(kT)*kT))) + kT;
	double 	dphi1_by_dx = dn3_by_dx*n0/(1.0 + -1.0*n3) + -1.0*dn0_by_dx*log(1.0 + -1.0*n3);
	double 	dkTphi1_by_dx = dphi1_by_dx*kT;
	double 	dphi2_by_dx = dn3_by_dx*n1*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn2_by_dx*n1/(1.0 + -1.0*n3) + dn1_by_dx*n2/(1.0 + -1.0*n3);
	double 	dkTphi2_by_dx = dphi2_by_dx*kT;
	double 	dphi3_by_dx = 2.0*dn3_by_dx*n2*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -8.841941282883075e-3*dn3_by_dx*n2*n2*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*(log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -8.841941282883075e-3*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/(n3*n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 3.0*dn2_by_dx*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dkTphi3_by_dx = dphi3_by_dx*kT;
	double 	dwhitebear_by_dx = dkTphi3_by_dx + dkTphi2_by_dx + dkTphi1_by_dx;
	double 	dFSAFT_by_dx = mu + dwhitebear_by_dx + dFideal_by_dx + dFdisp_by_dx + dFassoc_by_dx;
	output = dFSAFT_by_dx;

	return output;

}

double d_by_dT(double , double ) const {
	assert(0); // fail
	return 0;

}

Functional grad(const Functional &ingrad, const Functional &x, bool ) const {
	return ingrad;}

Functional grad_T(const Functional &ingradT) const {
	return ingradT;}

void grad(const GridDescription &gd, double kT, const VectorXd &x, const VectorXd &ingrad, VectorXd *outgrad, VectorXd *outpgrad) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	VectorXcd ktemp0(gd.NxNyNzOver2);
	ktemp0 = fft(gd, x);

	VectorXcd ktemp1(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp1[0] = 50.26548245743669*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp1[i] = 25.132741228718345*R*ktemp0[i]*sin(2.0*R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp2(gd.NxNyNz);
	rtemp2 = ifft(gd, ktemp1);

	ktemp1.resize(0); // KSpace
	VectorXcd ktemp3(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp3[0] = ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		ktemp3[i] = ktemp0[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*(0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0]));
	}

	VectorXd rtemp4(gd.NxNyNz);
	rtemp4 = ifft(gd, ktemp3);

	ktemp3.resize(0); // KSpace
	VectorXcd ktemp5(gd.NxNyNzOver2);
	ktemp5[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp5[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp6(gd.NxNyNz);
	rtemp6 = ifft(gd, ktemp5);

	ktemp5.resize(0); // KSpace
	VectorXcd ktemp7(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp7[0] = 4.188790204786391*R*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp7[i] = 12.566370614359172*ktemp0[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*t2*cos(t2) + sin(t2))/(sqrt(t1)*t1);
	}

	VectorXd rtemp8(gd.NxNyNz);
	rtemp8 = ifft(gd, ktemp7);

	ktemp7.resize(0); // KSpace
	VectorXd rtemp9(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp9[i] = -1.0*rtemp6[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp10(gd.NxNyNzOver2);
	ktemp10 = fft(gd, rtemp9);

	rtemp9.resize(0); // Realspace
	VectorXcd ktemp11(gd.NxNyNzOver2);
	ktemp11[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp11[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp12(gd.NxNyNz);
	rtemp12 = ifft(gd, ktemp11);

	ktemp11.resize(0); // KSpace
	VectorXd rtemp13(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp13[i] = -1.0*rtemp12[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp14(gd.NxNyNzOver2);
	ktemp14 = fft(gd, rtemp13);

	rtemp13.resize(0); // Realspace
	VectorXcd ktemp15(gd.NxNyNzOver2);
	ktemp15[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp15[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp16(gd.NxNyNz);
	rtemp16 = ifft(gd, ktemp15);

	ktemp15.resize(0); // KSpace
	VectorXd rtemp17(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp17[i] = -1.0*rtemp16[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp18(gd.NxNyNzOver2);
	ktemp18 = fft(gd, rtemp17);

	rtemp17.resize(0); // Realspace
	VectorXd rtemp19(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp19[i] = -1.0*log(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp20(gd.NxNyNzOver2);
	ktemp20 = fft(gd, rtemp19);

	VectorXcd ktemp21(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp21[0] = 12.566370614359172*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp21[i] = 12.566370614359172*R*ktemp0[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp22(gd.NxNyNz);
	rtemp22 = ifft(gd, ktemp21);

	ktemp21.resize(0); // KSpace
	VectorXd rtemp23(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp23[i] = rtemp22[i]/(1.0 + -1.0*rtemp8[i]);
	}

	VectorXcd ktemp24(gd.NxNyNzOver2);
	ktemp24 = fft(gd, rtemp23);

	VectorXd rtemp25(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp25[i] = rtemp6[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp26(gd.NxNyNzOver2);
	ktemp26 = fft(gd, rtemp25);

	rtemp25.resize(0); // Realspace
	VectorXd rtemp27(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp27[i] = rtemp12[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp28(gd.NxNyNzOver2);
	ktemp28 = fft(gd, rtemp27);

	rtemp27.resize(0); // Realspace
	VectorXd rtemp29(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp29[i] = rtemp16[i]*(-5.305164769729845e-2*rtemp23[i]*(t1*t1*log(t1) + rtemp8[i])/(rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R)/t1;
	}

	VectorXcd ktemp30(gd.NxNyNzOver2);
	ktemp30 = fft(gd, rtemp29);

	rtemp29.resize(0); // Realspace
	VectorXd rtemp31(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = rtemp12[i]*rtemp12[i];
		const double t3 = rtemp16[i]*rtemp16[i];
		const double t4 = rtemp22[i]*rtemp22[i];
		const double t5 = rtemp6[i]*rtemp6[i];
		const double t6 = 1.0/t1;
		const double t7 = 1.0/rtemp8[i];
		rtemp31[i] = t7*t7*rtemp23[i]*(-3.0*t5 + t4 + -3.0*t3 + -3.0*t2)*(t6*((-1.768388256576615e-2*t7 + 1.768388256576615e-2*t6)*(log(t1)/(t6*t6) + rtemp8[i]) + 8.841941282883075e-3) + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i]) + t6*(t6*(-7.957747154594767e-2*t5 + 7.957747154594767e-2*t4 + -7.957747154594767e-2*t3 + -7.957747154594767e-2*t2) + 7.957747154594767e-2*rtemp22[i]/R)/R;
	}

	VectorXcd ktemp32(gd.NxNyNzOver2);
	ktemp32 = fft(gd, rtemp31);

	rtemp31.resize(0); // Realspace
	VectorXd rtemp33(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp33[i] = ((t1*t1*log(t1) + rtemp8[i])*(-2.6525823848649224e-2*rtemp6[i]*rtemp6[i] + 2.6525823848649224e-2*rtemp22[i]*rtemp22[i] + -2.6525823848649224e-2*rtemp16[i]*rtemp16[i] + -2.6525823848649224e-2*rtemp12[i]*rtemp12[i])/(t1*rtemp8[i]*rtemp8[i]) + 7.957747154594767e-2*rtemp22[i]/R)/t1;
	}

	VectorXcd ktemp34(gd.NxNyNzOver2);
	ktemp34 = fft(gd, rtemp33);

	rtemp33.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp34[0] = R*(12.566370614359172*R*ktemp32[i] + 25.132741228718345*ktemp34[i]) + ktemp24[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t2 = 12.566370614359172*sin(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]))/(sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0])) + -12.566370614359172*R*cos(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t3 = ktemp10[i]*k_i[0];
		const complex t4 = ktemp14[i]*k_i[1];
		const complex t5 = ktemp18[i]*k_i[2];
		const complex t6 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t7 = cos(R*sqrt(t6));
		const complex t8 = sin(R*sqrt(t6));
		const complex t9 = R*t7;
		const complex t10 = t8/(sqrt(t6));
		ktemp34[i] = -12.566370614359172*t1*ktemp34[i]*(-1.0*t9 + -1.0*t10) + R*(t1*t8*complex(0,1)*(12.566370614359172*ktemp30[i]*k_i[2]/(sqrt(t6)) + 12.566370614359172*ktemp28[i]*k_i[1]/(sqrt(t6)) + 12.566370614359172*ktemp26[i]*k_i[0]/(sqrt(t6))) + 12.566370614359172*t1*t10*ktemp32[i]) + (t1*t9*ktemp24[i] + R*t1*t8*complex(0,1)*(t5/(sqrt(t6)) + t4/(sqrt(t6)) + t3/(sqrt(t6))) + t1*(-7.957747154594767e-2*t2*ktemp20[i] + -6.332573977646112e-3*t2*complex(0,1)*(12.566370614359172*t5 + 12.566370614359172*t4 + 12.566370614359172*t3)/t6)/R)/R;
	}

	ktemp32.resize(0); // KSpace
	ktemp30.resize(0); // KSpace
	ktemp28.resize(0); // KSpace
	ktemp26.resize(0); // KSpace
	ktemp24.resize(0); // KSpace
	ktemp20.resize(0); // KSpace
	ktemp18.resize(0); // KSpace
	ktemp14.resize(0); // KSpace
	ktemp10.resize(0); // KSpace
	VectorXd rtemp36(gd.NxNyNz);
	rtemp36 = ifft(gd, ktemp34);

	ktemp34.resize(0); // KSpace
	VectorXd rtemp37(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp37[i] = R*kT*t4*x[i]*(23812.820490470258*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -3789.9280900183135*1.0 + -1894.9640450091567*t3)/rtemp2[i] + 301.59289474462014*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp38(gd.NxNyNzOver2);
	ktemp38 = fft(gd, rtemp37);

	rtemp37.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp38[0] = R*ktemp38[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp38[i] = ktemp38[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp40(gd.NxNyNz);
	rtemp40 = ifft(gd, ktemp38);

	ktemp38.resize(0); // KSpace
	VectorXd rtemp41(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp41[i] = R*kT*t4*x[i]*(-210.55156055657295*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 33.510321638291124*1.0 + 16.755160819145562*t3)/rtemp2[i] + -2.6666666666666665*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp42(gd.NxNyNzOver2);
	ktemp42 = fft(gd, rtemp41);

	rtemp41.resize(0); // Realspace
	VectorXcd ktemp43(gd.NxNyNzOver2);
	ktemp43[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp43[i] = ktemp42[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp44(gd.NxNyNz);
	rtemp44 = ifft(gd, ktemp43);

	ktemp43.resize(0); // KSpace
	VectorXd rtemp45(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp45[i] = kT*x[i]*(t4*(631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -100.53096491487338*1.0 + -50.26548245743669*t3)/rtemp2[i] + 8.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp46(gd.NxNyNzOver2);
	ktemp46 = fft(gd, rtemp45);

	rtemp45.resize(0); // Realspace
	VectorXcd ktemp47(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp47[0] = R*ktemp46[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp47[i] = ktemp46[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp48(gd.NxNyNz);
	rtemp48 = ifft(gd, ktemp47);

	ktemp47.resize(0); // KSpace
	VectorXd rtemp49(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp49[i] = kT*x[i]*(t4*(-210.55156055657295*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 33.510321638291124*1.0 + 16.755160819145562*t3)/rtemp2[i] + -2.6666666666666665*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp50(gd.NxNyNzOver2);
	ktemp50 = fft(gd, rtemp49);

	rtemp49.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp50[0] = R*(8.377580409572783*R*kT*ktemp0[i] + -2.0*ktemp50[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp50[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp50[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + 8.377580409572783*R*kT*t3*ktemp0[i]);
	}

	ktemp0.resize(0); // KSpace
	VectorXd rtemp52(gd.NxNyNz);
	rtemp52 = ifft(gd, ktemp50);

	ktemp50.resize(0); // KSpace
	VectorXd rtemp53(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp53[i] = kT*x[i]*(t4*(-631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 100.53096491487338*1.0 + 50.26548245743669*t3)/rtemp2[i] + -8.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp54(gd.NxNyNzOver2);
	ktemp54 = fft(gd, rtemp53);

	rtemp53.resize(0); // Realspace
	VectorXd rtemp55(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t5 = kT*x[i];
		rtemp55[i] = -315.82734083485946*t4*t4*t5/(kappa_association*t1*t2*rtemp2[i]*rtemp2[i]) + (t5*(t4*(50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp2[i] + -4.0*kappa_association*t1*t2*t3/(R*R))/R + 25.132741228718345*t5)/R;
	}

	VectorXcd ktemp56(gd.NxNyNzOver2);
	ktemp56 = fft(gd, rtemp55);

	rtemp55.resize(0); // Realspace
	VectorXcd ktemp57(gd.NxNyNzOver2);
	ktemp57[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp57[i] = complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp54[i] + ktemp56[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp58(gd.NxNyNz);
	rtemp58 = ifft(gd, ktemp57);

	ktemp57.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = t1*t1*log(t1) + rtemp8[i];
		const double t3 = 1.0/t1;
		const double t4 = 1.0/rtemp8[i];
		rtemp58[i] = t4*t4*rtemp23[i]*(rtemp40[i]*rtemp6[i]*(t3*(t2*(-1.768388256576615e-2*t4 + 1.768388256576615e-2*t3) + 8.841941282883075e-3) + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i]) + t2*t3*rtemp44[i]) + t3*t3*rtemp6[i]*(t2*t4*t4*rtemp52[i] + rtemp48[i]) + t3*rtemp58[i];
	}

	VectorXcd ktemp60(gd.NxNyNzOver2);
	ktemp60 = fft(gd, rtemp58);

	rtemp58.resize(0); // Realspace
	VectorXcd ktemp61(gd.NxNyNzOver2);
	ktemp61[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp61[i] = ktemp42[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp62(gd.NxNyNz);
	rtemp62 = ifft(gd, ktemp61);

	ktemp61.resize(0); // KSpace
	VectorXcd ktemp63(gd.NxNyNzOver2);
	ktemp63[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp63[i] = complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp54[i] + ktemp56[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp64(gd.NxNyNz);
	rtemp64 = ifft(gd, ktemp63);

	ktemp63.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]) + rtemp8[i];
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = 1.0/t2;
		const double t4 = 1.0/rtemp8[i];
		rtemp64[i] = t4*t4*rtemp23[i]*(rtemp12[i]*rtemp40[i]*(t3*(t1*(-1.768388256576615e-2*t4 + 1.768388256576615e-2*t3) + 8.841941282883075e-3) + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i]) + t1*t3*rtemp62[i]) + t3*t3*rtemp12[i]*(t1*t4*t4*rtemp52[i] + rtemp48[i]) + t3*rtemp64[i];
	}

	VectorXcd ktemp66(gd.NxNyNzOver2);
	ktemp66 = fft(gd, rtemp64);

	rtemp64.resize(0); // Realspace
	VectorXcd ktemp67(gd.NxNyNzOver2);
	ktemp67[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp67[i] = ktemp42[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp68(gd.NxNyNz);
	rtemp68 = ifft(gd, ktemp67);

	ktemp67.resize(0); // KSpace
	ktemp56[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp56[i] = complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp54[i] + ktemp56[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp70(gd.NxNyNz);
	rtemp70 = ifft(gd, ktemp56);

	ktemp56.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]) + rtemp8[i];
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = 1.0/t2;
		const double t4 = 1.0/rtemp8[i];
		rtemp70[i] = t4*t4*rtemp23[i]*(rtemp16[i]*rtemp40[i]*(t3*(t1*(-1.768388256576615e-2*t4 + 1.768388256576615e-2*t3) + 8.841941282883075e-3) + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i]) + t1*t3*rtemp68[i]) + t3*t3*rtemp16[i]*(t1*t4*t4*rtemp52[i] + rtemp48[i]) + t3*rtemp70[i];
	}

	rtemp52.resize(0); // Realspace
	rtemp48.resize(0); // Realspace
	rtemp40.resize(0); // Realspace
	VectorXcd ktemp72(gd.NxNyNzOver2);
	ktemp72 = fft(gd, rtemp70);

	rtemp70.resize(0); // Realspace
	VectorXd rtemp73(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = -4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0;
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/t3 + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/(t3*t3*t3) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t3 + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t3*t3*t3))/kT)/(R*R) + 1.0));
		const double t5 = -2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0;
		const double t6 = -50.26548245743669*lambda_dispersion*lambda_dispersion*t5 + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*t5*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t3 + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion));
		const double t7 = 4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0;
		const double t8 = -4.1887902047863905*R*R*R*rtemp4[i] + 1.0;
		const double t9 = 1.0/(4.0*(4.1887902047863905*R*R*R*rtemp4[i])*(4.1887902047863905*R*R*R*rtemp4[i]) + 16.755160819145562*R*R*R*rtemp4[i] + 1.0);
		const double t10 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855;
		const double t11 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion);
		const double t12 = t5*(10.1576*1.0 + t11)/t3;
		const double t13 = 10.1576*1.0 + t11;
		const double t14 = 3694.3299710673505*t5/t3 + -923.5824927668376;
		const double t15 = 4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion);
		const double t16 = rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*(t7*(-4.1887902047863905*R*R*R*rtemp4[i]*(3.0*t10*t5/t3 + -0.5*t10) + -1.0*t5)/(t3*t3*t3) + -7.957747154594767e-2*lambda_dispersion*t6/(t3*t3*t3))/kT;
		const double t17 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
		const double t18 = R*R*R*rtemp4[i]*(52.63789013914324*R*R*R*t13*rtemp4[i] + 8.377580409572781*t17);
		const double t19 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion);
		const double t20 = t10*t5/t3;
		const double t21 = -587.9708763079075*1.0 + -293.98543815395374*t4;
		const double t22 = 11082.989913202051*t5/t3 + -1847.1649855336752;
		const double t23 = -15.0427*1.0 + 10.61654*lambda_dispersion;
		const double t24 = t13*t22/(t16*t16*t3*t3*t3);
		const double t25 = 46.78923567923842*t4*t5/t3 + -11.697308919809606*t4;
		const double t26 = R*R*R*rtemp4[i]*(17.54596337971441*R*R*R*t13*rtemp4[i] + 4.1887902047863905*t17);
		const double t27 = t5*(2.25855*1.0 + t26 + t19)/t3;
		const double t28 = t9*(-4.1887902047863905*R*R*R*rtemp4[i]*(3.0*t20 + -0.5*t10) + -1.0*t5);
		const double t29 = -0.5*t13*t21/t16 + 3.0000000000000004*t12*t21/t16;
		const double t30 = t15*t21/t16;
		const double t31 = t21/t16;
		const double t32 = t31*t5/t3;
		const double t33 = t10*t31;
		const double t34 = t29/(t3*t3*t3);
		const double t35 = 1322.9344716927922*t5/t3 + -220.48907861546533;
		const double t36 = 2.25855*1.0 + t26 + t19;
		const double t37 = 1.40049*1.0 + -1.655478*lambda_dispersion;
		const double t38 = 220.48907861546533*t5/t3 + -36.74817976924422;
		const double t39 = 140.3677070377153*t4*t5/t3 + -23.39461783961921*t4;
		const double t40 = t13*t39/(t3*t3*t3);
		const double t41 = -210.55156055657295*1.0 + -105.27578027828648*t4;
		const double t42 = 5.968310365946076e-2*t32 + -9.947183943243459e-3*t31;
		const double t43 = t41/t16;
		const double t44 = -1.50349*1.0 + 0.498868*lambda_dispersion;
		const double t45 = 3.0*t15*t5/t3 + -0.5*t15;
		const double t46 = t35*t36/(t16*t16);
		const double t47 = 3.0*t20 + -0.5*t10;
		const double t48 = -1.4248291449703753e-2*t31*t36 + 8.548974869822253e-2*t27*t31;
		const double t49 = lambda_dispersion*lambda_dispersion*t5;
		const double t50 = t36*t39;
		rtemp73[i] = epsilon_dispersion*lambda_dispersion*(1.3534253949046735e-4*t31*t6*x[i]/(t3*t3*t3*rtemp4[i]) + t49*x[i]*(-4.000000000000001*1.0 + -2.0*t4)/(t16*t3*t3*t3*rtemp4[i])) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp2[i]*x[i]*(-0.3333333333333333*t4*t47 + -7.124145724851877e-3*t50)/(t3*t3*t3) + lambda_dispersion*(rtemp2[i]*x[i]*(2.6525823848649224e-2*t1*t2*t4*t45*t7/(t3*t3*t3*rtemp4[i]) + 2.374715241617292e-3*t1*t2*t39*t44*t7/(t3*t3*t3)) + 2.8496582899407506e-2*lambda_dispersion*lambda_dispersion*t1*t2*t50*rtemp2[i]*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*lambda_dispersion*x[i]*(-2.094395102393195*R*R*R*t45*t7 + 7.105427357601002e-15*t49)/(kappa_association*t1*t16*t16*t2*t3*t3*t3*rtemp2[i]*rtemp4[i]) + R*(epsilon_dispersion*(t7*x[i]*((2.0943951023931953*epsilon_dispersion*t28*(t8*t8)*(t8*t8)/kT + -4.1887902047863905*t5 + -0.25*t48)/(t3*t3*t3) + -7.124145724851877e-3*t31*t47/(t3*t3*t3)) + lambda_dispersion*(x[i]*(0.11936620731892152*t42*t44*t7/(t3*t3*t3) + 5.66921503708585e-4*t31*t45*t7/(t3*t3*t3*rtemp4[i])) + lambda_dispersion*lambda_dispersion*t48*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp2[i]*rtemp4[i]*x[i]*(t17*(-12.566370614359172*t4*t5/t3 + 2.0943951023931953*t4)/(t3*t3*t3) + -0.3580986219567646*t10*t25*t36/((t3*t3)*(t3*t3))) + lambda_dispersion*(x[i]*(1.9894367886486918e-2*t1*t2*t37*t39*t7*rtemp2[i]*rtemp4[i]/(t3*t3*t3) + 2.8496582899407506e-2*t1*t15*t2*t25*t36*t7*rtemp2[i]/((t3*t3)*(t3*t3))) + 0.11936620731892152*lambda_dispersion*lambda_dispersion*t1*t17*t2*t39*rtemp2[i]*rtemp4[i]*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*(t7*x[i]*(-26.31894506957162*t47/(t16*t16) + -5.968310365946076e-2*t46)/(t1*t2*t3*t3*t3*rtemp2[i]) + lambda_dispersion*(x[i]*(2.0943951023931953*t45*t7/(t1*t16*t16*t2*t3*t3*t3*rtemp4[i]) + 0.11936620731892152*t38*t44*t7/(t1*t16*t16*t2*t3*t3*t3))/rtemp2[i] + 0.23873241463784303*lambda_dispersion*lambda_dispersion*t46*x[i]/(t1*t2*t3*t3*t3*rtemp2[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp4[i]*x[i]*(((-52.63789013914324*t36*t5 + -1.0*t20*t36*t43 + 0.25*t10*t36*t43)/t3 + 8.772981689857206*t36)/(t3*t3*t3) + t17*(0.125*t43 + -0.2685739664675735*t32)/(t3*t3*t3)) + lambda_dispersion*(x[i]*(t37*t42*t7*rtemp4[i]/(t3*t3*t3) + t7*(-7.124145724851877e-3*t30*t36 + 2.8496582899407506e-2*t27*t30)/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t17*rtemp4[i]*x[i]*(t43*t5/t3 + -5.968310365946076e-2*t31)/(t3*t3*t3)) + epsilon_dispersion*t7*rtemp4[i]*x[i]*((t8*t8)*(t8*t8)*t9*(19.81421779562699*1.0 + -26.31894506957162*t27 + 4.386490844928603*t26 + -26.31894506957162*t20 + 8.772981689857206*t19 + 4.386490844928603*t18)/(t3*t3*t3) + t28*t8*t8*t8*(-35.09192675942882*t8*t9 + -35.09192675942882)/(t3*t3*t3))/kT) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp2[i]*rtemp4[i]*rtemp4[i]*x[i]*(-1.5000000000000002*t10*t17*t25/((t3*t3)*(t3*t3)) + -1.0*t40) + lambda_dispersion*(rtemp4[i]*x[i]*(0.125*t1*t2*t23*t39*t7*rtemp2[i]*rtemp4[i]/(t3*t3*t3) + 0.11936620731892152*t1*t15*t17*t2*t25*t7*rtemp2[i]/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t1*t2*t40*rtemp2[i]*rtemp4[i]*rtemp4[i]*x[i])) + R*(epsilon_dispersion*(t7*rtemp4[i]*x[i]*(-8.952465548919114e-2*t17*t22/(t16*t16*t3*t3*t3) + -0.35809862195676456*t10*t14*t36/(t16*t16*(t3*t3)*(t3*t3)))/(t1*t2*rtemp2[i]) + lambda_dispersion*(x[i]*(t37*t38*t7*rtemp4[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp2[i]) + 2.8496582899407503e-2*t14*t15*t36*t7/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp2[i])) + lambda_dispersion*lambda_dispersion*t17*t35*rtemp4[i]*x[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp2[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp4[i]*rtemp4[i]*x[i]*(t17*((-1.5000000000000002*t20*t31 + -220.48907861546533*t5 + 0.37500000000000006*t33)/t3 + 36.74817976924422)/(t3*t3*t3) + -1.0*t34) + lambda_dispersion*(rtemp4[i]*x[i]*(6.283185307179586*t23*t42*t7*rtemp4[i]/(t3*t3*t3) + t17*t7*(0.11936620731892152*t30*t5/t3 + -2.984155182973038e-2*t30)/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t34*rtemp4[i]*rtemp4[i]*x[i]) + epsilon_dispersion*t7*rtemp4[i]*rtemp4[i]*x[i]*((t8*t8)*(t8*t8)*t9*(t10*(110.24453930773267*t36 + -440.97815723093066*t27)/t3 + -293.98543815395374*t28)/(t3*t3*t3) + -2.984155182973038e-2*t17*t22*(t8*t8)*(t8*t8)*t9/(t3*t3*t3))/kT) + R*(epsilon_dispersion*kappa_association*(-12.566370614359172*t1*t10*t13*t2*t25*t7*rtemp2[i]*rtemp4[i]*rtemp4[i]*rtemp4[i]*x[i]/((t3*t3)*(t3*t3)) + lambda_dispersion*t1*t13*t15*t2*t25*t7*rtemp2[i]*rtemp4[i]*rtemp4[i]*x[i]/((t3*t3)*(t3*t3))) + R*(epsilon_dispersion*(t7*rtemp4[i]*rtemp4[i]*x[i]*(-1.5*t10*t14*t17/(t16*t16*(t3*t3)*(t3*t3)) + -1.0*t24)/(t1*t2*rtemp2[i]) + lambda_dispersion*(rtemp4[i]*x[i]*(0.125*t22*t23*t7*rtemp4[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp2[i]) + 0.11936620731892152*t14*t15*t17*t7/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp2[i])) + lambda_dispersion*lambda_dispersion*t24*rtemp4[i]*rtemp4[i]*x[i]/(t1*t2*rtemp2[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp4[i]*rtemp4[i]*rtemp4[i]*x[i]*((-1847.164985533675*t13*t5 + 3.141592653589793*t13*t33 + -12.566370614359172*t12*t33)/t3 + 307.86083092227915*t13)/(t3*t3*t3) + lambda_dispersion*t7*rtemp4[i]*rtemp4[i]*x[i]*(-0.25*t13*t30 + t12*t30)/((t3*t3)*(t3*t3)) + epsilon_dispersion*t7*rtemp4[i]*rtemp4[i]*rtemp4[i]*x[i]*((t8*t8)*(t8*t8)*t9*(615.7216618445583*t13 + -3694.32997106735*t12)/(t3*t3*t3) + t17*(t8*t8)*(t8*t8)*t9*(1042.9786195192705*1.0 + -1847.164985533675*t20 + 461.79124638341875*t19 + 461.79124638341875*t18)/((t3*t3)*(t3*t3)))/kT) + R*R*(epsilon_dispersion*(-12.56637061435917*t10*t13*t14*t7*rtemp4[i]*rtemp4[i]*rtemp4[i]*x[i]/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp2[i]) + lambda_dispersion*t13*t14*t15*t7*rtemp4[i]*rtemp4[i]*x[i]/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp2[i]))/kappa_association + R*epsilon_dispersion*epsilon_dispersion*t10*t7*(t8*t8)*(t8*t8)*t9*(rtemp4[i]*rtemp4[i])*(rtemp4[i]*rtemp4[i])*x[i]*(3868.693299013926*t13 + -15474.773196055705*t12)/(kT*(t3*t3)*(t3*t3))))))))))))))) + epsilon_dispersion*kappa_association*lambda_dispersion*t1*t2*rtemp2[i]*x[i]*(6.332573977646111e-3*t4*t6 + 0.3183098861837907*t4*t49)/(R*R*t3*t3*t3*rtemp4[i]);
	}

	VectorXcd ktemp74(gd.NxNyNzOver2);
	ktemp74 = fft(gd, rtemp73);

	rtemp73.resize(0); // Realspace
	VectorXd rtemp75(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT;
		const double t5 = 100.53096491487338*1.0 + 50.26548245743669*t3;
		rtemp75[i] = R*(kT*x[i]*(-1.0*t5/rtemp2[i] + t5*rtemp36[i]/(t4*rtemp2[i]*rtemp2[i])) + R*R*kT*x[i]*(-631.6546816697189*rtemp36[i]/(t4*rtemp2[i]) + 631.6546816697189)/(kappa_association*t1*t2*t4*rtemp2[i]*rtemp2[i])) + kT*kappa_association*t1*t2*x[i]*(-8.0*t3*rtemp36[i]/rtemp2[i] + 8.0*t3*t4)/R;
	}

	VectorXcd ktemp76(gd.NxNyNzOver2);
	ktemp76 = fft(gd, rtemp75);

	rtemp75.resize(0); // Realspace
	VectorXd rtemp77(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp2[i]/(R*R*t1*t3) + 1.0));
		rtemp77[i] = 100.53096491487338*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(7937.606830156753*R*R*t1*t2*t3/(kappa_association*rtemp2[i]) + -1263.3093633394378*1.0 + -631.6546816697189*t4)/rtemp2[i];
	}

	VectorXcd ktemp78(gd.NxNyNzOver2);
	ktemp78 = fft(gd, rtemp77);

	rtemp77.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp78[0] = R*ktemp78[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp78[i] = ktemp78[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp80(gd.NxNyNz);
	rtemp80 = ifft(gd, ktemp78);

	ktemp78.resize(0); // KSpace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp42[0] = -2.0*R*ktemp42[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp42[i] = ktemp42[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp82(gd.NxNyNz);
	rtemp82 = ifft(gd, ktemp42);

	ktemp42.resize(0); // KSpace
	VectorXd rtemp83(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp83[i] = R*kT*t4*x[i]*(631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -100.53096491487338*1.0 + -50.26548245743669*t3)/rtemp2[i] + 8.0*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp84(gd.NxNyNzOver2);
	ktemp84 = fft(gd, rtemp83);

	rtemp83.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp84[0] = R*ktemp84[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp84[i] = ktemp84[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp86(gd.NxNyNz);
	rtemp86 = ifft(gd, ktemp84);

	ktemp84.resize(0); // KSpace
	VectorXd rtemp87(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp2[i]/(R*R*t1*t3) + 1.0));
		rtemp87[i] = 50.26548245743669*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(3968.8034150783765*R*R*t1*t2*t3/(kappa_association*rtemp2[i]) + -631.6546816697189*1.0 + -315.82734083485946*t4)/rtemp2[i];
	}

	VectorXcd ktemp88(gd.NxNyNzOver2);
	ktemp88 = fft(gd, rtemp87);

	rtemp87.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp88[0] = R*ktemp88[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp88[i] = ktemp88[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp90(gd.NxNyNz);
	rtemp90 = ifft(gd, ktemp88);

	ktemp88.resize(0); // KSpace
	VectorXd rtemp91(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp2[i]/(R*R*t1*t3) + 1.0));
		rtemp91[i] = 2.6666666666666665*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(210.55156055657295*R*R*t1*t2*t3/(kappa_association*rtemp2[i]) + -33.510321638291124*1.0 + -16.755160819145562*t4)/rtemp2[i];
	}

	VectorXcd ktemp92(gd.NxNyNzOver2);
	ktemp92 = fft(gd, rtemp91);

	rtemp91.resize(0); // Realspace
	VectorXcd ktemp93(gd.NxNyNzOver2);
	ktemp93[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp93[i] = ktemp92[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp94(gd.NxNyNz);
	rtemp94 = ifft(gd, ktemp93);

	ktemp93.resize(0); // KSpace
	VectorXcd ktemp95(gd.NxNyNzOver2);
	ktemp95[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp95[i] = ktemp92[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp96(gd.NxNyNz);
	rtemp96 = ifft(gd, ktemp95);

	ktemp95.resize(0); // KSpace
	ktemp92[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp92[i] = ktemp92[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp98(gd.NxNyNz);
	rtemp98 = ifft(gd, ktemp92);

	ktemp92.resize(0); // KSpace
	VectorXd rtemp99(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp99[i] = 25.132741228718345*R*kT*x[i];
	}

	VectorXcd ktemp100(gd.NxNyNzOver2);
	ktemp100 = fft(gd, rtemp99);

	rtemp99.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp100[0] = R*(-2.0*ktemp54[i] + ktemp100[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp100[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp54[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + t3*ktemp100[i]);
	}

	ktemp54.resize(0); // KSpace
	VectorXd rtemp102(gd.NxNyNz);
	rtemp102 = ifft(gd, ktemp100);

	ktemp100.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = t1*t2*t2 + rtemp8[i];
		const double t4 = rtemp12[i]*rtemp12[i];
		const double t5 = rtemp16[i]*rtemp16[i];
		const double t6 = rtemp22[i]*rtemp22[i];
		const double t7 = rtemp6[i]*rtemp6[i];
		const double t8 = (t3*(-1.768388256576615e-2*1.0/rtemp8[i] + 1.768388256576615e-2*1.0/t2) + 8.841941282883075e-3)/t2 + -8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i];
		rtemp102[i] = rtemp22[i]*((t8*rtemp22[i]*rtemp80[i] + t3*rtemp82[i]/t2)/(t2*rtemp8[i]*rtemp8[i]) + rtemp86[i]/(t2*t2)) + (t8*rtemp90[i]*(-3.0*t7 + t6 + -3.0*t5 + -3.0*t4) + t3*(rtemp6[i]*rtemp98[i] + rtemp16[i]*rtemp96[i] + rtemp12[i]*rtemp94[i])/t2)/(t2*rtemp8[i]*rtemp8[i]) + rtemp102[i]/t2 + R*kT*t3*(-0.33333333333333337*t7 + 0.33333333333333337*t6 + -0.33333333333333337*t5 + -0.33333333333333337*t4)/(t2*t2*rtemp8[i]*rtemp8[i]) + -1.0*kT*t1/R;
	}

	rtemp98.resize(0); // Realspace
	rtemp96.resize(0); // Realspace
	rtemp94.resize(0); // Realspace
	rtemp90.resize(0); // Realspace
	rtemp86.resize(0); // Realspace
	rtemp82.resize(0); // Realspace
	rtemp80.resize(0); // Realspace
	VectorXcd ktemp104(gd.NxNyNzOver2);
	ktemp104 = fft(gd, rtemp102);

	rtemp102.resize(0); // Realspace
	VectorXd rtemp105(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp105[i] = R*kT*t4*x[i]*(7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -1263.3093633394378*1.0 + -631.6546816697189*t3)/rtemp2[i] + 100.53096491487338*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp106(gd.NxNyNzOver2);
	ktemp106 = fft(gd, rtemp105);

	rtemp105.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp106[0] = R*ktemp106[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp106[i] = ktemp106[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp108(gd.NxNyNz);
	rtemp108 = ifft(gd, ktemp106);

	ktemp106.resize(0); // KSpace
	VectorXd rtemp109(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp109[i] = R*kT*t4*x[i]*(-421.1031211131459*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 67.02064327658225*1.0 + 33.510321638291124*t3)/rtemp2[i] + -5.333333333333333*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp110(gd.NxNyNzOver2);
	ktemp110 = fft(gd, rtemp109);

	rtemp109.resize(0); // Realspace
	VectorXcd ktemp111(gd.NxNyNzOver2);
	ktemp111[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp111[i] = ktemp110[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp112(gd.NxNyNz);
	rtemp112 = ifft(gd, ktemp111);

	ktemp111.resize(0); // KSpace
	VectorXcd ktemp113(gd.NxNyNzOver2);
	ktemp113[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp113[i] = ktemp110[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp114(gd.NxNyNz);
	rtemp114 = ifft(gd, ktemp113);

	ktemp113.resize(0); // KSpace
	VectorXd rtemp115(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp115[i] = R*kT*t4*x[i]*(70.18385351885766*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -11.17010721276371*1.0 + -5.585053606381855*t3)/rtemp2[i] + 0.8888888888888891*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp116(gd.NxNyNzOver2);
	ktemp116 = fft(gd, rtemp115);

	rtemp115.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp116[0] = R*ktemp116[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp116[i] = ktemp116[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp118(gd.NxNyNz);
	rtemp118 = ifft(gd, ktemp116);

	ktemp116.resize(0); // KSpace
	VectorXd rtemp119(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp119[i] = R*kT*t4*x[i]*(3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -631.6546816697189*1.0 + -315.82734083485946*t3)/rtemp2[i] + 50.26548245743669*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp120(gd.NxNyNzOver2);
	ktemp120 = fft(gd, rtemp119);

	rtemp119.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp120[0] = R*ktemp120[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp120[i] = ktemp120[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp122(gd.NxNyNz);
	rtemp122 = ifft(gd, ktemp120);

	ktemp120.resize(0); // KSpace
	VectorXd rtemp123(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp123[i] = R*kT*t4*x[i]*(210.55156055657295*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -33.510321638291124*1.0 + -16.755160819145562*t3)/rtemp2[i] + 2.6666666666666665*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp124(gd.NxNyNzOver2);
	ktemp124 = fft(gd, rtemp123);

	rtemp123.resize(0); // Realspace
	VectorXcd ktemp125(gd.NxNyNzOver2);
	ktemp125[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp125[i] = ktemp124[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp126(gd.NxNyNz);
	rtemp126 = ifft(gd, ktemp125);

	ktemp125.resize(0); // KSpace
	VectorXd rtemp127(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp127[i] = R*kT*t4*x[i]*(421.1031211131459*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -67.02064327658225*1.0 + -33.510321638291124*t3)/rtemp2[i] + 5.333333333333333*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp128(gd.NxNyNzOver2);
	ktemp128 = fft(gd, rtemp127);

	rtemp127.resize(0); // Realspace
	VectorXcd ktemp129(gd.NxNyNzOver2);
	ktemp129[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp129[i] = ktemp128[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp130(gd.NxNyNz);
	rtemp130 = ifft(gd, ktemp129);

	ktemp129.resize(0); // KSpace
	VectorXcd ktemp131(gd.NxNyNzOver2);
	ktemp131[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp131[i] = ktemp124[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp132(gd.NxNyNz);
	rtemp132 = ifft(gd, ktemp131);

	ktemp131.resize(0); // KSpace
	VectorXcd ktemp133(gd.NxNyNzOver2);
	ktemp133[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp133[i] = ktemp128[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp134(gd.NxNyNz);
	rtemp134 = ifft(gd, ktemp133);

	ktemp133.resize(0); // KSpace
	ktemp124[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp124[i] = ktemp124[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp136(gd.NxNyNz);
	rtemp136 = ifft(gd, ktemp124);

	ktemp124.resize(0); // KSpace
	ktemp128[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp128[i] = ktemp128[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp138(gd.NxNyNz);
	rtemp138 = ifft(gd, ktemp128);

	ktemp128.resize(0); // KSpace
	VectorXd rtemp139(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp139[i] = R*kT*t4*x[i]*(-3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 631.6546816697189*1.0 + 315.82734083485946*t3)/rtemp2[i] + -50.26548245743669*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp140(gd.NxNyNzOver2);
	ktemp140 = fft(gd, rtemp139);

	rtemp139.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp140[0] = R*ktemp140[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp140[i] = ktemp140[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp142(gd.NxNyNz);
	rtemp142 = ifft(gd, ktemp140);

	ktemp140.resize(0); // KSpace
	VectorXd rtemp143(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp143[i] = -631.6546816697189*R*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp2[i]*rtemp2[i]) + kT*x[i]*(t4*(100.53096491487338*1.0 + 50.26548245743669*t3)/rtemp2[i] + -8.0*kappa_association*t1*t2*t3/(R*R))/R;
	}

	VectorXcd ktemp144(gd.NxNyNzOver2);
	ktemp144 = fft(gd, rtemp143);

	rtemp143.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp144[0] = -2.0*R*ktemp144[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp144[i] = ktemp144[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp146(gd.NxNyNz);
	rtemp146 = ifft(gd, ktemp144);

	ktemp144.resize(0); // KSpace
	ktemp110[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp110[i] = ktemp110[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp148(gd.NxNyNz);
	rtemp148 = ifft(gd, ktemp110);

	ktemp110.resize(0); // KSpace
	VectorXd rtemp149(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp149[i] = R*kT*t4*x[i]*(-7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 1263.3093633394378*1.0 + 631.6546816697189*t3)/rtemp2[i] + -100.53096491487338*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp150(gd.NxNyNzOver2);
	ktemp150 = fft(gd, rtemp149);

	rtemp149.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp150[0] = R*ktemp150[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp150[i] = ktemp150[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp152(gd.NxNyNz);
	rtemp152 = ifft(gd, ktemp150);

	ktemp150.resize(0); // KSpace
	VectorXd rtemp153(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp153[i] = kT*x[i]*(t4*(7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -1263.3093633394378*1.0 + -631.6546816697189*t3)/rtemp2[i] + 100.53096491487338*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp154(gd.NxNyNzOver2);
	ktemp154 = fft(gd, rtemp153);

	rtemp153.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp154[0] = -2.0*R*ktemp154[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp154[i] = ktemp154[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp156(gd.NxNyNz);
	rtemp156 = ifft(gd, ktemp154);

	ktemp154.resize(0); // KSpace
	VectorXd rtemp157(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp157[i] = kT*x[i]*(t4*(3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + -631.6546816697189*1.0 + -315.82734083485946*t3)/rtemp2[i] + 50.26548245743669*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp158(gd.NxNyNzOver2);
	ktemp158 = fft(gd, rtemp157);

	rtemp157.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp158[0] = -2.0*R*ktemp158[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp158[i] = ktemp158[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp160(gd.NxNyNz);
	rtemp160 = ifft(gd, ktemp158);

	ktemp158.resize(0); // KSpace
	VectorXd rtemp161(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp161[i] = kT*x[i]*(t4*(-3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 631.6546816697189*1.0 + 315.82734083485946*t3)/rtemp2[i] + -50.26548245743669*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp162(gd.NxNyNzOver2);
	ktemp162 = fft(gd, rtemp161);

	rtemp161.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp162[0] = -2.0*R*ktemp162[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp162[i] = ktemp162[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp164(gd.NxNyNz);
	rtemp164 = ifft(gd, ktemp162);

	ktemp162.resize(0); // KSpace
	VectorXd rtemp165(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp165[i] = kT*x[i]*(t4*(-7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp2[i]) + 1263.3093633394378*1.0 + 631.6546816697189*t3)/rtemp2[i] + -100.53096491487338*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp166(gd.NxNyNzOver2);
	ktemp166 = fft(gd, rtemp165);

	rtemp165.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp166[0] = -2.0*R*ktemp166[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp166[i] = ktemp166[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp168(gd.NxNyNz);
	rtemp168 = ifft(gd, ktemp166);

	ktemp166.resize(0); // KSpace
	VectorXd rtemp169(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp169[i] = -315.82734083485946*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp2[i]*rtemp2[i]) + kT*x[i]*(t4*(50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp2[i] + -4.0*kappa_association*t1*t2*t3/(R*R))/(R*R);
	}

	VectorXcd ktemp170(gd.NxNyNzOver2);
	ktemp170 = fft(gd, rtemp169);

	rtemp169.resize(0); // Realspace
	VectorXd rtemp171(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t5 = kT*x[i];
		rtemp171[i] = -631.6546816697189*t4*t4*t5/(kappa_association*t1*t2*rtemp2[i]*rtemp2[i]) + (t5*(t4*(100.53096491487338*1.0 + 50.26548245743669*t3)/rtemp2[i] + -8.0*kappa_association*t1*t2*t3/(R*R))/R + 12.566370614359172*t5)/R;
	}

	VectorXcd ktemp172(gd.NxNyNzOver2);
	ktemp172 = fft(gd, rtemp171);

	rtemp171.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp172[0] = R*(ktemp172[i] + -2.0*ktemp170[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp172[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp170[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + t3*ktemp172[i]);
	}

	ktemp170.resize(0); // KSpace
	VectorXd rtemp174(gd.NxNyNz);
	rtemp174 = ifft(gd, ktemp172);

	ktemp172.resize(0); // KSpace
	VectorXd rtemp175(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp2[i]*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp175[i] = 315.82734083485946*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp2[i]*rtemp2[i]) + kT*x[i]*(t4*(-50.26548245743669*1.0 + -25.132741228718345*t3)/rtemp2[i] + 4.0*kappa_association*t1*t2*t3/(R*R))/(R*R);
	}

	VectorXcd ktemp176(gd.NxNyNzOver2);
	ktemp176 = fft(gd, rtemp175);

	rtemp175.resize(0); // Realspace
	VectorXcd ktemp177(gd.NxNyNzOver2);
	ktemp177[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp177[i] = complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp176[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp178(gd.NxNyNz);
	rtemp178 = ifft(gd, ktemp177);

	ktemp177.resize(0); // KSpace
	VectorXcd ktemp179(gd.NxNyNzOver2);
	ktemp179[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp179[i] = complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp176[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp180(gd.NxNyNz);
	rtemp180 = ifft(gd, ktemp179);

	ktemp179.resize(0); // KSpace
	ktemp176[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp176[i] = complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp176[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	ktemp46.resize(0); // KSpace
	VectorXd rtemp182(gd.NxNyNz);
	rtemp182 = ifft(gd, ktemp176);

	ktemp176.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = -7.957747154594767e-2*rtemp6[i]*rtemp6[i] + 7.957747154594767e-2*rtemp22[i]*rtemp22[i] + -7.957747154594767e-2*rtemp16[i]*rtemp16[i] + -7.957747154594767e-2*rtemp12[i]*rtemp12[i];
		const double t3 = rtemp12[i]*rtemp12[i];
		const double t4 = rtemp16[i]*rtemp16[i];
		const double t5 = rtemp22[i]*rtemp22[i];
		const double t6 = rtemp6[i]*rtemp6[i];
		const double t7 = -3.0*t6 + t5 + -3.0*t4 + -3.0*t3;
		const double t8 = t1*t1*log(t1) + rtemp8[i];
		const double t9 = -0.22222222222222224*1.0/rtemp8[i] + 0.22222222222222224*1.0/t1;
		const double t10 = log(t1);
		const double t11 = (7.957747154594767e-2*t8*t9 + 8.841941282883075e-3)/t1;
		const double t12 = 1.0/(t1*t1);
		const double t13 = t8/(t1*rtemp8[i]) + -1.0*rtemp19[i];
		const double t14 = 1.0/(rtemp8[i]*rtemp8[i]);
		rtemp182[i] = rtemp22[i]*((7.957747154594767e-2*t14*t7*t9*rtemp142[i] + rtemp146[i]/t1)/t1 + t14*rtemp6[i]*((t8*rtemp138[i]/t1 + rtemp136[i])/t1 + rtemp44[i])/t1 + t14*rtemp16[i]*((t8*rtemp134[i]/t1 + rtemp132[i])/t1 + rtemp68[i])/t1 + t14*rtemp12[i]*((t8*rtemp130[i]/t1 + rtemp126[i])/t1 + rtemp62[i])/t1) + t14*t7*rtemp152[i]*rtemp23[i]*((-8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i] + t11)/rtemp8[i] + 7.957747154594767e-2*t10*t9) + t13*t14*rtemp148[i]*rtemp23[i]*rtemp6[i] + t13*t14*rtemp114[i]*rtemp16[i]*rtemp23[i] + t13*t14*rtemp112[i]*rtemp12[i]*rtemp23[i] + t12*t14*rtemp118[i]*rtemp22[i]*(t7*t8*(t14 + t12) + t7) + t12*t14*t7*rtemp122[i]*rtemp22[i]*(-8.841941282883075e-3*1.0 + 1.768388256576615e-2*rtemp19[i] + 7.957747154594767e-2*t9 + 2.0*t11) + ((rtemp182[i]*rtemp6[i] + rtemp16[i]*rtemp180[i] + rtemp12[i]*rtemp178[i])/t1 + rtemp174[i])/t1 + t14*(0.3333333333333333*t2*rtemp160[i] + 0.3333333333333333*t2*(t8*rtemp168[i]/t1 + rtemp164[i])/t1)/t1 + 0.3333333333333333*t13*t14*t2*rtemp156[i]/t1 + kT*t14*rtemp23[i]*(-0.22222222222222224*t10*t7 + (t7*t8*t9 + 0.11111111111111112*t7)/t1 + -0.11111111111111112*t7) + t12*t2*(rtemp108[i]/t1 + 12.566370614359172*kT)/R;
	}

	rtemp180.resize(0); // Realspace
	rtemp178.resize(0); // Realspace
	rtemp174.resize(0); // Realspace
	rtemp168.resize(0); // Realspace
	rtemp164.resize(0); // Realspace
	rtemp160.resize(0); // Realspace
	rtemp156.resize(0); // Realspace
	rtemp152.resize(0); // Realspace
	rtemp148.resize(0); // Realspace
	rtemp146.resize(0); // Realspace
	rtemp142.resize(0); // Realspace
	rtemp138.resize(0); // Realspace
	rtemp136.resize(0); // Realspace
	rtemp134.resize(0); // Realspace
	rtemp132.resize(0); // Realspace
	rtemp130.resize(0); // Realspace
	rtemp126.resize(0); // Realspace
	rtemp122.resize(0); // Realspace
	rtemp118.resize(0); // Realspace
	rtemp114.resize(0); // Realspace
	rtemp112.resize(0); // Realspace
	rtemp108.resize(0); // Realspace
	rtemp68.resize(0); // Realspace
	rtemp62.resize(0); // Realspace
	rtemp44.resize(0); // Realspace
	rtemp23.resize(0); // Realspace
	rtemp22.resize(0); // Realspace
	rtemp19.resize(0); // Realspace
	rtemp16.resize(0); // Realspace
	rtemp12.resize(0); // Realspace
	rtemp8.resize(0); // Realspace
	rtemp6.resize(0); // Realspace
	VectorXcd ktemp184(gd.NxNyNzOver2);
	ktemp184 = fft(gd, rtemp182);

	rtemp182.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp184[0] = R*(0.33333333333333337*R*R*ktemp184[i] + 2.0*ktemp76[i] + ktemp104[i]) + ktemp74[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = 0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0];
		const complex t2 = exp(-12.0*pow(gd.dvolume, 0.6666666666666666)*t1);
		const complex t3 = R*cos(1.4142135623730951*R*sqrt(t1));
		const complex t4 = sin(1.4142135623730951*R*sqrt(t1))/(sqrt(t1));
		const complex t5 = 1.4142135623730951*R*sqrt(t1);
		ktemp184[i] = ktemp74[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*t1) + t2*(0.7071067811865476*t4*ktemp104[i] + 0.7071067811865476*ktemp76[i]*sin(2.0*t5)/(sqrt(t1)) + 0.3535533905932738*ktemp184[i]*(-1.4142135623730951*sqrt(t1)*t3 + sin(t5))/(sqrt(t1)*t1)) + 0.5*t2*complex(0,1)*(-0.7071067811865476*t4 + t3)*(ktemp72[i]*k_i[2] + ktemp66[i]*k_i[1] + ktemp60[i]*k_i[0])/t1;
	}

	ktemp104.resize(0); // KSpace
	ktemp76.resize(0); // KSpace
	ktemp74.resize(0); // KSpace
	ktemp72.resize(0); // KSpace
	ktemp66.resize(0); // KSpace
	ktemp60.resize(0); // KSpace
	VectorXd rtemp186(gd.NxNyNz);
	rtemp186 = ifft(gd, ktemp184);

	ktemp184.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855);
		const double t2 = 1.0 + -4.1887902047863905*t1;
		const double t3 = -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(1.0 + -2.0943951023931953*t1)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/t2 + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0*1.0 + 2.0943951023931953*t1;
		const double t4 = R*R*R*rtemp4[i];
		const double t5 = 4.1887902047863905*t4;
		const double t6 = 4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0;
		const double t7 = 12.566370614359172*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*(t3*t6/(t2*t2*t2) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(1.0 + -2.0943951023931953*t1) + -4.1887902047863905*R*R*R*t6*(-2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(1.0 + -2.0943951023931953*t1)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t2 + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t2*t2*t2))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp36[i]/rtemp2[i] + 0.25*epsilon_dispersion*(t3*t6/(t2*t2*t2) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(1.0 + -2.0943951023931953*t1) + -4.1887902047863905*R*R*R*t6*(-2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(1.0 + -2.0943951023931953*t1)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t2 + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t2*t2*t2))/kT));
		(*outgrad)[i] = ingrad[i]*(kT*(2.0*1.0 + log(2.646476976618268e-6*x[i]/(sqrt(kT)*kT)) + 4.0*log(t7) + -2.0*t7) + epsilon_dispersion*t4*t6*(2.0943951023931953*epsilon_dispersion*t3*((1.0 + -1.0*t5)*(1.0 + -1.0*t5))*((1.0 + -1.0*t5)*(1.0 + -1.0*t5))/(kT*(4.0*t5*t5 + 1.0 + 4.0*t5)) + -4.1887902047863905*1.0 + 8.772981689857206*t1)/(t2*t2*t2) + rtemp186[i] + mu) + (*outgrad)[i];
	}

	rtemp186.resize(0); // Realspace
	rtemp36.resize(0); // Realspace
	rtemp4.resize(0); // Realspace
	rtemp2.resize(0); // Realspace
	// 94 Fourier transform used.
	// 44

}

void print_summary(const char *prefix, double energy, std::string name) const {
	if (name != "") printf("%s%25s =", prefix, name.c_str());
	else printf("%s%25s =", prefix, "UNKNOWN");
	print_double("", energy);
	printf("\n%s%25s =", prefix, "FSAFT");
	print_double("", FSAFT);
	printf("\n%s%25s =", prefix, "Fassoc");
	print_double("", Fassoc);
	printf("\n%s%25s =", prefix, "Fdisp");
	print_double("", Fdisp);
	printf("\n%s%25s =", prefix, "Fideal");
	print_double("", Fideal);
	printf("\n%s%25s =", prefix, "a1integrated");
	print_double("", a1integrated);
	printf("\n%s%25s =", prefix, "a2integrated");
	print_double("", a2integrated);
	printf("\n%s%25s =", prefix, "dV");
	print_double("", dV);
	printf("\n%s%25s =", prefix, "dr");
	print_double("", dr);
	printf("\n%s%25s =", prefix, "kTphi1");
	print_double("", kTphi1);
	printf("\n%s%25s =", prefix, "kTphi2");
	print_double("", kTphi2);
	printf("\n%s%25s =", prefix, "kTphi3");
	print_double("", kTphi3);
	printf("\n%s%25s =", prefix, "volume");
	print_double("", volume);
	printf("\n%s%25s =", prefix, "whitebear");
	print_double("", whitebear);
	printf("\n");
}

private:
	double R;
	double epsilon_association;
	double kappa_association;
	double epsilon_dispersion;
	double lambda_dispersion;
	double length_scaling;
	double mu;
	mutable double FSAFT;
	mutable double Fassoc;
	mutable double Fdisp;
	mutable double Fideal;
	mutable double a1integrated;
	mutable double a2integrated;
	mutable double dV;
	mutable double dr;
	mutable double kTphi1;
	mutable double kTphi2;
	mutable double kTphi3;
	mutable double volume;
	mutable double whitebear;
	// TODO: add declaration of spherical fourier transform data here
	mutable double oldkT;}; // End of WaterSaft_type class
	// Total 113 Fourier transform used.
	// peak memory used: 44



Functional WaterSaft(double R, double epsilon_association, double kappa_association, double epsilon_dispersion, double lambda_dispersion, double length_scaling, double mu) {
	return Functional(new WaterSaft_type(R, epsilon_association, kappa_association, epsilon_dispersion, lambda_dispersion, length_scaling, mu), "WaterSaft");
}

