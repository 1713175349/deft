// -*- mode: C++; -*-

#include "MinimalFunctionals.h"
#include "utilities.h"
#include "handymath.h"


class WaterSaft_by_hand_type : public FunctionalInterface {
public:
WaterSaft_by_hand_type(double R_arg, double epsilon_association_arg, double kappa_association_arg, double epsilon_dispersion_arg, double lambda_dispersion_arg, double length_scaling_arg, double mu_arg) : R(R_arg), epsilon_association(epsilon_association_arg), kappa_association(kappa_association_arg), epsilon_dispersion(epsilon_dispersion_arg), lambda_dispersion(lambda_dispersion_arg), length_scaling(length_scaling_arg), mu(mu_arg)  {
	have_integral = true;
	// TODO: code to evaluate Fourier transforms goes here
	oldkT = sqrt(-1.0);  // initialize to NaN so we'll have to define transforms

}
~WaterSaft_by_hand_type() {

}

bool I_have_analytic_grad() const {
	return false;}

double integral(const GridDescription &gd, double kT, const VectorXd &x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output=0;
	VectorXcd ktemp0(gd.NxNyNzOver2);
	ktemp0 = fft(gd, x);

	VectorXcd ktemp1(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp1[0] = 50.26548245743669*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp1[i] = 25.132741228718345*R*ktemp0[i]*sin(2.0*R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp2(gd.NxNyNz);
	rtemp2 = ifft(gd, ktemp1);

	ktemp1.resize(0); // KSpace
	VectorXcd ktemp3(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp3[0] = ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		ktemp3[i] = ktemp0[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*(0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0]));
	}

	VectorXd rtemp4(gd.NxNyNz);
	rtemp4 = ifft(gd, ktemp3);

	ktemp3.resize(0); // KSpace
	VectorXcd ktemp5(gd.NxNyNzOver2);
	ktemp5[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp5[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp6(gd.NxNyNz);
	rtemp6 = ifft(gd, ktemp5);

	ktemp5.resize(0); // KSpace
	VectorXcd ktemp7(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp7[0] = 4.188790204786391*R*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp7[i] = 12.566370614359172*ktemp0[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*t2*cos(t2) + sin(t2))/(sqrt(t1)*t1);
	}

	VectorXd rtemp8(gd.NxNyNz);
	rtemp8 = ifft(gd, ktemp7);

	ktemp7.resize(0); // KSpace
	VectorXd rtemp9(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp9[i] = -7.957747154594767e-2*rtemp6[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp10(gd.NxNyNzOver2);
	ktemp10 = fft(gd, rtemp9);

	rtemp9.resize(0); // Realspace
	VectorXcd ktemp11(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp11[0] = 12.566370614359172*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp11[i] = 12.566370614359172*R*ktemp0[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp12(gd.NxNyNz);
	rtemp12 = ifft(gd, ktemp11);

	ktemp11.resize(0); // KSpace
	VectorXd rtemp13(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp13[i] = rtemp6[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp14(gd.NxNyNzOver2);
	ktemp14 = fft(gd, rtemp13);

	rtemp13.resize(0); // Realspace
	VectorXcd ktemp15(gd.NxNyNzOver2);
	ktemp15[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp15[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp16(gd.NxNyNz);
	rtemp16 = ifft(gd, ktemp15);

	ktemp15.resize(0); // KSpace
	VectorXd rtemp17(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp17[i] = rtemp16[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp18(gd.NxNyNzOver2);
	ktemp18 = fft(gd, rtemp17);

	rtemp17.resize(0); // Realspace
	ktemp0[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp0[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp20(gd.NxNyNz);
	rtemp20 = ifft(gd, ktemp0);

	ktemp0.resize(0); // KSpace
	VectorXd rtemp21(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp21[i] = rtemp20[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp22(gd.NxNyNzOver2);
	ktemp22 = fft(gd, rtemp21);

	rtemp21.resize(0); // Realspace
	VectorXd rtemp23(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = rtemp12[i]*rtemp12[i];
		const double t4 = rtemp16[i]*rtemp16[i];
		const double t5 = rtemp20[i]*rtemp20[i];
		const double t6 = rtemp6[i]*rtemp6[i];
		rtemp23[i] = rtemp12[i]*(-3.0*t6 + -3.0*t5 + -3.0*t4 + t3)*(-8.841941282883075e-3*(2.0*1.0 + -4.0*rtemp8[i])*(t1*t2*t2 + rtemp8[i])/(t2*rtemp8[i]) + -1.768388256576615e-2*t1*t2 + 8.841941282883075e-3*rtemp8[i])/(t2*t2*rtemp8[i]*rtemp8[i]) + (((-7.957747154594767e-2*t6 + -7.957747154594767e-2*t5 + -7.957747154594767e-2*t4 + 7.957747154594767e-2*t3)/t2 + 7.957747154594767e-2*rtemp12[i]/R)/t2 + (-7.957747154594767e-2*rtemp12[i]/t2 + 0.15915494309189535*t1/R)/R)/R;
	}

	VectorXcd ktemp24(gd.NxNyNzOver2);
	ktemp24 = fft(gd, rtemp23);

	rtemp23.resize(0); // Realspace
	VectorXd rtemp25(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp25[i] = -7.957747154594767e-2*rtemp16[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp26(gd.NxNyNzOver2);
	ktemp26 = fft(gd, rtemp25);

	rtemp25.resize(0); // Realspace
	VectorXd rtemp27(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp27[i] = -7.957747154594767e-2*rtemp20[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp28(gd.NxNyNzOver2);
	ktemp28 = fft(gd, rtemp27);

	rtemp27.resize(0); // Realspace
	VectorXd rtemp29(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0/(1.0 + -1.0*rtemp8[i]);
		rtemp29[i] = t2*(8.841941282883075e-3*t2*(t1/(t2*t2) + rtemp8[i])*(-3.0*rtemp6[i]*rtemp6[i] + -3.0*rtemp20[i]*rtemp20[i] + -3.0*rtemp16[i]*rtemp16[i] + 3.0*rtemp12[i]*rtemp12[i])/(rtemp8[i]*rtemp8[i]) + 7.957747154594767e-2*rtemp12[i]/R) + (7.957747154594767e-2*t2*rtemp12[i] + -7.957747154594767e-2*t1/R)/R;
	}

	VectorXcd ktemp30(gd.NxNyNzOver2);
	ktemp30 = fft(gd, rtemp29);

	rtemp29.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp30[0] = R*(12.566370614359172*R*ktemp24[i] + 25.132741228718345*ktemp30[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sin(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t2 = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t3 = 1.0/(sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t4 = R*cos(R/t3);
		const complex t5 = t1*t3;
		ktemp30[i] = -12.566370614359172*t2*ktemp30[i]*(-1.0*t5 + -1.0*t4) + t2*t3*t3*complex(0,1)*(-1.0*t5 + t4)*(12.566370614359172*ktemp28[i]*k_i[2] + 12.566370614359172*ktemp26[i]*k_i[1] + 12.566370614359172*ktemp10[i]*k_i[0]) + R*(12.566370614359172*t2*t5*ktemp24[i] + t1*t2*complex(0,1)*(12.566370614359172*t3*ktemp22[i]*k_i[2] + 12.566370614359172*t3*ktemp18[i]*k_i[1] + 12.566370614359172*t3*ktemp14[i]*k_i[0]));
	}

	ktemp28.resize(0); // KSpace
	ktemp26.resize(0); // KSpace
	ktemp24.resize(0); // KSpace
	ktemp22.resize(0); // KSpace
	ktemp18.resize(0); // KSpace
	ktemp14.resize(0); // KSpace
	ktemp10.resize(0); // KSpace
	VectorXd rtemp32(gd.NxNyNz);
	rtemp32 = ifft(gd, ktemp30);

	ktemp30.resize(0); // KSpace
	double 	s33 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s33 += gd.dvolume*kT*x[i]*(-6.283185307179586*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)) + 0.5*1.0 + log(12.566370614359172*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp2[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp2[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp4[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*rtemp4[i]*(73.49635953848843*R*R*R*rtemp4[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT))));
	}

	rtemp32.resize(0); // Realspace
	rtemp2.resize(0); // Realspace
	Fassoc = 4.0*s33;
	double 	s34 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s34 += R*R*R*epsilon_dispersion*gd.dvolume*rtemp4[i]*x[i]*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)/((-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0));
	}

	a1integrated = -4.1887902047863905*s34;
	double 	s35 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s35 += R*R*R*epsilon_dispersion*epsilon_dispersion*gd.dvolume*rtemp4[i]*x[i]*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp4[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp4[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)*((-4.1887902047863905*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i] + 1.0))*((-4.1887902047863905*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i] + 1.0))/(kT*(4.0*(4.1887902047863905*R*R*R*rtemp4[i])*(4.1887902047863905*R*R*R*rtemp4[i]) + 16.755160819145562*R*R*R*rtemp4[i] + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp4[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp4[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp4[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0));
	}

	rtemp4.resize(0); // Realspace
	a2integrated = 2.0943951023931953*s35;
	Fdisp = a2integrated + a1integrated;
	double 	s36 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s36 += gd.dvolume*kT*x[i]*(-1.0*1.0 + log(2.646476976618268e-6*x[i]/(sqrt(kT)*kT)));
	}

	Fideal = s36;
	double 	s37 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s37 += gd.dvolume*kT*rtemp12[i]*log(1.0 + -1.0*rtemp8[i])/(R*R);
	}

	kTphi1 = -7.957747154594767e-2*s37;
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp20[i] = -7.957747154594767e-2*rtemp20[i]*rtemp20[i] + -7.957747154594767e-2*rtemp16[i]*rtemp16[i];
	}

	rtemp16.resize(0); // Realspace
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp20[i] = -7.957747154594767e-2*rtemp6[i]*rtemp6[i] + rtemp20[i];
	}

	rtemp6.resize(0); // Realspace
	double 	s40 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s40 += gd.dvolume*kT*(7.957747154594767e-2*rtemp12[i]*rtemp12[i] + rtemp20[i])/(R*(1.0 + -1.0*rtemp8[i]));
	}

	kTphi2 = s40;
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp20[i] = rtemp12[i]*(rtemp12[i]*rtemp12[i] + 37.69911184307752*rtemp20[i]);
	}

	rtemp12.resize(0); // Realspace
	double 	s42 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s42 += gd.dvolume*kT*rtemp20[i]*(log(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]) + rtemp8[i])/(rtemp8[i]*rtemp8[i]*(1.0 + -1.0*rtemp8[i])*(1.0 + -1.0*rtemp8[i]));
	}

	rtemp20.resize(0); // Realspace
	rtemp8.resize(0); // Realspace
	kTphi3 = 8.841941282883075e-3*s42;
	whitebear = kTphi3 + kTphi2 + kTphi1;
	double 	s43 = 0;
	for (int i=0; i<gd.NxNyNz; i++) {
		s43 += gd.dvolume*mu*x[i];
	}

	FSAFT = whitebear + s43 + Fideal + Fdisp + Fassoc;
	output = FSAFT;
	// 17 Fourier transform used.
	// 16 temporaries made
	return output;

}

VectorXd transform(const GridDescription &gd, double kT, const VectorXd &x) const {
	assert(0);
}

double transform(double kT, double x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output = 0;
		double 	n = x;
	double 	boltz = -1.0*1.0 + exp(epsilon_association/kT);
	double 	eta_d = 4.1887902047863905*R*R*R*n;
	double 	c1 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + 2.25855;
	double 	c2 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
	double 	c3 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576;
	double 	eta_eff = eta_d*(eta_d*(c3*eta_d + c2) + c1);
	double 	ghs = (1.0 + -0.5*eta_eff)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	deta_eff_by_deta_d = eta_d*(3.0*c3*eta_d + 2.0*c2) + c1;
	double 	dghs_by_deta_d = deta_eff_by_deta_d*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_deta_d = epsilon_dispersion*(dghs_by_deta_d*eta_d + ghs)*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	deltak = 12.566370614359172*R*R;
	double 	deltaprime = -25.132741228718345*R;
	double 	step = 4.188790204786391*R*R*R;
	double 	n3 = n*step;
	double 	n0 = 7.957747154594767e-2*deltak*n/(R*R);
	double 	n2 = deltak*n;
	double 	n1 = 7.957747154594767e-2*deltak*n/R;
	double 	dAdR = kT*n*(deltaprime*((n2*(n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/R) + -1.0*n1)/(1.0 + -1.0*n3) + 7.957747154594767e-2*log(1.0 + -1.0*n3)/(R*R)) + deltak*((n2*((n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/(R*R)) + n0)/(1.0 + -1.0*n3) + 0.15915494309189535*log(1.0 + -1.0*n3)/(R*R*R)));
	double 	dc1_by_dlambda_dispersion = -1.50349*1.0 + 0.498868*lambda_dispersion;
	double 	dc2_by_dlambda_dispersion = 1.40049*1.0 + -1.655478*lambda_dispersion;
	double 	dc3_by_dlambda_dispersion = -15.0427*1.0 + 10.61654*lambda_dispersion;
	double 	deta_eff_by_dlambda_dispersion = eta_d*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion);
	double 	dghs_by_dlambda_dispersion = deta_eff_by_dlambda_dispersion*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_dlambda_dispersion = epsilon_dispersion*eta_d*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0));
	double 	deltak2 = 50.26548245743669*R*R;
	double 	gSW = (-8.333333333333333e-2*da1_by_dlambda_dispersion*lambda_dispersion/eta_d + dAdR/(deltak2*n*n) + 0.25*da1_by_deta_d)/kT;
	double 	deltasaft = boltz*gSW*kappa_association;
	double 	delta2k = 50.26548245743669*R*R;
	double 	nA = 1.9894367886486918e-2*delta2k*n/(R*R);
	double 	X = (0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA);
	double 	Fassoc = kT*n*(2.0*1.0 + 4.0*log(X) + -2.0*X);
	double 	a1 = epsilon_dispersion*eta_d*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	a1integrated = a1*n;
	double 	KHS = (eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0);
	double 	a2 = 0.5*KHS*da1_by_deta_d*epsilon_dispersion*eta_d;
	double 	a2integrated = a2*n/kT;
	double 	Fdisp = a2integrated + a1integrated;
	double 	Fideal = kT*n*(-1.0*1.0 + log(2.646476976618268e-6*n/(sqrt(kT)*kT)));
	double 	phi1 = -1.0*n0*log(1.0 + -1.0*n3);
	double 	kTphi1 = kT*phi1;
	double 	phi2 = n1*n2/(1.0 + -1.0*n3);
	double 	kTphi2 = kT*phi2;
	double 	phi3 = n2*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	kTphi3 = kT*phi3;
	double 	whitebear = kTphi3 + kTphi2 + kTphi1;
	double 	FSAFT = mu*n + whitebear + Fideal + Fdisp + Fassoc;
	output = FSAFT;

	return output;

}

bool append_to_name( std::string) const {
	return false;}

double derive(double kT, double x) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	double output = 0;
	double 	boltz = -1.0*1.0 + exp(epsilon_association/kT);
	double 	n = x;
	double 	eta_d = 4.1887902047863905*R*R*R*n;
	double 	c1 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + 2.25855;
	double 	c2 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
	double 	c3 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576;
	double 	eta_eff = eta_d*(eta_d*(c3*eta_d + c2) + c1);
	double 	ghs = (1.0 + -0.5*eta_eff)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	deta_eff_by_deta_d = eta_d*(3.0*c3*eta_d + 2.0*c2) + c1;
	double 	dghs_by_deta_d = deta_eff_by_deta_d*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_deta_d = epsilon_dispersion*(dghs_by_deta_d*eta_d + ghs)*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	deltak = 12.566370614359172*R*R;
	double 	deltaprime = -25.132741228718345*R;
	double 	step = 4.188790204786391*R*R*R;
	double 	n3 = n*step;
	double 	n0 = 7.957747154594767e-2*deltak*n/(R*R);
	double 	n2 = deltak*n;
	double 	n1 = 7.957747154594767e-2*deltak*n/R;
	double 	dAdR = kT*n*(deltaprime*((n2*(n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/R) + -1.0*n1)/(1.0 + -1.0*n3) + 7.957747154594767e-2*log(1.0 + -1.0*n3)/(R*R)) + deltak*((n2*((n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/(R*R)) + n0)/(1.0 + -1.0*n3) + 0.15915494309189535*log(1.0 + -1.0*n3)/(R*R*R)));
	double 	dc1_by_dlambda_dispersion = -1.50349*1.0 + 0.498868*lambda_dispersion;
	double 	dc2_by_dlambda_dispersion = 1.40049*1.0 + -1.655478*lambda_dispersion;
	double 	dc3_by_dlambda_dispersion = -15.0427*1.0 + 10.61654*lambda_dispersion;
	double 	deta_eff_by_dlambda_dispersion = eta_d*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion);
	double 	dghs_by_dlambda_dispersion = deta_eff_by_dlambda_dispersion*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	da1_by_dlambda_dispersion = epsilon_dispersion*eta_d*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0));
	double 	deltak2 = 50.26548245743669*R*R;
	double 	gSW = (-8.333333333333333e-2*da1_by_dlambda_dispersion*lambda_dispersion/eta_d + dAdR/(deltak2*n*n) + 0.25*da1_by_deta_d)/kT;
	double 	deltasaft = boltz*gSW*kappa_association;
	double 	delta2k = 50.26548245743669*R*R;
	double 	nA = 1.9894367886486918e-2*delta2k*n/(R*R);
	double 	X = (0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA);
	double 	dn0_by_dx = 7.957747154594767e-2*deltak/(R*R);
	double 	dn1_by_dx = 7.957747154594767e-2*deltak/R;
	double 	dn2_by_dx = deltak;
	double 	dn3_by_dx = step;
	double 	ddAdR_by_dx = kT*(deltaprime*((n2*(n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/R) + -1.0*n1)/(1.0 + -1.0*n3) + 7.957747154594767e-2*log(1.0 + -1.0*n3)/(R*R)) + deltak*((n2*((n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/(R*R)) + n0)/(1.0 + -1.0*n3) + 0.15915494309189535*log(1.0 + -1.0*n3)/(R*R*R))) + deltaprime*dn3_by_dx*kT*n*(n2*(n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/R) + -1.0*n1)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltaprime*dn3_by_dx*kT*n*n2*n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 2.6525823848649224e-2*deltaprime*dn3_by_dx*kT*n*n2*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*deltaprime*dn3_by_dx*kT*n*n2*n2*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*deltaprime*dn3_by_dx*kT*n*n2*n2*(log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 2.6525823848649224e-2*deltaprime*dn3_by_dx*kT*n*n2*n2*log(1.0 + -1.0*n3)/(n3*n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltaprime*dn2_by_dx*kT*n*(n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/R)/(1.0 + -1.0*n3) + deltaprime*dn2_by_dx*kT*n*n2*((log(1.0 + -1.0*n3)*(-2.6525823848649224e-2*1.0/n3 + 5.305164769729845e-2) + -2.6525823848649224e-2)/n3 + -2.6525823848649224e-2*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*deltaprime*dn1_by_dx*kT*n/(1.0 + -1.0*n3) + deltak*dn3_by_dx*kT*n*(n2*((n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/(R*R)) + n0)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -3.53677651315323e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2/(((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + 3.53677651315323e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2*log(1.0 + -1.0*n3)/(((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -1.0*deltak*dn3_by_dx*kT*n*n2*n2*n2*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 3.53677651315323e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2/(n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -8.841941282883076e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2*log(1.0 + -1.0*n3)/(n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -1.0*deltak*dn3_by_dx*kT*n*n2*n2*n2*(3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*deltak*dn3_by_dx*kT*n*n2*n2*n2*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.768388256576615e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2/(n3*n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + deltak*dn3_by_dx*kT*n*n2*n2*n2*log(1.0 + -1.0*n3)*(-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(n3*n3*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))*((1.0 + -1.0*n3)*(1.0 + -1.0*n3))) + -1.0*deltak*dn3_by_dx*kT*n*n2*n2*n2*(-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/(n3*n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 1.768388256576615e-2*deltak*dn3_by_dx*kT*n*n2*n2*n2*log(1.0 + -1.0*n3)/((n3*n3)*(n3*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltak*dn3_by_dx*kT*n*n2*(n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltak*dn2_by_dx*kT*n*((n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3) + n1)/(1.0 + -1.0*n3) + -7.957747154594767e-2*1.0/(R*R))/(1.0 + -1.0*n3) + 2.0*deltak*dn2_by_dx*kT*n*n2*n2*(3.53677651315323e-2*log(1.0 + -1.0*n3)/(1.0 + -1.0*n3) + (3.53677651315323e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*(-8.841941282883076e-2*1.0/(1.0 + -1.0*n3) + 1.768388256576615e-2) + (-1.768388256576615e-2*1.0/(1.0 + -1.0*n3) + log(1.0 + -1.0*n3)*((-1.768388256576615e-2*1.0/n3 + 7.07355302630646e-2)/(1.0 + -1.0*n3) + -1.768388256576615e-2))/n3 + 8.841941282883075e-3)/n3)/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltak*dn1_by_dx*kT*n*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + deltak*dn0_by_dx*kT*n/(1.0 + -1.0*n3) + -7.957747154594767e-2*deltaprime*dn3_by_dx*kT*n/(R*R*(1.0 + -1.0*n3)) + -0.15915494309189535*deltak*dn3_by_dx*kT*n/(R*R*R*(1.0 + -1.0*n3));
	double 	deta_d_by_dx = 4.1887902047863905*R*R*R;
	double 	ddeta_eff_by_deta_d_by_dx = deta_d_by_dx*(3.0*c3*eta_d + 2.0*c2) + 3.0*c3*deta_d_by_dx*eta_d;
	double 	deta_eff_by_dx = deta_d_by_dx*(eta_d*(c3*eta_d + c2) + c1) + deta_d_by_dx*eta_d*(c3*eta_d + c2) + c3*deta_d_by_dx*eta_d*eta_d;
	double 	ddghs_by_deta_d_by_dx = 3.0*deta_eff_by_deta_d*deta_eff_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + -1.5*deta_eff_by_deta_d*deta_eff_by_dx/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + deta_eff_by_deta_d*deta_eff_by_dx*(3.0*1.0 + -1.5*eta_eff)/((1.0 + -1.0*eta_eff)*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + ddeta_eff_by_deta_d_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	dghs_by_dx = -0.5*deta_eff_by_dx/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)) + 3.0*deta_eff_by_dx*(1.0 + -0.5*eta_eff)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)));
	double 	dda1_by_deta_d_by_dx = dghs_by_dx*epsilon_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + deta_d_by_dx*dghs_by_deta_d*epsilon_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + ddghs_by_deta_d_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	ddeta_eff_by_dlambda_dispersion_by_dx = deta_d_by_dx*(eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc1_by_dlambda_dispersion) + deta_d_by_dx*eta_d*(dc3_by_dlambda_dispersion*eta_d + dc2_by_dlambda_dispersion) + dc3_by_dlambda_dispersion*deta_d_by_dx*eta_d*eta_d;
	double 	ddghs_by_dlambda_dispersion_by_dx = 3.0*deta_eff_by_dlambda_dispersion*deta_eff_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + -1.5*deta_eff_by_dlambda_dispersion*deta_eff_by_dx/(((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + deta_eff_by_dlambda_dispersion*deta_eff_by_dx*(3.0*1.0 + -1.5*eta_eff)/((1.0 + -1.0*eta_eff)*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))*((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff))) + ddeta_eff_by_dlambda_dispersion_by_dx*((3.0*1.0 + -1.5*eta_eff)/(1.0 + -1.0*eta_eff) + -0.5)/((1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff)*(1.0 + -1.0*eta_eff));
	double 	dda1_by_dlambda_dispersion_by_dx = -12.0*dghs_by_dx*epsilon_dispersion*eta_d*lambda_dispersion*lambda_dispersion + deta_d_by_dx*epsilon_dispersion*(-12.0*ghs*lambda_dispersion*lambda_dispersion + dghs_by_dlambda_dispersion*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0)) + ddghs_by_dlambda_dispersion_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	dgSW_by_dx = -8.333333333333333e-2*dda1_by_dlambda_dispersion_by_dx*lambda_dispersion/(eta_d*kT) + 0.25*dda1_by_deta_d_by_dx/kT + ddAdR_by_dx/(deltak2*kT*n*n) + 8.333333333333333e-2*da1_by_dlambda_dispersion*deta_d_by_dx*lambda_dispersion/(eta_d*eta_d*kT) + -2.0*dAdR/(deltak2*kT*n*n*n);
	double 	ddeltasaft_by_dx = boltz*dgSW_by_dx*kappa_association;
	double 	dnA_by_dx = 1.9894367886486918e-2*delta2k/(R*R);
	double 	dX_by_dx = dnA_by_dx/(nA*sqrt(8.0*deltasaft*nA + 1.0)) + -1.0*dnA_by_dx*(0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*nA*nA) + ddeltasaft_by_dx/(deltasaft*sqrt(8.0*deltasaft*nA + 1.0)) + -1.0*ddeltasaft_by_dx*(0.25*sqrt(8.0*deltasaft*nA + 1.0) + -0.25)/(deltasaft*deltasaft*nA);
	double 	dFassoc_by_dx = kT*(2.0*1.0 + 4.0*log(X) + -2.0*X) + -2.0*dX_by_dx*kT*n + 4.0*dX_by_dx*kT*n/X;
	double 	a1 = epsilon_dispersion*eta_d*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	da1_by_dx = dghs_by_dx*epsilon_dispersion*eta_d*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0) + deta_d_by_dx*epsilon_dispersion*ghs*(-4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + 4.0);
	double 	da1integrated_by_dx = da1_by_dx*n + a1;
	double 	KHS = (eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0);
	double 	a2 = 0.5*KHS*da1_by_deta_d*epsilon_dispersion*eta_d;
	double 	dKHS_by_dx = deta_d_by_dx*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + -1.0*deta_d_by_dx*(4.0*1.0 + 4.0*eta_d)*(eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/((eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)*(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)) + deta_d_by_dx*eta_d*eta_d*eta_d/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + deta_d_by_dx*eta_d*eta_d*(-4.0*1.0 + eta_d)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + deta_d_by_dx*eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0)/(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0) + -4.0*deta_d_by_dx*eta_d*(eta_d*(eta_d*(eta_d*(-4.0*1.0 + eta_d) + 6.0) + -4.0) + 1.0)/((eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0)*(eta_d*(4.0*1.0 + 4.0*eta_d) + 1.0));
	double 	da2_by_dx = 0.5*dKHS_by_dx*da1_by_deta_d*epsilon_dispersion*eta_d + 0.5*KHS*dda1_by_deta_d_by_dx*epsilon_dispersion*eta_d + 0.5*KHS*da1_by_deta_d*deta_d_by_dx*epsilon_dispersion;
	double 	da2integrated_by_dx = da2_by_dx*n/kT + a2/kT;
	double 	dFdisp_by_dx = da2integrated_by_dx + da1integrated_by_dx;
	double 	dFideal_by_dx = kT*(-1.0*1.0 + log(2.646476976618268e-6*n/(sqrt(kT)*kT))) + kT;
	double 	dphi1_by_dx = dn3_by_dx*n0/(1.0 + -1.0*n3) + -1.0*dn0_by_dx*log(1.0 + -1.0*n3);
	double 	dkTphi1_by_dx = dphi1_by_dx*kT;
	double 	dphi2_by_dx = dn3_by_dx*n1*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + dn2_by_dx*n1/(1.0 + -1.0*n3) + dn1_by_dx*n2/(1.0 + -1.0*n3);
	double 	dkTphi2_by_dx = dphi2_by_dx*kT;
	double 	dphi3_by_dx = 2.0*dn3_by_dx*n2*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -8.841941282883075e-3*dn3_by_dx*n2*n2*n2/((1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2)/(n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -1.0*dn3_by_dx*n2*n2*n2*(log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/(n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + -8.841941282883075e-3*dn3_by_dx*n2*n2*n2*log(1.0 + -1.0*n3)/(n3*n3*n3*(1.0 + -1.0*n3)*(1.0 + -1.0*n3)) + 3.0*dn2_by_dx*n2*n2*((log(1.0 + -1.0*n3)*(8.841941282883075e-3*1.0/n3 + -1.768388256576615e-2) + 8.841941282883075e-3)/n3 + 8.841941282883075e-3*log(1.0 + -1.0*n3))/((1.0 + -1.0*n3)*(1.0 + -1.0*n3));
	double 	dkTphi3_by_dx = dphi3_by_dx*kT;
	double 	dwhitebear_by_dx = dkTphi3_by_dx + dkTphi2_by_dx + dkTphi1_by_dx;
	double 	dFSAFT_by_dx = mu + dwhitebear_by_dx + dFideal_by_dx + dFdisp_by_dx + dFassoc_by_dx;
	output = dFSAFT_by_dx;

	return output;

}

double d_by_dT(double , double ) const {
	assert(0); // fail
	return 0;

}

Functional grad(const Functional &ingrad, const Functional &x, bool ) const {
	return ingrad;}

Functional grad_T(const Functional &ingradT) const {
	return ingradT;}

void grad(const GridDescription &gd, double kT, const VectorXd &x, const VectorXd &ingrad, VectorXd *outgrad, VectorXd *outpgrad) const {
	if (oldkT != kT) {
		oldkT = kT;

	}
	VectorXcd ktemp0(gd.NxNyNzOver2);
	ktemp0 = fft(gd, x);

	VectorXcd ktemp1(gd.NxNyNzOver2);
	ktemp1[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp1[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp2(gd.NxNyNz);
	rtemp2 = ifft(gd, ktemp1);

	ktemp1.resize(0); // KSpace
	VectorXcd ktemp3(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp3[0] = 50.26548245743669*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp3[i] = 25.132741228718345*R*ktemp0[i]*sin(2.0*R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp4(gd.NxNyNz);
	rtemp4 = ifft(gd, ktemp3);

	ktemp3.resize(0); // KSpace
	VectorXcd ktemp5(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp5[0] = ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		ktemp5[i] = ktemp0[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*(0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0]));
	}

	VectorXd rtemp6(gd.NxNyNz);
	rtemp6 = ifft(gd, ktemp5);

	ktemp5.resize(0); // KSpace
	VectorXcd ktemp7(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp7[0] = 4.188790204786391*R*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp7[i] = 12.566370614359172*ktemp0[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*t2*cos(t2) + sin(t2))/(sqrt(t1)*t1);
	}

	VectorXd rtemp8(gd.NxNyNz);
	rtemp8 = ifft(gd, ktemp7);

	ktemp7.resize(0); // KSpace
	VectorXd rtemp9(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp9[i] = -7.957747154594767e-2*rtemp2[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp10(gd.NxNyNzOver2);
	ktemp10 = fft(gd, rtemp9);

	rtemp9.resize(0); // Realspace
	VectorXcd ktemp11(gd.NxNyNzOver2);
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp11[0] = 12.566370614359172*R*R*ktemp0[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp11[i] = 12.566370614359172*R*ktemp0[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp12(gd.NxNyNz);
	rtemp12 = ifft(gd, ktemp11);

	ktemp11.resize(0); // KSpace
	VectorXd rtemp13(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp13[i] = rtemp2[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp14(gd.NxNyNzOver2);
	ktemp14 = fft(gd, rtemp13);

	rtemp13.resize(0); // Realspace
	VectorXcd ktemp15(gd.NxNyNzOver2);
	ktemp15[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp15[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp16(gd.NxNyNz);
	rtemp16 = ifft(gd, ktemp15);

	ktemp15.resize(0); // KSpace
	VectorXd rtemp17(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp17[i] = rtemp16[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp18(gd.NxNyNzOver2);
	ktemp18 = fft(gd, rtemp17);

	rtemp17.resize(0); // Realspace
	VectorXcd ktemp19(gd.NxNyNzOver2);
	ktemp19[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp19[i] = 12.566370614359172*ktemp0[i]*complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + R*cos(t2))/t1;
	}

	VectorXd rtemp20(gd.NxNyNz);
	rtemp20 = ifft(gd, ktemp19);

	ktemp19.resize(0); // KSpace
	VectorXd rtemp21(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		rtemp21[i] = rtemp20[i]*(-5.305164769729845e-2*rtemp12[i]*(t1*t1*log(t1) + rtemp8[i])/(t1*rtemp8[i]*rtemp8[i]) + -0.15915494309189535*1.0/R)/t1;
	}

	VectorXcd ktemp22(gd.NxNyNzOver2);
	ktemp22 = fft(gd, rtemp21);

	rtemp21.resize(0); // Realspace
	VectorXd rtemp23(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = rtemp12[i]*rtemp12[i];
		const double t4 = rtemp16[i]*rtemp16[i];
		const double t5 = rtemp20[i]*rtemp20[i];
		const double t6 = rtemp2[i]*rtemp2[i];
		rtemp23[i] = rtemp12[i]*(-3.0*t6 + -3.0*t5 + -3.0*t4 + t3)*(-8.841941282883075e-3*(2.0*1.0 + -4.0*rtemp8[i])*(t1*t2*t2 + rtemp8[i])/(t2*rtemp8[i]) + -1.768388256576615e-2*t1*t2 + 8.841941282883075e-3*rtemp8[i])/(t2*t2*rtemp8[i]*rtemp8[i]) + (((-7.957747154594767e-2*t6 + -7.957747154594767e-2*t5 + -7.957747154594767e-2*t4 + 7.957747154594767e-2*t3)/t2 + 7.957747154594767e-2*rtemp12[i]/R)/t2 + (-7.957747154594767e-2*rtemp12[i]/t2 + 0.15915494309189535*t1/R)/R)/R;
	}

	VectorXcd ktemp24(gd.NxNyNzOver2);
	ktemp24 = fft(gd, rtemp23);

	rtemp23.resize(0); // Realspace
	VectorXd rtemp25(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp25[i] = -7.957747154594767e-2*rtemp16[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp26(gd.NxNyNzOver2);
	ktemp26 = fft(gd, rtemp25);

	rtemp25.resize(0); // Realspace
	VectorXd rtemp27(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		rtemp27[i] = -7.957747154594767e-2*rtemp20[i]/(R*R*(1.0 + -1.0*rtemp8[i]));
	}

	VectorXcd ktemp28(gd.NxNyNzOver2);
	ktemp28 = fft(gd, rtemp27);

	rtemp27.resize(0); // Realspace
	VectorXd rtemp29(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0/(1.0 + -1.0*rtemp8[i]);
		rtemp29[i] = t2*(8.841941282883075e-3*t2*(t1/(t2*t2) + rtemp8[i])*(-3.0*rtemp2[i]*rtemp2[i] + -3.0*rtemp20[i]*rtemp20[i] + -3.0*rtemp16[i]*rtemp16[i] + 3.0*rtemp12[i]*rtemp12[i])/(rtemp8[i]*rtemp8[i]) + 7.957747154594767e-2*rtemp12[i]/R) + (7.957747154594767e-2*t2*rtemp12[i] + -7.957747154594767e-2*t1/R)/R;
	}

	VectorXcd ktemp30(gd.NxNyNzOver2);
	ktemp30 = fft(gd, rtemp29);

	rtemp29.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp30[0] = R*(12.566370614359172*R*ktemp24[i] + 25.132741228718345*ktemp30[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sin(R*sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t2 = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t3 = 1.0/(sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]));
		const complex t4 = R*cos(R/t3);
		const complex t5 = t1*t3;
		ktemp30[i] = -12.566370614359172*t2*ktemp30[i]*(-1.0*t5 + -1.0*t4) + t2*t3*t3*complex(0,1)*(-1.0*t5 + t4)*(12.566370614359172*ktemp28[i]*k_i[2] + 12.566370614359172*ktemp26[i]*k_i[1] + 12.566370614359172*ktemp10[i]*k_i[0]) + R*(12.566370614359172*t2*t5*ktemp24[i] + t1*t2*complex(0,1)*(12.566370614359172*t3*ktemp22[i]*k_i[2] + 12.566370614359172*t3*ktemp18[i]*k_i[1] + 12.566370614359172*t3*ktemp14[i]*k_i[0]));
	}

	ktemp28.resize(0); // KSpace
	ktemp26.resize(0); // KSpace
	ktemp24.resize(0); // KSpace
	ktemp22.resize(0); // KSpace
	ktemp18.resize(0); // KSpace
	ktemp14.resize(0); // KSpace
	ktemp10.resize(0); // KSpace
	VectorXd rtemp32(gd.NxNyNz);
	rtemp32 = ifft(gd, ktemp30);

	ktemp30.resize(0); // KSpace
	VectorXd rtemp33(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp33[i] = R*kT*t4*x[i]*(23812.820490470258*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -3789.9280900183135*1.0 + -1894.9640450091567*t3)/rtemp4[i] + 301.59289474462014*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp34(gd.NxNyNzOver2);
	ktemp34 = fft(gd, rtemp33);

	rtemp33.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp34[0] = R*ktemp34[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp34[i] = ktemp34[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp36(gd.NxNyNz);
	rtemp36 = ifft(gd, ktemp34);

	ktemp34.resize(0); // KSpace
	VectorXd rtemp37(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp37[i] = kT*x[i]*(t4*(-210.551560556573*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 33.51032163829113*1.0 + 16.755160819145566*t3)/rtemp4[i] + -2.666666666666667*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp38(gd.NxNyNzOver2);
	ktemp38 = fft(gd, rtemp37);

	rtemp37.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp38[0] = R*(8.377580409572783*R*kT*ktemp0[i] + -2.0*ktemp38[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp38[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp38[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + 8.377580409572783*R*kT*t3*ktemp0[i]);
	}

	VectorXd rtemp40(gd.NxNyNz);
	rtemp40 = ifft(gd, ktemp38);

	ktemp38.resize(0); // KSpace
	VectorXd rtemp41(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp41[i] = kT*x[i]*(t4*(631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -100.53096491487338*1.0 + -50.26548245743669*t3)/rtemp4[i] + 8.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp42(gd.NxNyNzOver2);
	ktemp42 = fft(gd, rtemp41);

	rtemp41.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp42[0] = R*ktemp42[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp42[i] = ktemp42[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp44(gd.NxNyNz);
	rtemp44 = ifft(gd, ktemp42);

	ktemp42.resize(0); // KSpace
	VectorXd rtemp45(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp45[i] = kT*x[i]*(t4*(-315.82734083485946*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp4[i] + -4.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp46(gd.NxNyNzOver2);
	ktemp46 = fft(gd, rtemp45);

	rtemp45.resize(0); // Realspace
	VectorXd rtemp47(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t5 = kT*x[i];
		rtemp47[i] = -315.82734083485946*t4*t4*t5/(kappa_association*t1*t2*rtemp4[i]*rtemp4[i]) + (t5*(t4*(50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp4[i] + -4.0*kappa_association*t1*t2*t3/(R*R))/R + 25.132741228718345*t5)/R;
	}

	VectorXcd ktemp48(gd.NxNyNzOver2);
	ktemp48 = fft(gd, rtemp47);

	rtemp47.resize(0); // Realspace
	VectorXcd ktemp49(gd.NxNyNzOver2);
	ktemp49[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp49[i] = complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp48[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp50(gd.NxNyNz);
	rtemp50 = ifft(gd, ktemp49);

	ktemp49.resize(0); // KSpace
	VectorXd rtemp51(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp51[i] = R*kT*t4*x[i]*(3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -631.6546816697189*1.0 + -315.82734083485946*t3)/rtemp4[i] + 50.26548245743669*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp52(gd.NxNyNzOver2);
	ktemp52 = fft(gd, rtemp51);

	rtemp51.resize(0); // Realspace
	VectorXcd ktemp53(gd.NxNyNzOver2);
	ktemp53[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp53[i] = ktemp52[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp54(gd.NxNyNz);
	rtemp54 = ifft(gd, ktemp53);

	ktemp53.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = t1*t1*log(t1) + rtemp8[i];
		rtemp54[i] = rtemp2[i]*((rtemp12[i]*rtemp36[i]*(-1.768388256576615e-2*t1*log(t1) + -8.841941282883075e-3*t2*(2.0*1.0 + -4.0*rtemp8[i])/(t1*rtemp8[i]) + 8.841941282883075e-3*rtemp8[i]) + t2*rtemp40[i])/(t1*t1*rtemp8[i]*rtemp8[i]) + rtemp44[i]/(t1*t1)) + (rtemp54[i]*(-5.305164769729845e-2*t2*rtemp12[i]/(t1*rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R) + rtemp50[i])/t1;
	}

	rtemp50.resize(0); // Realspace
	VectorXcd ktemp56(gd.NxNyNzOver2);
	ktemp56 = fft(gd, rtemp54);

	rtemp54.resize(0); // Realspace
	VectorXcd ktemp57(gd.NxNyNzOver2);
	ktemp57[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp57[i] = complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp48[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp58(gd.NxNyNz);
	rtemp58 = ifft(gd, ktemp57);

	ktemp57.resize(0); // KSpace
	VectorXcd ktemp59(gd.NxNyNzOver2);
	ktemp59[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp59[i] = ktemp52[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp60(gd.NxNyNz);
	rtemp60 = ifft(gd, ktemp59);

	ktemp59.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = t1*t1*log(t1) + rtemp8[i];
		rtemp60[i] = rtemp16[i]*((rtemp12[i]*rtemp36[i]*(-1.768388256576615e-2*t1*log(t1) + -8.841941282883075e-3*t2*(2.0*1.0 + -4.0*rtemp8[i])/(t1*rtemp8[i]) + 8.841941282883075e-3*rtemp8[i]) + t2*rtemp40[i])/(t1*t1*rtemp8[i]*rtemp8[i]) + rtemp44[i]/(t1*t1)) + (rtemp60[i]*(-5.305164769729845e-2*t2*rtemp12[i]/(t1*rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R) + rtemp58[i])/t1;
	}

	rtemp58.resize(0); // Realspace
	VectorXcd ktemp62(gd.NxNyNzOver2);
	ktemp62 = fft(gd, rtemp60);

	rtemp60.resize(0); // Realspace
	ktemp48[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp48[i] = complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp46[i] + ktemp48[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	ktemp46.resize(0); // KSpace
	VectorXd rtemp64(gd.NxNyNz);
	rtemp64 = ifft(gd, ktemp48);

	ktemp48.resize(0); // KSpace
	VectorXcd ktemp65(gd.NxNyNzOver2);
	ktemp65[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp65[i] = ktemp52[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp66(gd.NxNyNz);
	rtemp66 = ifft(gd, ktemp65);

	ktemp65.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = t1*t1*log(t1) + rtemp8[i];
		rtemp66[i] = rtemp20[i]*((rtemp12[i]*rtemp36[i]*(-1.768388256576615e-2*t1*log(t1) + -8.841941282883075e-3*t2*(2.0*1.0 + -4.0*rtemp8[i])/(t1*rtemp8[i]) + 8.841941282883075e-3*rtemp8[i]) + t2*rtemp40[i])/(t1*t1*rtemp8[i]*rtemp8[i]) + rtemp44[i]/(t1*t1)) + (rtemp66[i]*(-5.305164769729845e-2*t2*rtemp12[i]/(t1*rtemp8[i]*rtemp8[i]) + -7.957747154594767e-2*1.0/R) + rtemp64[i])/t1;
	}

	rtemp64.resize(0); // Realspace
	rtemp44.resize(0); // Realspace
	rtemp40.resize(0); // Realspace
	rtemp36.resize(0); // Realspace
	VectorXcd ktemp68(gd.NxNyNzOver2);
	ktemp68 = fft(gd, rtemp66);

	rtemp66.resize(0); // Realspace
	VectorXd rtemp69(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = -4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0;
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/t3 + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/(t3*t3*t3) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t3 + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t3*t3*t3))/kT)/(R*R) + 1.0));
		const double t5 = -2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0;
		const double t6 = -50.26548245743669*lambda_dispersion*lambda_dispersion*t5 + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(-2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*t5*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t3 + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion));
		const double t7 = 4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0;
		const double t8 = -4.1887902047863905*R*R*R*rtemp6[i] + 1.0;
		const double t9 = 1.0/(4.0*(4.1887902047863905*R*R*R*rtemp6[i])*(4.1887902047863905*R*R*R*rtemp6[i]) + 16.755160819145562*R*R*R*rtemp6[i] + 1.0);
		const double t10 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855;
		const double t11 = lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion);
		const double t12 = t5*(10.1576*1.0 + t11)/t3;
		const double t13 = 10.1576*1.0 + t11;
		const double t14 = 3694.3299710673505*t5/t3 + -923.5824927668376;
		const double t15 = 4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion);
		const double t16 = rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*(t7*(-4.1887902047863905*R*R*R*rtemp6[i]*(3.0*t10*t5/t3 + -0.5*t10) + -1.0*t5)/(t3*t3*t3) + -7.957747154594767e-2*lambda_dispersion*t6/(t3*t3*t3))/kT;
		const double t17 = lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + -0.66927;
		const double t18 = R*R*R*rtemp6[i]*(52.63789013914324*R*R*R*t13*rtemp6[i] + 8.377580409572781*t17);
		const double t19 = lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion);
		const double t20 = t10*t5/t3;
		const double t21 = -587.9708763079075*1.0 + -293.98543815395374*t4;
		const double t22 = 11082.989913202051*t5/t3 + -1847.1649855336752;
		const double t23 = -15.0427*1.0 + 10.61654*lambda_dispersion;
		const double t24 = t13*t22/(t16*t16*t3*t3*t3);
		const double t25 = 46.78923567923842*t4*t5/t3 + -11.697308919809606*t4;
		const double t26 = R*R*R*rtemp6[i]*(17.54596337971441*R*R*R*t13*rtemp6[i] + 4.1887902047863905*t17);
		const double t27 = t5*(2.25855*1.0 + t26 + t19)/t3;
		const double t28 = t9*(-4.1887902047863905*R*R*R*rtemp6[i]*(3.0*t20 + -0.5*t10) + -1.0*t5);
		const double t29 = -0.5*t13*t21/t16 + 3.0000000000000004*t12*t21/t16;
		const double t30 = t15*t21/t16;
		const double t31 = t21/t16;
		const double t32 = t31*t5/t3;
		const double t33 = t10*t31;
		const double t34 = t29/(t3*t3*t3);
		const double t35 = 1322.9344716927922*t5/t3 + -220.48907861546533;
		const double t36 = 2.25855*1.0 + t26 + t19;
		const double t37 = 1.40049*1.0 + -1.655478*lambda_dispersion;
		const double t38 = 220.48907861546533*t5/t3 + -36.74817976924422;
		const double t39 = 140.3677070377153*t4*t5/t3 + -23.39461783961921*t4;
		const double t40 = t13*t39/(t3*t3*t3);
		const double t41 = -210.55156055657295*1.0 + -105.27578027828648*t4;
		const double t42 = 5.968310365946076e-2*t32 + -9.947183943243459e-3*t31;
		const double t43 = t41/t16;
		const double t44 = -1.50349*1.0 + 0.498868*lambda_dispersion;
		const double t45 = 3.0*t15*t5/t3 + -0.5*t15;
		const double t46 = t35*t36/(t16*t16);
		const double t47 = 3.0*t20 + -0.5*t10;
		const double t48 = -1.4248291449703753e-2*t31*t36 + 8.548974869822253e-2*t27*t31;
		const double t49 = lambda_dispersion*lambda_dispersion*t5;
		const double t50 = t36*t39;
		rtemp69[i] = epsilon_dispersion*lambda_dispersion*(1.3534253949046735e-4*t31*t6*x[i]/(t3*t3*t3*rtemp6[i]) + t49*x[i]*(-4.000000000000001*1.0 + -2.0*t4)/(t16*t3*t3*t3*rtemp6[i])) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp4[i]*x[i]*(-0.3333333333333333*t4*t47 + -7.124145724851877e-3*t50)/(t3*t3*t3) + lambda_dispersion*(rtemp4[i]*x[i]*(2.6525823848649224e-2*t1*t2*t4*t45*t7/(t3*t3*t3*rtemp6[i]) + 2.374715241617292e-3*t1*t2*t39*t44*t7/(t3*t3*t3)) + 2.8496582899407506e-2*lambda_dispersion*lambda_dispersion*t1*t2*t50*rtemp4[i]*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*lambda_dispersion*x[i]*(-2.094395102393195*R*R*R*t45*t7 + 7.105427357601002e-15*t49)/(kappa_association*t1*t16*t16*t2*t3*t3*t3*rtemp4[i]*rtemp6[i]) + R*(epsilon_dispersion*(t7*x[i]*((2.0943951023931953*epsilon_dispersion*t28*(t8*t8)*(t8*t8)/kT + -4.1887902047863905*t5 + -0.25*t48)/(t3*t3*t3) + -7.124145724851877e-3*t31*t47/(t3*t3*t3)) + lambda_dispersion*(x[i]*(0.11936620731892152*t42*t44*t7/(t3*t3*t3) + 5.66921503708585e-4*t31*t45*t7/(t3*t3*t3*rtemp6[i])) + lambda_dispersion*lambda_dispersion*t48*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp4[i]*rtemp6[i]*x[i]*(t17*(-12.566370614359172*t4*t5/t3 + 2.0943951023931953*t4)/(t3*t3*t3) + -0.3580986219567646*t10*t25*t36/((t3*t3)*(t3*t3))) + lambda_dispersion*(x[i]*(1.9894367886486918e-2*t1*t2*t37*t39*t7*rtemp4[i]*rtemp6[i]/(t3*t3*t3) + 2.8496582899407506e-2*t1*t15*t2*t25*t36*t7*rtemp4[i]/((t3*t3)*(t3*t3))) + 0.11936620731892152*lambda_dispersion*lambda_dispersion*t1*t17*t2*t39*rtemp4[i]*rtemp6[i]*x[i]/(t3*t3*t3))) + R*(epsilon_dispersion*(t7*x[i]*(-26.31894506957162*t47/(t16*t16) + -5.968310365946076e-2*t46)/(t1*t2*t3*t3*t3*rtemp4[i]) + lambda_dispersion*(x[i]*(2.0943951023931953*t45*t7/(t1*t16*t16*t2*t3*t3*t3*rtemp6[i]) + 0.11936620731892152*t38*t44*t7/(t1*t16*t16*t2*t3*t3*t3))/rtemp4[i] + 0.23873241463784303*lambda_dispersion*lambda_dispersion*t46*x[i]/(t1*t2*t3*t3*t3*rtemp4[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp6[i]*x[i]*(((-52.63789013914324*t36*t5 + -1.0*t20*t36*t43 + 0.25*t10*t36*t43)/t3 + 8.772981689857206*t36)/(t3*t3*t3) + t17*(0.125*t43 + -0.2685739664675735*t32)/(t3*t3*t3)) + lambda_dispersion*(x[i]*(t37*t42*t7*rtemp6[i]/(t3*t3*t3) + t7*(-7.124145724851877e-3*t30*t36 + 2.8496582899407506e-2*t27*t30)/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t17*rtemp6[i]*x[i]*(t43*t5/t3 + -5.968310365946076e-2*t31)/(t3*t3*t3)) + epsilon_dispersion*t7*rtemp6[i]*x[i]*((t8*t8)*(t8*t8)*t9*(19.81421779562699*1.0 + -26.31894506957162*t27 + 4.386490844928603*t26 + -26.31894506957162*t20 + 8.772981689857206*t19 + 4.386490844928603*t18)/(t3*t3*t3) + t28*t8*t8*t8*(-35.09192675942882*t8*t9 + -35.09192675942882)/(t3*t3*t3))/kT) + R*(epsilon_dispersion*kappa_association*(t1*t2*t7*rtemp4[i]*rtemp6[i]*rtemp6[i]*x[i]*(-1.5000000000000002*t10*t17*t25/((t3*t3)*(t3*t3)) + -1.0*t40) + lambda_dispersion*(rtemp6[i]*x[i]*(0.125*t1*t2*t23*t39*t7*rtemp4[i]*rtemp6[i]/(t3*t3*t3) + 0.11936620731892152*t1*t15*t17*t2*t25*t7*rtemp4[i]/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t1*t2*t40*rtemp4[i]*rtemp6[i]*rtemp6[i]*x[i])) + R*(epsilon_dispersion*(t7*rtemp6[i]*x[i]*(-8.952465548919114e-2*t17*t22/(t16*t16*t3*t3*t3) + -0.35809862195676456*t10*t14*t36/(t16*t16*(t3*t3)*(t3*t3)))/(t1*t2*rtemp4[i]) + lambda_dispersion*(x[i]*(t37*t38*t7*rtemp6[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp4[i]) + 2.8496582899407503e-2*t14*t15*t36*t7/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp4[i])) + lambda_dispersion*lambda_dispersion*t17*t35*rtemp6[i]*x[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp4[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp6[i]*rtemp6[i]*x[i]*(t17*((-1.5000000000000002*t20*t31 + -220.48907861546533*t5 + 0.37500000000000006*t33)/t3 + 36.74817976924422)/(t3*t3*t3) + -1.0*t34) + lambda_dispersion*(rtemp6[i]*x[i]*(6.283185307179586*t23*t42*t7*rtemp6[i]/(t3*t3*t3) + t17*t7*(0.11936620731892152*t30*t5/t3 + -2.984155182973038e-2*t30)/((t3*t3)*(t3*t3))) + lambda_dispersion*lambda_dispersion*t34*rtemp6[i]*rtemp6[i]*x[i]) + epsilon_dispersion*t7*rtemp6[i]*rtemp6[i]*x[i]*((t8*t8)*(t8*t8)*t9*(t10*(110.24453930773267*t36 + -440.97815723093066*t27)/t3 + -293.98543815395374*t28)/(t3*t3*t3) + -2.984155182973038e-2*t17*t22*(t8*t8)*(t8*t8)*t9/(t3*t3*t3))/kT) + R*(epsilon_dispersion*kappa_association*(-12.566370614359172*t1*t10*t13*t2*t25*t7*rtemp4[i]*rtemp6[i]*rtemp6[i]*rtemp6[i]*x[i]/((t3*t3)*(t3*t3)) + lambda_dispersion*t1*t13*t15*t2*t25*t7*rtemp4[i]*rtemp6[i]*rtemp6[i]*x[i]/((t3*t3)*(t3*t3))) + R*(epsilon_dispersion*(t7*rtemp6[i]*rtemp6[i]*x[i]*(-1.5*t10*t14*t17/(t16*t16*(t3*t3)*(t3*t3)) + -1.0*t24)/(t1*t2*rtemp4[i]) + lambda_dispersion*(rtemp6[i]*x[i]*(0.125*t22*t23*t7*rtemp6[i]/(t1*t16*t16*t2*t3*t3*t3*rtemp4[i]) + 0.11936620731892152*t14*t15*t17*t7/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp4[i])) + lambda_dispersion*lambda_dispersion*t24*rtemp6[i]*rtemp6[i]*x[i]/(t1*t2*rtemp4[i])))/kappa_association + R*(epsilon_dispersion*(t7*rtemp6[i]*rtemp6[i]*rtemp6[i]*x[i]*((-1847.164985533675*t13*t5 + 3.141592653589793*t13*t33 + -12.566370614359172*t12*t33)/t3 + 307.86083092227915*t13)/(t3*t3*t3) + lambda_dispersion*t7*rtemp6[i]*rtemp6[i]*x[i]*(-0.25*t13*t30 + t12*t30)/((t3*t3)*(t3*t3)) + epsilon_dispersion*t7*rtemp6[i]*rtemp6[i]*rtemp6[i]*x[i]*((t8*t8)*(t8*t8)*t9*(615.7216618445583*t13 + -3694.32997106735*t12)/(t3*t3*t3) + t17*(t8*t8)*(t8*t8)*t9*(1042.9786195192705*1.0 + -1847.164985533675*t20 + 461.79124638341875*t19 + 461.79124638341875*t18)/((t3*t3)*(t3*t3)))/kT) + R*R*(epsilon_dispersion*(-12.56637061435917*t10*t13*t14*t7*rtemp6[i]*rtemp6[i]*rtemp6[i]*x[i]/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp4[i]) + lambda_dispersion*t13*t14*t15*t7*rtemp6[i]*rtemp6[i]*x[i]/(t1*t16*t16*t2*(t3*t3)*(t3*t3)*rtemp4[i]))/kappa_association + R*epsilon_dispersion*epsilon_dispersion*t10*t7*(t8*t8)*(t8*t8)*t9*(rtemp6[i]*rtemp6[i])*(rtemp6[i]*rtemp6[i])*x[i]*(3868.693299013926*t13 + -15474.773196055705*t12)/(kT*(t3*t3)*(t3*t3))))))))))))))) + epsilon_dispersion*kappa_association*lambda_dispersion*t1*t2*rtemp4[i]*x[i]*(6.332573977646111e-3*t4*t6 + 0.3183098861837907*t4*t49)/(R*R*t3*t3*t3*rtemp6[i]);
	}

	VectorXcd ktemp70(gd.NxNyNzOver2);
	ktemp70 = fft(gd, rtemp69);

	rtemp69.resize(0); // Realspace
	VectorXd rtemp71(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT;
		const double t5 = rtemp32[i]/(t4*rtemp4[i]);
		const double t6 = 100.53096491487338*1.0 + 50.26548245743669*t3;
		rtemp71[i] = R*(kT*x[i]*(t5*t6 + -1.0*t6)/rtemp4[i] + R*R*kT*x[i]*(631.6546816697189*1.0 + -631.6546816697189*t5)/(kappa_association*t1*t2*t4*rtemp4[i]*rtemp4[i])) + kT*kappa_association*t1*t2*x[i]*(-8.0*t3*rtemp32[i]/rtemp4[i] + 8.0*t3*t4)/R;
	}

	VectorXcd ktemp72(gd.NxNyNzOver2);
	ktemp72 = fft(gd, rtemp71);

	rtemp71.resize(0); // Realspace
	VectorXd rtemp73(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp4[i]/(R*R*t1*t3) + 1.0));
		rtemp73[i] = 100.53096491487338*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(7937.606830156753*R*R*t1*t2*t3/(kappa_association*rtemp4[i]) + -1263.3093633394378*1.0 + -631.6546816697189*t4)/rtemp4[i];
	}

	VectorXcd ktemp74(gd.NxNyNzOver2);
	ktemp74 = fft(gd, rtemp73);

	rtemp73.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp74[0] = R*ktemp74[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp74[i] = ktemp74[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp76(gd.NxNyNz);
	rtemp76 = ifft(gd, ktemp74);

	ktemp74.resize(0); // KSpace
	VectorXd rtemp77(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp77[i] = R*kT*t4*x[i]*(-210.551560556573*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 33.51032163829113*1.0 + 16.755160819145566*t3)/rtemp4[i] + -2.666666666666667*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp78(gd.NxNyNzOver2);
	ktemp78 = fft(gd, rtemp77);

	rtemp77.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp78[0] = -2.0*R*ktemp78[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp78[i] = ktemp78[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp80(gd.NxNyNz);
	rtemp80 = ifft(gd, ktemp78);

	ktemp78.resize(0); // KSpace
	VectorXd rtemp81(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp81[i] = R*kT*t4*x[i]*(631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -100.53096491487338*1.0 + -50.26548245743669*t3)/rtemp4[i] + 8.0*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp82(gd.NxNyNzOver2);
	ktemp82 = fft(gd, rtemp81);

	rtemp81.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp82[0] = R*ktemp82[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp82[i] = ktemp82[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp84(gd.NxNyNz);
	rtemp84 = ifft(gd, ktemp82);

	ktemp82.resize(0); // KSpace
	VectorXd rtemp85(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp4[i]/(R*R*t1*t3) + 1.0));
		rtemp85[i] = 50.26548245743669*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(3968.8034150783765*R*R*t1*t2*t3/(kappa_association*rtemp4[i]) + -631.6546816697189*1.0 + -315.82734083485946*t4)/rtemp4[i];
	}

	VectorXcd ktemp86(gd.NxNyNzOver2);
	ktemp86 = fft(gd, rtemp85);

	rtemp85.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp86[0] = R*ktemp86[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp86[i] = ktemp86[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp88(gd.NxNyNz);
	rtemp88 = ifft(gd, ktemp86);

	ktemp86.resize(0); // KSpace
	VectorXd rtemp89(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0/(-1.0*1.0 + exp(epsilon_association/kT));
		const double t2 = sqrt(0.15915494309189535*kappa_association*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R*t1) + 1.0) + -1.0;
		const double t3 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t4 = 1.0/(sqrt(0.15915494309189535*kappa_association*rtemp4[i]/(R*R*t1*t3) + 1.0));
		rtemp89[i] = 2.6666666666666665*kT*kappa_association*t4*x[i]/(t1*t2) + R*R*kT*t3*x[i]*(210.55156055657295*R*R*t1*t2*t3/(kappa_association*rtemp4[i]) + -33.510321638291124*1.0 + -16.755160819145562*t4)/rtemp4[i];
	}

	VectorXcd ktemp90(gd.NxNyNzOver2);
	ktemp90 = fft(gd, rtemp89);

	rtemp89.resize(0); // Realspace
	VectorXcd ktemp91(gd.NxNyNzOver2);
	ktemp91[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp91[i] = ktemp90[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp92(gd.NxNyNz);
	rtemp92 = ifft(gd, ktemp91);

	ktemp91.resize(0); // KSpace
	VectorXcd ktemp93(gd.NxNyNzOver2);
	ktemp93[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp93[i] = ktemp90[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp94(gd.NxNyNz);
	rtemp94 = ifft(gd, ktemp93);

	ktemp93.resize(0); // KSpace
	ktemp90[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp90[i] = ktemp90[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp96(gd.NxNyNz);
	rtemp96 = ifft(gd, ktemp90);

	ktemp90.resize(0); // KSpace
	VectorXd rtemp97(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp97[i] = kT*x[i]*(t4*(-631.6546816697189*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 100.53096491487338*1.0 + 50.26548245743669*t3)/rtemp4[i] + -8.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp98(gd.NxNyNzOver2);
	ktemp98 = fft(gd, rtemp97);

	rtemp97.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp98[0] = R*(25.132741228718345*R*kT*ktemp0[i] + -2.0*ktemp98[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp98[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp98[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + 25.132741228718345*R*kT*t3*ktemp0[i]);
	}

	ktemp0.resize(0); // KSpace
	VectorXd rtemp100(gd.NxNyNz);
	rtemp100 = ifft(gd, ktemp98);

	ktemp98.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = log(1.0 + -1.0*rtemp8[i]);
		const double t2 = 1.0 + -1.0*rtemp8[i];
		const double t3 = t1*t2*t2 + rtemp8[i];
		const double t4 = rtemp12[i]*rtemp12[i];
		const double t5 = rtemp16[i]*rtemp16[i];
		const double t6 = rtemp20[i]*rtemp20[i];
		const double t7 = rtemp2[i]*rtemp2[i];
		const double t8 = -8.841941282883075e-3*t3*(2.0*1.0 + -4.0*rtemp8[i])/(t2*rtemp8[i]) + -1.768388256576615e-2*t1*t2 + 8.841941282883075e-3*rtemp8[i];
		rtemp100[i] = rtemp12[i]*((t8*rtemp12[i]*rtemp76[i] + t3*rtemp80[i])/(t2*t2*rtemp8[i]*rtemp8[i]) + rtemp84[i]/(t2*t2)) + rtemp100[i]/t2 + (t8*rtemp88[i]*(-3.0*t7 + -3.0*t6 + -3.0*t5 + t4) + t3*(rtemp2[i]*rtemp96[i] + rtemp20[i]*rtemp94[i] + rtemp16[i]*rtemp92[i]))/(t2*t2*rtemp8[i]*rtemp8[i]) + R*kT*t3*(-0.33333333333333337*t7 + -0.33333333333333337*t6 + -0.33333333333333337*t5 + 0.33333333333333337*t4)/(t2*t2*rtemp8[i]*rtemp8[i]) + -1.0*kT*t1/R;
	}

	rtemp96.resize(0); // Realspace
	rtemp94.resize(0); // Realspace
	rtemp92.resize(0); // Realspace
	rtemp88.resize(0); // Realspace
	rtemp84.resize(0); // Realspace
	rtemp80.resize(0); // Realspace
	rtemp76.resize(0); // Realspace
	VectorXcd ktemp102(gd.NxNyNzOver2);
	ktemp102 = fft(gd, rtemp100);

	rtemp100.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp52[0] = R*ktemp52[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp52[i] = ktemp52[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp104(gd.NxNyNz);
	rtemp104 = ifft(gd, ktemp52);

	ktemp52.resize(0); // KSpace
	VectorXd rtemp105(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp105[i] = R*kT*t4*x[i]*(-421.1031211131459*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 67.02064327658225*1.0 + 33.510321638291124*t3)/rtemp4[i] + -5.333333333333333*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp106(gd.NxNyNzOver2);
	ktemp106 = fft(gd, rtemp105);

	rtemp105.resize(0); // Realspace
	VectorXcd ktemp107(gd.NxNyNzOver2);
	ktemp107[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp107[i] = ktemp106[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp108(gd.NxNyNz);
	rtemp108 = ifft(gd, ktemp107);

	ktemp107.resize(0); // KSpace
	VectorXd rtemp109(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp109[i] = R*kT*t4*x[i]*(210.55156055657295*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -33.510321638291124*1.0 + -16.755160819145562*t3)/rtemp4[i] + 2.6666666666666665*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp110(gd.NxNyNzOver2);
	ktemp110 = fft(gd, rtemp109);

	rtemp109.resize(0); // Realspace
	VectorXcd ktemp111(gd.NxNyNzOver2);
	ktemp111[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp111[i] = ktemp110[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp112(gd.NxNyNz);
	rtemp112 = ifft(gd, ktemp111);

	ktemp111.resize(0); // KSpace
	VectorXcd ktemp113(gd.NxNyNzOver2);
	ktemp113[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp113[i] = ktemp106[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp114(gd.NxNyNz);
	rtemp114 = ifft(gd, ktemp113);

	ktemp113.resize(0); // KSpace
	VectorXcd ktemp115(gd.NxNyNzOver2);
	ktemp115[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp115[i] = ktemp110[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp116(gd.NxNyNz);
	rtemp116 = ifft(gd, ktemp115);

	ktemp115.resize(0); // KSpace
	ktemp106[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp106[i] = ktemp106[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp118(gd.NxNyNz);
	rtemp118 = ifft(gd, ktemp106);

	ktemp106.resize(0); // KSpace
	ktemp110[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp110[i] = ktemp110[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp120(gd.NxNyNz);
	rtemp120 = ifft(gd, ktemp110);

	ktemp110.resize(0); // KSpace
	VectorXd rtemp121(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp121[i] = R*kT*t4*x[i]*(-35.09192675942883*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 5.585053606381855*1.0 + 2.7925268031909276*t3)/rtemp4[i] + -0.44444444444444453*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp122(gd.NxNyNzOver2);
	ktemp122 = fft(gd, rtemp121);

	rtemp121.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp122[0] = R*ktemp122[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp122[i] = ktemp122[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp124(gd.NxNyNz);
	rtemp124 = ifft(gd, ktemp122);

	ktemp122.resize(0); // KSpace
	VectorXd rtemp125(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp125[i] = R*kT*t4*x[i]*(35.09192675942883*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -5.585053606381855*1.0 + -2.7925268031909276*t3)/rtemp4[i] + 0.44444444444444453*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp126(gd.NxNyNzOver2);
	ktemp126 = fft(gd, rtemp125);

	rtemp125.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp126[0] = R*ktemp126[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp126[i] = ktemp126[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp128(gd.NxNyNz);
	rtemp128 = ifft(gd, ktemp126);

	ktemp126.resize(0); // KSpace
	VectorXd rtemp129(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp129[i] = R*kT*t4*x[i]*(70.18385351885766*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -11.17010721276371*1.0 + -5.585053606381855*t3)/rtemp4[i] + 0.8888888888888891*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp130(gd.NxNyNzOver2);
	ktemp130 = fft(gd, rtemp129);

	rtemp129.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp130[0] = R*ktemp130[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp130[i] = ktemp130[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp132(gd.NxNyNz);
	rtemp132 = ifft(gd, ktemp130);

	ktemp130.resize(0); // KSpace
	VectorXd rtemp133(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp133[i] = R*kT*t4*x[i]*(-7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 1263.3093633394378*1.0 + 631.6546816697189*t3)/rtemp4[i] + -100.53096491487338*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp134(gd.NxNyNzOver2);
	ktemp134 = fft(gd, rtemp133);

	rtemp133.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp134[0] = R*ktemp134[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp134[i] = ktemp134[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp136(gd.NxNyNz);
	rtemp136 = ifft(gd, ktemp134);

	ktemp134.resize(0); // KSpace
	VectorXd rtemp137(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp137[i] = R*kT*t4*x[i]*(140.36770703771532*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -22.34021442552742*1.0 + -11.17010721276371*t3)/rtemp4[i] + 1.7777777777777781*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp138(gd.NxNyNzOver2);
	ktemp138 = fft(gd, rtemp137);

	rtemp137.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp138[0] = R*ktemp138[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp138[i] = ktemp138[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp140(gd.NxNyNz);
	rtemp140 = ifft(gd, ktemp138);

	ktemp138.resize(0); // KSpace
	VectorXd rtemp141(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp141[i] = R*kT*t4*x[i]*(-210.55156055657295*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 33.510321638291124*1.0 + 16.755160819145562*t3)/rtemp4[i] + -2.6666666666666665*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp142(gd.NxNyNzOver2);
	ktemp142 = fft(gd, rtemp141);

	rtemp141.resize(0); // Realspace
	VectorXcd ktemp143(gd.NxNyNzOver2);
	ktemp143[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp143[i] = ktemp142[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp144(gd.NxNyNz);
	rtemp144 = ifft(gd, ktemp143);

	ktemp143.resize(0); // KSpace
	VectorXcd ktemp145(gd.NxNyNzOver2);
	ktemp145[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp145[i] = ktemp142[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp146(gd.NxNyNz);
	rtemp146 = ifft(gd, ktemp145);

	ktemp145.resize(0); // KSpace
	ktemp142[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp142[i] = ktemp142[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp148(gd.NxNyNz);
	rtemp148 = ifft(gd, ktemp142);

	ktemp142.resize(0); // KSpace
	VectorXd rtemp149(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp149[i] = R*kT*t4*x[i]*(7937.606830156753*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -1263.3093633394378*1.0 + -631.6546816697189*t3)/rtemp4[i] + 100.53096491487338*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp150(gd.NxNyNzOver2);
	ktemp150 = fft(gd, rtemp149);

	rtemp149.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp150[0] = R*ktemp150[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp150[i] = ktemp150[i]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp152(gd.NxNyNz);
	rtemp152 = ifft(gd, ktemp150);

	ktemp150.resize(0); // KSpace
	VectorXd rtemp153(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp153[i] = -315.82734083485946*R*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp4[i]*rtemp4[i]) + kT*x[i]*(t4*(50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp4[i] + -4.0*kappa_association*t1*t2*t3/(R*R))/R;
	}

	VectorXcd ktemp154(gd.NxNyNzOver2);
	ktemp154 = fft(gd, rtemp153);

	rtemp153.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp154[0] = -1.0*R*ktemp154[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp154[i] = -1.0*R*ktemp154[i]*cos(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1);
	}

	VectorXd rtemp156(gd.NxNyNz);
	rtemp156 = ifft(gd, ktemp154);

	ktemp154.resize(0); // KSpace
	VectorXd rtemp157(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp157[i] = kT*x[i]*(t4*(315.82734083485946*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -50.26548245743669*1.0 + -25.132741228718345*t3)/rtemp4[i] + 4.0*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp158(gd.NxNyNzOver2);
	ktemp158 = fft(gd, rtemp157);

	rtemp157.resize(0); // Realspace
	VectorXd rtemp159(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp159[i] = 315.82734083485946*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp4[i]*rtemp4[i]) + kT*x[i]*(t4*(-50.26548245743669*1.0 + -25.132741228718345*t3)/rtemp4[i] + 4.0*kappa_association*t1*t2*t3/(R*R))/(R*R);
	}

	VectorXcd ktemp160(gd.NxNyNzOver2);
	ktemp160 = fft(gd, rtemp159);

	rtemp159.resize(0); // Realspace
	VectorXcd ktemp161(gd.NxNyNzOver2);
	ktemp161[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp161[i] = complex(0,1)*k_i[1]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp158[i] + ktemp160[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp162(gd.NxNyNz);
	rtemp162 = ifft(gd, ktemp161);

	ktemp161.resize(0); // KSpace
	VectorXd rtemp163(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp163[i] = R*kT*t4*x[i]*(-3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 631.6546816697189*1.0 + 315.82734083485946*t3)/rtemp4[i] + -50.26548245743669*kT*kappa_association*t1*t2*t3*x[i]/R;
	}

	VectorXcd ktemp164(gd.NxNyNzOver2);
	ktemp164 = fft(gd, rtemp163);

	rtemp163.resize(0); // Realspace
	VectorXcd ktemp165(gd.NxNyNzOver2);
	ktemp165[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp165[i] = ktemp164[i]*complex(0,1)*k_i[1]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp166(gd.NxNyNz);
	rtemp166 = ifft(gd, ktemp165);

	ktemp165.resize(0); // KSpace
	VectorXcd ktemp167(gd.NxNyNzOver2);
	ktemp167[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp167[i] = complex(0,1)*k_i[2]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp158[i] + ktemp160[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	VectorXd rtemp168(gd.NxNyNz);
	rtemp168 = ifft(gd, ktemp167);

	ktemp167.resize(0); // KSpace
	VectorXcd ktemp169(gd.NxNyNzOver2);
	ktemp169[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp169[i] = ktemp164[i]*complex(0,1)*k_i[2]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp170(gd.NxNyNz);
	rtemp170 = ifft(gd, ktemp169);

	ktemp169.resize(0); // KSpace
	ktemp160[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		const complex t3 = sin(t2)/(sqrt(t1));
		ktemp160[i] = complex(0,1)*k_i[0]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(t3*ktemp158[i] + ktemp160[i]*(R*cos(t2) + -1.0*t3)/t1);
	}

	ktemp158.resize(0); // KSpace
	VectorXd rtemp172(gd.NxNyNz);
	rtemp172 = ifft(gd, ktemp160);

	ktemp160.resize(0); // KSpace
	ktemp164[0] = 0;
	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = sqrt(k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0]);
		ktemp164[i] = ktemp164[i]*complex(0,1)*k_i[0]*sin(R*t1)*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1*t1)/t1;
	}

	VectorXd rtemp174(gd.NxNyNz);
	rtemp174 = ifft(gd, ktemp164);

	ktemp164.resize(0); // KSpace
	VectorXd rtemp175(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp175[i] = kT*x[i]*(t4*(-35.09192675942883*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 5.585053606381855*1.0 + 2.7925268031909276*t3)/rtemp4[i] + -0.44444444444444453*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp176(gd.NxNyNzOver2);
	ktemp176 = fft(gd, rtemp175);

	rtemp175.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp176[0] = -2.0*R*ktemp176[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp176[i] = ktemp176[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp178(gd.NxNyNz);
	rtemp178 = ifft(gd, ktemp176);

	ktemp176.resize(0); // KSpace
	VectorXd rtemp179(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp179[i] = kT*x[i]*(t4*(70.18385351885766*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -11.17010721276371*1.0 + -5.585053606381855*t3)/rtemp4[i] + 0.8888888888888891*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp180(gd.NxNyNzOver2);
	ktemp180 = fft(gd, rtemp179);

	rtemp179.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp180[0] = -2.0*R*ktemp180[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp180[i] = ktemp180[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp182(gd.NxNyNz);
	rtemp182 = ifft(gd, ktemp180);

	ktemp180.resize(0); // KSpace
	VectorXd rtemp183(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp183[i] = -315.82734083485946*kT*t4*t4*x[i]/(kappa_association*t1*t2*rtemp4[i]*rtemp4[i]) + kT*x[i]*(t4*(50.26548245743669*1.0 + 25.132741228718345*t3)/rtemp4[i] + -4.0*kappa_association*t1*t2*t3/(R*R))/(R*R);
	}

	VectorXcd ktemp184(gd.NxNyNzOver2);
	ktemp184 = fft(gd, rtemp183);

	rtemp183.resize(0); // Realspace
	VectorXd rtemp185(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		const double t5 = kT*x[i];
		rtemp185[i] = -631.6546816697189*t4*t4*t5/(kappa_association*t1*t2*rtemp4[i]*rtemp4[i]) + (t5*(t4*(100.53096491487338*1.0 + 50.26548245743669*t3)/rtemp4[i] + -8.0*kappa_association*t1*t2*t3/(R*R))/R + 12.566370614359172*t5)/R;
	}

	VectorXcd ktemp186(gd.NxNyNzOver2);
	ktemp186 = fft(gd, rtemp185);

	rtemp185.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp186[0] = R*(ktemp186[i] + -2.0*ktemp184[i]);
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = sin(R*sqrt(t1));
		const complex t3 = t2/(sqrt(t1));
		ktemp186[i] = exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(ktemp184[i]*(-1.0*R*cos(R*sqrt(t1)) + -1.0*t3) + t3*ktemp186[i]);
	}

	ktemp184.resize(0); // KSpace
	VectorXd rtemp188(gd.NxNyNz);
	rtemp188 = ifft(gd, ktemp186);

	ktemp186.resize(0); // KSpace
	VectorXd rtemp189(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp189[i] = kT*x[i]*(t4*(35.09192675942883*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + -5.585053606381855*1.0 + -2.7925268031909276*t3)/rtemp4[i] + 0.44444444444444453*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp190(gd.NxNyNzOver2);
	ktemp190 = fft(gd, rtemp189);

	rtemp189.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp190[0] = -2.0*R*ktemp190[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp190[i] = ktemp190[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp192(gd.NxNyNz);
	rtemp192 = ifft(gd, ktemp190);

	ktemp190.resize(0); // KSpace
	VectorXd rtemp193(gd.NxNyNz);
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = -1.0*1.0 + exp(epsilon_association/kT);
		const double t2 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0) + -1.0);
		const double t3 = 1.0/(sqrt(0.15915494309189535*kappa_association*t1*rtemp4[i]*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT)/(R*R) + 1.0));
		const double t4 = 1.0/(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*((4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0)/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -4.1887902047863905*R*R*R*(4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0)*(3.0*(-2.0943951023931953*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0) + -2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*R*R*R*rtemp6[i]*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/((-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)*(-4.1887902047863905*R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855) + 1.0)))/kT);
		rtemp193[i] = kT*x[i]*(t4*(-3968.8034150783765*R*R*t4/(kappa_association*t1*t2*rtemp4[i]) + 631.6546816697189*1.0 + 315.82734083485946*t3)/rtemp4[i] + -50.26548245743669*kappa_association*t1*t2*t3/(R*R));
	}

	VectorXcd ktemp194(gd.NxNyNzOver2);
	ktemp194 = fft(gd, rtemp193);

	rtemp193.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp194[0] = -2.0*R*ktemp194[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = k_i[2]*k_i[2] + k_i[1]*k_i[1] + k_i[0]*k_i[0];
		const complex t2 = R*sqrt(t1);
		ktemp194[i] = ktemp194[i]*exp(-6.0*pow(gd.dvolume, 0.6666666666666666)*t1)*(-1.0*sin(t2)/(sqrt(t1)) + -1.0*R*cos(t2));
	}

	VectorXd rtemp196(gd.NxNyNz);
	rtemp196 = ifft(gd, ktemp194);

	ktemp194.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = 1.0 + -1.0*rtemp8[i];
		const double t2 = -7.957747154594767e-2*rtemp2[i]*rtemp2[i] + -7.957747154594767e-2*rtemp20[i]*rtemp20[i] + -7.957747154594767e-2*rtemp16[i]*rtemp16[i] + 7.957747154594767e-2*rtemp12[i]*rtemp12[i];
		const double t3 = rtemp12[i]/R;
		const double t4 = t2/t1;
		const double t5 = rtemp12[i]*rtemp12[i];
		const double t6 = rtemp16[i]*rtemp16[i];
		const double t7 = rtemp20[i]*rtemp20[i];
		const double t8 = rtemp2[i]*rtemp2[i];
		const double t9 = -3.0*t8 + -3.0*t7 + -3.0*t6 + t5;
		const double t10 = t1*t1*log(t1) + rtemp8[i];
		const double t11 = 1.0/t1;
		const double t12 = 1.0/rtemp8[i];
		const double t13 = t9*log(t1);
		const double t14 = t10*t11*t12 + log(t1);
		const double t15 = t12*(2.0*1.0 + -4.0*rtemp8[i]);
		const double t16 = t10*t11 + 1.0;
		const double t17 = -5.305164769729845e-2*t10*t11*t12*t12*rtemp12[i] + -7.957747154594767e-2*1.0/R;
		const double t18 = 1.0/t11;
		const double t19 = -1.768388256576615e-2*t18*log(t1) + -8.841941282883075e-3*t10*t15/t18 + 8.841941282883075e-3*rtemp8[i];
		rtemp196[i] = rtemp12[i]*(rtemp156[i]/(t18*t18) + t12*t12*((rtemp148[i]*rtemp2[i] + rtemp146[i]*rtemp20[i] + rtemp144[i]*rtemp16[i] + t19*t9*rtemp152[i]/(t18*t18))/t18 + t12*t9*(t19*rtemp136[i] + t10*rtemp140[i]/t18)/(t18*t18))) + (rtemp196[i]*(0.33333333333333337*t10*t12*t12*t4 + 7.957747154594767e-2*t3)/t18 + 37.69911184307752*t12*t12*t2*rtemp192[i] + rtemp188[i])/t18 + rtemp2[i]*(t17*rtemp174[i] + rtemp172[i])/(t18*t18) + rtemp20[i]*(t17*rtemp170[i] + rtemp168[i])/(t18*t18) + rtemp16[i]*(t17*rtemp166[i] + rtemp162[i])/(t18*t18) + t12*t12*t12*t16*t9*rtemp124[i]*rtemp12[i]*(2.0*1.0 + -4.0*rtemp8[i])/(t18*t18*t18) + t12*t12*rtemp128[i]*rtemp12[i]*(t9*(1.0 + 2.0*t18)/(t18*t18) + t15*t9*(t10*t12/t18 + 1.0)/(t18*t18)) + t12*t12*t16*rtemp120[i]*rtemp12[i]*rtemp2[i]/(t18*t18) + t12*t12*t16*rtemp116[i]*rtemp12[i]*rtemp20[i]/(t18*t18) + t12*t12*t16*rtemp112[i]*rtemp12[i]*rtemp16[i]/(t18*t18) + 37.69911184307752*t12*t12*t16*t2*rtemp178[i]/(t18*t18) + 37.69911184307752*t12*t12*t14*t4*rtemp182[i] + t12*t12*t14*rtemp118[i]*rtemp12[i]*rtemp2[i]/t18 + t12*t12*t14*rtemp114[i]*rtemp12[i]*rtemp20[i]/t18 + t12*t12*t14*rtemp108[i]*rtemp12[i]*rtemp16[i]/t18 + t12*t12*t13*rtemp12[i]*rtemp132[i]*(1.0 + t15)/(t18*t18) + kT*t12*t12*rtemp12[i]*((t10*t9*(-0.22222222222222224*t12 + 0.22222222222222224*t11) + 0.11111111111111112*t9)/t18 + -0.11111111111111112*t9 + -0.22222222222222224*t13)/t18 + (rtemp104[i]*(2.0*t4 + 7.957747154594767e-2*t3)/(t18*t18) + 12.566370614359172*kT*t2/(t18*t18))/R;
	}

	rtemp192.resize(0); // Realspace
	rtemp188.resize(0); // Realspace
	rtemp182.resize(0); // Realspace
	rtemp178.resize(0); // Realspace
	rtemp174.resize(0); // Realspace
	rtemp172.resize(0); // Realspace
	rtemp170.resize(0); // Realspace
	rtemp168.resize(0); // Realspace
	rtemp166.resize(0); // Realspace
	rtemp162.resize(0); // Realspace
	rtemp156.resize(0); // Realspace
	rtemp152.resize(0); // Realspace
	rtemp148.resize(0); // Realspace
	rtemp146.resize(0); // Realspace
	rtemp144.resize(0); // Realspace
	rtemp140.resize(0); // Realspace
	rtemp136.resize(0); // Realspace
	rtemp132.resize(0); // Realspace
	rtemp128.resize(0); // Realspace
	rtemp124.resize(0); // Realspace
	rtemp120.resize(0); // Realspace
	rtemp118.resize(0); // Realspace
	rtemp116.resize(0); // Realspace
	rtemp114.resize(0); // Realspace
	rtemp112.resize(0); // Realspace
	rtemp108.resize(0); // Realspace
	rtemp104.resize(0); // Realspace
	rtemp20.resize(0); // Realspace
	rtemp16.resize(0); // Realspace
	rtemp12.resize(0); // Realspace
	rtemp8.resize(0); // Realspace
	rtemp2.resize(0); // Realspace
	VectorXcd ktemp198(gd.NxNyNzOver2);
	ktemp198 = fft(gd, rtemp196);

	rtemp196.resize(0); // Realspace
		{
		const int i = 0;
		const Reciprocal k_i = Reciprocal(0,0,0);
		ktemp198[0] = R*(0.33333333333333337*R*R*ktemp198[i] + 2.0*ktemp72[i] + ktemp102[i]) + ktemp70[i];
	}

	for (int i=1; i<gd.NxNyNzOver2; i++) {
		const int z = i % gd.NzOver2;
		const int n = (i-z)/gd.NzOver2;
		const int y = n % gd.Ny;
		const int xa = (n-y)/gd.Ny;
		const RelativeReciprocal rvec((xa>gd.Nx/2) ? xa - gd.Nx : xa, (y>gd.Ny/2) ? y - gd.Ny : y, z);
		const Reciprocal k_i = gd.Lat.toReciprocal(rvec);
		const complex t1 = 0.5*k_i[2]*k_i[2] + 0.5*k_i[1]*k_i[1] + 0.5*k_i[0]*k_i[0];
		const complex t2 = exp(-12.0*pow(gd.dvolume, 0.6666666666666666)*t1);
		const complex t3 = R*cos(1.4142135623730951*R*sqrt(t1));
		const complex t4 = sin(1.4142135623730951*R*sqrt(t1))/(sqrt(t1));
		const complex t5 = 1.4142135623730951*R*sqrt(t1);
		ktemp198[i] = ktemp70[i]*exp(-4.0*R*R*lambda_dispersion*lambda_dispersion*length_scaling*length_scaling*t1) + t2*(0.7071067811865476*t4*ktemp102[i] + 0.7071067811865476*ktemp72[i]*sin(2.0*t5)/(sqrt(t1)) + 0.3535533905932738*ktemp198[i]*(-1.4142135623730951*sqrt(t1)*t3 + sin(t5))/(sqrt(t1)*t1)) + 0.5*t2*complex(0,1)*(-0.7071067811865476*t4 + t3)*(ktemp68[i]*k_i[2] + ktemp62[i]*k_i[1] + ktemp56[i]*k_i[0])/t1;
	}

	ktemp102.resize(0); // KSpace
	ktemp72.resize(0); // KSpace
	ktemp70.resize(0); // KSpace
	ktemp68.resize(0); // KSpace
	ktemp62.resize(0); // KSpace
	ktemp56.resize(0); // KSpace
	VectorXd rtemp200(gd.NxNyNz);
	rtemp200 = ifft(gd, ktemp198);

	ktemp198.resize(0); // KSpace
	for (int i=0; i<gd.NxNyNz; i++) {
		const double t1 = R*R*R*rtemp6[i]*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(4.1887902047863905*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 17.54596337971441*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -2.803431620357388) + 2.25855);
		const double t2 = 1.0 + -4.1887902047863905*t1;
		const double t3 = -4.1887902047863905*R*R*R*rtemp6[i]*(3.0*(1.0 + -2.0943951023931953*t1)*(lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + 2.25855)/t2 + -0.5*lambda_dispersion*(-1.50349*1.0 + 0.249434*lambda_dispersion) + -0.5*R*R*R*rtemp6[i]*(8.377580409572781*lambda_dispersion*(1.40049*1.0 + -0.827739*lambda_dispersion) + 52.63789013914324*R*R*R*rtemp6[i]*(lambda_dispersion*(-15.0427*1.0 + 5.30827*lambda_dispersion) + 10.1576) + -5.606863240714776) + -1.129275) + -1.0*1.0 + 2.0943951023931953*t1;
		const double t4 = R*R*R*rtemp6[i];
		const double t5 = 4.1887902047863905*t4;
		const double t6 = 4.0*lambda_dispersion*lambda_dispersion*lambda_dispersion + -4.0;
		const double t7 = 12.566370614359172*R*R*(sqrt(0.15915494309189535*kappa_association*rtemp4[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*(t3*t6/(t2*t2*t2) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(1.0 + -2.0943951023931953*t1) + -4.1887902047863905*R*R*R*t6*(-2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(1.0 + -2.0943951023931953*t1)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t2 + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t2*t2*t2))/kT)/(R*R) + 1.0) + -1.0)/(kappa_association*rtemp4[i]*(-1.0*1.0 + exp(epsilon_association/kT))*(rtemp32[i]/rtemp4[i] + 0.25*epsilon_dispersion*(t3*t6/(t2*t2*t2) + -7.957747154594767e-2*lambda_dispersion*(-50.26548245743669*lambda_dispersion*lambda_dispersion*(1.0 + -2.0943951023931953*t1) + -4.1887902047863905*R*R*R*t6*(-2.0943951023931953*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + 3.0*(1.0 + -2.0943951023931953*t1)*(4.1887902047863905*rtemp6[i]*(-1.50349*1.0 + 0.498868*lambda_dispersion) + R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion))/t2 + -0.5*R*R*R*rtemp6[i]*rtemp6[i]*(73.49635953848843*t4*(-15.0427*1.0 + 10.61654*lambda_dispersion) + 24.572946253656237*1.0 + -29.046956363922856*lambda_dispersion)))/(t2*t2*t2))/kT));
		(*outgrad)[i] = ingrad[i]*(kT*(2.0*1.0 + log(2.646476976618268e-6*x[i]/(sqrt(kT)*kT)) + 4.0*log(t7) + -2.0*t7) + epsilon_dispersion*t4*t6*(2.0943951023931953*epsilon_dispersion*t3*((1.0 + -1.0*t5)*(1.0 + -1.0*t5))*((1.0 + -1.0*t5)*(1.0 + -1.0*t5))/(kT*(4.0*t5*t5 + 1.0 + 4.0*t5)) + -4.1887902047863905*1.0 + 8.772981689857206*t1)/(t2*t2*t2) + rtemp200[i] + mu) + (*outgrad)[i];
	}

	rtemp200.resize(0); // Realspace
	rtemp32.resize(0); // Realspace
	rtemp6.resize(0); // Realspace
	rtemp4.resize(0); // Realspace
	// 101 Fourier transform used.
	// 43

}

void print_summary(const char *prefix, double energy, std::string name) const {
	if (name != "") printf("%s%25s =", prefix, name.c_str());
	else printf("%s%25s =", prefix, "UNKNOWN");
	print_double("", energy);
	printf("\n%s%25s =", prefix, "FSAFT");
	print_double("", FSAFT);
	printf("\n%s%25s =", prefix, "Fassoc");
	print_double("", Fassoc);
	printf("\n%s%25s =", prefix, "Fdisp");
	print_double("", Fdisp);
	printf("\n%s%25s =", prefix, "Fideal");
	print_double("", Fideal);
	printf("\n%s%25s =", prefix, "a1integrated");
	print_double("", a1integrated);
	printf("\n%s%25s =", prefix, "a2integrated");
	print_double("", a2integrated);
	printf("\n%s%25s =", prefix, "dV");
	print_double("", dV);
	printf("\n%s%25s =", prefix, "dr");
	print_double("", dr);
	printf("\n%s%25s =", prefix, "kTphi1");
	print_double("", kTphi1);
	printf("\n%s%25s =", prefix, "kTphi2");
	print_double("", kTphi2);
	printf("\n%s%25s =", prefix, "kTphi3");
	print_double("", kTphi3);
	printf("\n%s%25s =", prefix, "volume");
	print_double("", volume);
	printf("\n%s%25s =", prefix, "whitebear");
	print_double("", whitebear);
	printf("\n");
}

private:
	double R;
	double epsilon_association;
	double kappa_association;
	double epsilon_dispersion;
	double lambda_dispersion;
	double length_scaling;
	double mu;
	mutable double FSAFT;
	mutable double Fassoc;
	mutable double Fdisp;
	mutable double Fideal;
	mutable double a1integrated;
	mutable double a2integrated;
	mutable double dV;
	mutable double dr;
	mutable double kTphi1;
	mutable double kTphi2;
	mutable double kTphi3;
	mutable double volume;
	mutable double whitebear;
	// TODO: add declaration of spherical fourier transform data here
	mutable double oldkT;}; // End of WaterSaft_by_hand_type class
	// Total 118 Fourier transform used.
	// peak memory used: 43



Functional WaterSaft_by_hand(double R, double epsilon_association, double kappa_association, double epsilon_dispersion, double lambda_dispersion, double length_scaling, double mu) {
	return Functional(new WaterSaft_by_hand_type(R, epsilon_association, kappa_association, epsilon_dispersion, lambda_dispersion, length_scaling, mu), "WaterSaft_by_hand");
}

