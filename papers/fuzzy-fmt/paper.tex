% TODO:

% Write ``Liquid-vapor interface'' section A.

% Look up question-mark references (citations).

\documentclass[letterpaper,twocolumn,amsmath,amssymb,prb]{revtex4-1}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{color}

\newcommand{\red}[1]{{\color{red} #1}}
\newcommand{\blue}[1]{{\bf \color{blue} #1}}
\newcommand{\green}[1]{{\bf \color{green} #1}}
\newcommand{\rr}{\textbf{r}}
\newcommand{\kk}{\textbf{k}}
\newcommand{\refnote}{\red{[ref]}}

\newcommand{\fixme}[1]{\red{[#1]}}

\begin{document}
\title{Smoothing the Fundamental Measure Theory Functional for Hard Spheres}

\author{Eric J. Krebs}
\affiliation{Department of Physics, Oregon State University, Corvallis, OR 97331}

\author{Patrick Kreitzberg}
\affiliation{Department of Physics, Oregon State University, Corvallis, OR 97331}

\author{David Roundy}
\affiliation{Department of Physics, Oregon State University, Corvallis, OR 97331}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
\fixme{ We will demonstrate a easy-to-implement variation on the Soft
  Fundamental Measure Theory (SFMT) approach for treating fluids
  having a soft repulsive potential.  We will show that over a wide
  range of temperatures and densities our theory gives accurate
  results, as tested by comparison with Monte Carlo simulation of a
  fluid using a typical soft repulsive potential.  We will present
  results for the homogeneous fluid, the radial distribution function,
  and for inhomogeneous distributions at a fluid-solid interface. }
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%a
\section{Introduction}

The hard-sphere fluid is \emph{the} reference fluid for models of real
liquids, such as water~\cite{gil-villegas-1997-SAFT-VR,
  clark2006developing, andersen1971relationship,
  andersen1972optimized, kalos1974helium, chapman1990new,
  barker1967perturbation}.  \fixme{See especially
  \cite{andersen1971relationship} for a discussion of the use of hard
  spheres to model realistic soft-sphere repulsive forces.  Note that
  \cite{andersen1971relationship} uses a density-dependent hard-sphere
  diameter, which is unsuitable for use in a density functional.} The
hard sphere fluid is widely studied and well understood
\fixme{citations}~\cite{mansoori1971equilibrium, roth2002whitebear,
  rosenfeld1989, rosenfeld1997}, but has the disadvantage of not being
physical since it contains step and delta functions which are hard to
use in computation. One way to deal with this difficulty is by
``smearing'' the functions so they are not discontinuous; another is
to use a theory where the spheres themselves are not so hard.

Fundamental Measure Theory~(FMT) is a classic density functional
theory (cDFT) for the free energy of the hard-sphere fluid developed
by Rosenfeld~\cite{rosenfeld1989}.  FMT is often used for the
hard-sphere portion of the total free energy which \fixme{citations}.
While this has been used to some success to study the behavior of real
liquids\fixme{citations}, it is not physical as the hard sphere cores
are never allowed to penetrate.

In his 2010 review of FMT, Roth states that the most important future
developments in equilibrium DFT will involve treating soft repulsions
and attractions~\cite{}.
 
\section{Soft Fundamental Measure Theory}

Schmidt introduced Soft Fundamental Measure Theory~(SFMT) based on
FMT~\cite{schmidt1999density} where spheres can penetrate at an
energy cost determined by a pair potential. SFMT was created to
generalize the weight functions of FMT while keeping the range of
the weight functions at the soft sphere radius. Schmidt gives three
criteria for the weight functions: they will deconvolve the Mayer
function, yield the exact zero-dimensional single cavity limit, and
they give a reasonable approximation fo the multi-cavity
limit~\cite{schmidt1999density}.

Schmidt tested SFTM for a mixture of soft and hard spheres as well as
for star polymers~\cite{schmidt2000density, groh2001density}. SFMT was
also tested in a number of other papers~\cite{rosenfeld2000fluid}
\fixme{more citations}.

\section{Barker-Henderson hard sphere}

Another approach to account for the temperature dependence of
realistic fluids is the from Barker-Herson's approach. Their theory is
a model for taking any general repulsive pair potential and creating a
hard sphere reference fluid with a temperature dependent diameter
along with higher order repulsive terms. Their had sphere diameter is
\begin{align}
  d = \int_0^\sigma\left( 1 - e^{\beta V(r)} \right)\mathrm{dr}
\end{align} 
where $\beta = \frac{1}{kT}$, V(r) is the pair potential, and $\sigma$
is the radius which V(r) goes to zero. We use this result in a White
Bear hard sphere DFT to compare against our approximation of SFMT. In
our case, $\sigma \to \infty$.


\section{Theory}

We use the White Bear version of the Fundamental-Measure Theory~(FMT)
functional published in reference~\cite{roth2002whitebear}.  The FMT
functional describes the excess free energy of a hard-sphere fluid.
This particular FMT reduces to the Carnahan-Starling equation of state
for homogeneous systems.
\begin{equation}
A_\textit{HS}[n] = k_B T \int \left(\Phi_1(\rr) + \Phi_2(\rr) + \Phi_3(\rr)\right) d\rr \; ,
\end{equation}
with integrands
\begin{align}
\Phi_1 &= -n_0 \ln\left( 1 - n_3\right)\\
\Phi_2 &= \frac{n_1 n_2 - \mathbf{n}_{V1} \cdot\mathbf{n}_{V2}}{1-n_3} \\
\Phi_3 &= (n_2^3 - 3 n_2 \mathbf{n}_{V2} \cdot \mathbf{n}_{V2}) \frac{
  n_3 + (1-n_3)^2 \ln(1-n_3)
}{
  36\pi n_3^2\left( 1 - n_3 \right)^2
} ,
\end{align}
using the weighted densities
\begin{align}
  n_3(\rr) &= \int n(\rr') \Theta(\left|\rr - \rr'\right| - R) d\rr' \\
  n_2(\rr) &= \int n(\rr') \delta(\left|\rr - \rr'\right| - R) d\rr'
\end{align}
\begin{align}
  \mathbf{n}_{V2} &= \mathbf{\nabla} n_3 , \quad
  \mathbf{n}_{V1} = \frac{\mathbf{n}_{V2}}{4\pi R} \\
  n_1 &= \frac{n_2}{4\pi R} , \quad
  n_0 = \frac{n_2}{4\pi R^2}
\end{align}

\section{Theory}

Soft Fundamental-Measure Theory~(SFMT) is a generalization of FMT to
soft potentials. In SFMT, the weight functions are modified but retain:
the direct correlation in the low-density limit, the exact free energy
in the zero-dimensional cavity limit, and relation to the generating
weight function $w_3(\rr)$~\cite{schmidt1999density} \fixme{this is an assumption
  as stated in Schmidt 1999}.  The new weight functions are also made
to deconvolve the Mayer function   

\begin{equation}
f(r) = \exp (-\beta V(r)) - 1
\end{equation}
and to give an approximate multi-cavity limit. Schmidt furthur shows that\cite{schmidt2000fluid}

\begin{equation}\label{eq:mayerandw2}
\frac{d f(r)}{dr} = \int dr' w_2(r') w_2 (r-r').
\end{equation}

\begin{figure}
\begin{center}
\includegraphics[width=\columnwidth]{figs/potential-plot}
\end{center}
\caption{plot of potential.}
\label{fig:potential-plot}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=\columnwidth]{figs/w2-comparison}
\end{center}
\caption{plot of potential.}
\label{fig:w2-comparison}
\end{figure}

We use a WCA (Weeks-Chandler-Anderson) pair
potential\cite{weeks1971}, which is the Lennard-Jones potential
with the attractive portion removed:
\begin{align}
  V_{wca}(r) =
  \begin{cases}
    4\epsilon \left[ \left(\frac{\sigma}{r}\right)^{12} -
    \left(\frac{\sigma}{r}\right)^{6} \right] + \epsilon, & 0 < r < 2R \\
    0, & \textrm{otherwise}.
  \end{cases}
\end{align}
We approximate the Mayer function as
\begin{align}
  f(r) \approx \tfrac12 \left( \mathrm{erf}\left( \frac{r - \alpha}{\Xi} \right) - 1 \right)
\end{align}
then
\begin{align}
  V_{erf}(r) \approx -kT\ln\left[\tfrac12 \left( \mathrm{erf}\left( \frac{r -
    \alpha}{\Xi} \right) + 1 \right) \right].
\end{align}
Expanding $V_{erf}(r)$ in a power series gives the approximation
\begin{align}
  V_{erf}(\alpha) &\approx k_BT \ln 2.
\end{align}
Setting $V_{wca}$ and and the approximate $V_{erf}$ equal at $r=\alpha$, we solve
for $\alpha$ and find that
\begin{align}
  \alpha = \sigma \left( \frac{2}{1 + \sqrt{\frac{k_BT}{\epsilon}
        \ln 2}} \right)^{\frac{1}{6}}.
\end{align}
Next, we set $V_{wca}$ and both potential's slopes equal at $r = \alpha$ and find that
\begin{align}
  \Xi = \frac{\alpha}{6\sqrt{\pi} \left( \sqrt{\frac{\epsilon}{k_BT} \ln
      2} + \ln 2 \right)}
\end{align}

The approximate weight functions from the erf model are
\begin{align}
  w_2(r) &= \frac{1}{\Xi \sqrt{\pi}} e^{-\frac{(r-\alpha/2)^2}{\Xi^2}} \\
  w_3(r) &= \tfrac12 ( 1 - \mathrm{erf}((r-\alpha/2)/\Xi) ).
\end{align}
with all other weight functions retaining their relation to $w_2(r)$
as in FMT.

\subsection{Weighting functions in fourier space}

We Fourier transform our weight functions because simulations are
carried out in Fourier space.  We find that
\begin{align}
  \tilde{w}_3(k) &= \frac{4\pi}{k} \int_0^\infty r w_3(r) \sin(kr) dr \\ 
  &= \frac{4\sqrt{\pi}}{k^3}\int_{-\sigma/2a}^\infty \left[
    \sin(k(au+\frac{\sigma}{2})) - k(au + \frac{\sigma}{2})
    \cos(k(au+\frac{\sigma}{2}))\right] e^{-u^2} du.
\end{align}
This is not an analytic function, but we assume that we are working at
low enough temperatures so that our function reduces to zero by $u=
-\frac{\sigma}{2a}$. We extend the lower limit to $-\infty$ then
\begin{align}
  \tilde{w}_3(k) &\approx
  \frac{4\pi}{k^3}e^{-\left(\frac{ak}{2}\right)^2}\left[ \left(1 +
    \frac{a^2k^2}{2} \right) \sin\left(\frac{k\sigma}{2}\right) -
    \frac{k}{2} \sigma\cos\left(\frac{k \sigma}{2}\right) \right]
\end{align}

We apply the same method to the other weight functions. These are
\begin{align}
  \tilde{w}_2(k) &=\frac{2\pi}{k} e^{-\left(\frac{ak}{2} \right)^2}
  \bigg(a^2 k \cos\left(\frac{k\sigma}{2}\right) \notag \\
  & \hspace{8em}+\sigma \sin\left(\frac{k\sigma}{2}\right) \bigg) \\ 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \tilde{w}_1(k) &=
  \frac{1}{k}e^{-\left(\frac{ak}{2} \right)^2}
  \sin\left(\frac{k\sigma}{2}\right) \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \tilde{\mathbf{w}}_{2V}(\kk) &=
  \frac{i \pi}{k} e^{-\left(\frac{ak}{2} \right)^2}\bigg[ \left(\sigma^2 - a^4k^2\right)
    \cos\left(\frac{k\sigma}{2}\right) \notag\\ 
    & \hspace{5em}- 2\sigma \left(a^2k + \frac{1}{k}
    \right)\sin\left(\frac{k\sigma}{2}\right) \bigg]
  \mathbf{\hat{k}} \\ 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \mathbf{\tilde{w}}_{1V}(k)&= \frac{i}{k}
   e^{-\left(\frac{ak}{2} \right)^2} \bigg[ \frac{\sigma}{2}
    \cos\left(\frac{k\sigma}{2}\right) \notag\\
    & \hspace{6em}- \left( \frac{a^2k}{2} +
    \frac{1}{k} \right) \sin\left(\frac{k\sigma}{2}\right) \bigg]
  \mathbf{\hat{k}}
\end{align}
$\tilde{w}_0(k)$ contains a $\frac{1}{r}$ term that expands the
integrand  as an infinite series. The first two terms were kept and
could be expressed in terms of $\tilde{w}_1(k)$ and
$\tilde{w}_2(k)$.
\begin{align}
  \tilde{w}_0(k) &= \frac{2}{\sigma} \left[2\tilde{w}_1(k) - \frac{1}{2 \pi
      \sigma}\tilde{w}_2(k) \right]
\end{align}
 
\section{Comparison with simulation}

\subsection{Homogeneous limit}

As a simple test for the equation of state, we compare the theory for
a homogeneous soft-sphere fluid and compare to Monte-Carlo (MC)
simulation. The results show very good agreement for lower densities
across all temperatures shown in Figure \ref{fig:p-vs-packing}, and at
higher temperatures not shown. Differences between the DFT and MC results
become quite apparent at $n^*=0.6$ and above which includes fluid to solid
transitions starting at $n^*=0.8$ that are not predicted by our DFT.

\begin{figure}
\begin{center}
\includegraphics[width=3.5in]{figs/p-vs-T}
\end{center}
\caption{Pressure versus packing fraction.  The SFMT result is plotted
  as solid lines, with simulation results as solid circles.  The
  pressure is divided by the hard-sphere pressure in each case, in
  order to highlight the effect of the soft interactions.}
\label{fig:p-vs-packing}
\end{figure}

\subsection{Soft spheres radial distribution function}

For three dimensional comparisons, we plot radial distribution
funtions.  Results for reduced densitied below $n^* = 0.60$ have been
ommitted as they were exact over temperature ranges from $T^*=0.01$ to
$T^*=10$. Figure \ref{fig:radial-distribution-60} shows the radial
distribution for a range of temperatures at a redued density of $n^* =
0.60$. We see very good agreement of our DFT with Monte-Carlo
simulation at this reduced density. Our DFT's behaviour at higher
temperatures are in almost exact agreement, while the lower
temperatures have slight disagreement just after the first peak at
contact and in the subsequent oscillations where it
\fixme{underestimate} the peaks. Comparison with the Barker-Henderson
results shows our DFT to have a similar magnitude of error to the
exact radial distribution function.

\begin{figure}
\begin{center}
\includegraphics[width=3.5in]{figs/radial-distribution-60}
\end{center}
\caption{Radial distribution function with 0.6 reduced density.}
\label{fig:radial-distribution-60}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=3.5in]{figs/radial-distribution-100}
\end{center}
\caption{Radial distribution function with 1.0 reduced density.}
\label{fig:radial-distribution-100}
\end{figure}

In Figure \ref{fig:radial-distribution-100}, we plot the results for a
reduced density of $n^*=1.0$ for three different tempreatures. Whole
both Barker-Henderson hard spheres and our DFT both overstimate the
density at contact, ours is marginally worse at the lowest temperature
shown here. For the density oscillations, our DFT's error is as good
as the Barker-Henerson results.

\subsection{Soft spheres near a hard wall}


\begin{figure}
\begin{center}
\includegraphics[width=3.5in]{figs/walls-60}
\end{center}
\caption{Density distribution near a hard wall.}
\label{fig:walls-50}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=3.5in]{figs/walls-100}
\end{center}
\caption{Density distribution near a hard wall.}
\label{fig:walls-100}
\end{figure}

\subsection{Soft spheres near a soft wall}

If we construct a wall of WCA spheres of density $rho$, we
find that the potential at a distance z from the wall is

\begin{align}
V_{SW}(0 < z \leq R_0) &= 2\pi\rho\epsilon\Big[ \frac{z^3-R_0^3}{6} +
  \frac{2\sigma_W^{12}}{45} \left(\frac{1}{z^9}-\frac{1}{R_0^9}\right)
  \notag \\
  &+ \left( R_0 - z \right)\left(\frac{R_0^2}{2} +
  \frac{\sigma_W^6}{R_0^4} - \frac{2\sigma_W^{12}}{5R_0^{10}}\right)
  \notag \\
  &\hspace{2cm}+\frac{\sigma_W^6}{3}\left(\frac{1}{R_0^3}-\frac{1}{z^3}
  \right) \Bigg].
\label{eq:soft-wall-potential}
\end{align}
The distance $R_0$ is equal to $R_W + R_f$, where $R_W$ is the radius of a
sphere which makes up the wall and $R_f$ is the radius of a sphere
from the fluid. Both $\epsilon$ and $\sigma_W$ are Lennard-Jones
parameters between the wall and the fluid.

In Figure \ref{fig:soft-walls-60}, we compare our soft sphere DFT
against MC simulation and a Barker-Henerson fluid near a soft wall
with the potential given in Equation \ref{eq:soft-wall-potential}. We
plot the reduced density versus reduced distance from the surface of
the wall for $n^*=0.6$ at different temperatures. Again, the results
of our soft sphere fluid is as good as the Barker-Henderson(BH) fluid
overall.

\begin{figure}
  \includegraphics[width=\columnwidth]{figs/soft-walls-60}
  \caption{Soft walls plot, generated with new code generator.}
\label{fig:soft-walls-60}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Comparison with experiment}

Lennard Jones data we will use will be from
papers~\cite{mikolaj2004structure, eggert2002quantitative, yarnell1973structure}.
For Lennard Jones Argon, $\sigma = 3.405 ~\textrm{\AA}$ and $\epsilon = 119.8$~K~\cite{verlet1967computer}.
\begin{figure*}
  \begin{center}
    \includegraphics[width=7.0in]{figs/argon-plots}
  \end{center}
  \caption{Radial distribution functions of Argon.}
  \label{fig:argon-plots}
\end{figure*}
  %% \begin{figure}
  %%   \begin{center}
  %%     \includegraphics[width=3.5in]{figs/Argon-1_1GPa-RT}
  %%   \end{center}
  %%   \caption{Radial distribution function of Argon at room temperature and
  %%     1.1 GPa~\cite{eggert2002quantitative}.  The reduced density is $n^*
  %%     = 1.095$ and the reduced temperature is $T^* = 2.48$.}
  %%   \label{fig:argon-1.1GPa}
  %% \end{figure}

  %% \begin{figure}
  %%   \begin{center}
  %%     \includegraphics[width=3.5in]{figs/Argon-9_919MPa-148K}
  %%   \end{center}
  %%   \caption{Radial distribution function of Argon 148 Kelvin and and
  %%     9.919 MPa.  The reduced density is $n^* = 0.5844$ and the reduced
  %%     temperature is $T^* = 1.235$.\fixme{Run MC and DFT simulations.}}
  %%   \label{fig:argon-1.1GPa}
  %% \end{figure}

\section{Conclusion}

\appendix

\section{Soft Fundamental-Measure Theory}

We follow the Soft Fundamental-Measure Theory introduced by
Schmidt~\cite{schmidt2000fluid}.  Here I will derive the fundamental
measures for a hard-sphere fluid, so we can see how this works.
Schmidt defines the relationship between the weighting functions as:
\begin{align}
  w_2(r) &= -\frac{\partial w_3(r)}{\partial r} \\
  \mathbf{w}_{v2}(\rr) &= w_2(r)\frac{\rr}{r} \\
  \mathbf{w}_{m2}(\rr) &= w_2(r)\left( \frac{\rr \rr}{r^2}
                              - \frac{\mathbf{\hat{1}}}{3} \right) \\
  w_1(r) &= \frac{w_2(r)}{4\pi r} \\
  \mathbf{w}_{v1}(\rr) &= w_1(r) \frac{\rr}{r} \\
  w_0(r) &= \frac{w_1(r)}{r}
\end{align}
The weighting functions are themselves given by a deconvolution of the
Mayer $f$ function:
\begin{align}
  f(r) &= \exp\left(-\frac{V(r)}{k_BT}\right) - 1 \\
  &= w_0 * w_3 + w_1 * w_2 - \mathbf{w}_{v1} * \mathbf{w}_{v2}
\end{align}
where the $*$ operator denotes a three-dimensional convolution, and a
scalar product between vectors.  Schmidt explains that there is a
simple relationship in fourier space between the Mayer $f$ function
and the weighting function $w_2$:
\begin{align}
  \tilde{w}_2(k) &= \pm \sqrt{ik\tilde{f}(k)}
  \label{eq:w2fromf}
\end{align}
where the tilde denotes a \emph{one-dimensional} Fourier transform:
\begin{align}
  \tilde{f}(k) &= \int_{-\infty}^\infty f(r) e^{ikr} dr
\end{align}

I am writing this section to explore this formula, and to help me to
understand how to deal with this branch cut (i.e. the sign in
Equation~\ref{eq:w2fromf}).  One interesting challenge here is that
$\tilde{w}_2(k)$ is \emph{not} actually the function that we will use
in our convolutions, which are three-dimensional convolutions.  So we
will still have to go into real space and back again to get our
convolution kernel.  $\ddot\frown$

\section{Hard spheres}

For the hard-sphere fluid,
\begin{align}
  f(r) = - \Theta(r - 2R)
\end{align}
which means that
\begin{align}
  \tilde{f}(k) &= \int_{-\infty}^\infty f(r) e^{ikr} dr \\
  &= -\int_{-2R}^{2R} e^{ikr} dr \\
  &= -\int_{-2R}^{2R} \cos(kr) dr \\
  &= -\frac{2}{k}\sin(2kR)
\end{align}
At this point, we want to solve for $w_2$.
\begin{align}
  \tilde{w}_2(k) &= \pm \sqrt{ik\tilde{f}(k)} \\
  &= \pm \sqrt{-2i\sin(2kR)} \\
  &= \pm \sqrt{-4i\sin(kR)\cos(kR)}
\end{align}
I happen to know that
\begin{align}
  w_2(r) &= \delta(r - R) \\
  \tilde{w}_2(k) &= \int_{-\infty}^\infty w_2(r) e^{ikr} dr \\
  &= \int_{-\infty}^\infty \delta(r-R) e^{ikr} dr \\
  &= e^{ikr} + e^{-ikr + i\Phi}
\end{align}
where in the last step, I use the fact that there is a physical
ambiguity as to whether $w_2$ is even or odd or somewhere in between
when understood in one dimension, since only even values for $r$ make
physical sense.  Thus looking at the square of this, we see
\begin{align}
  \tilde{w}_2(k)^2 &= e^{i2kr} + e^{-i2kr + 2\Phi} + 2e^{i\Phi} \\
  &= -2i\sin(2kR) \\
  &= -2i\frac{e^{i2kR} - e^{-i2kR}}{2i} \\
  &= e^{-i2kR} - e^{i2kR}
\end{align}
This almost makes sense (if $\Phi = \pi/2$), but not quite, because
there is the extra term of $2e^{i\Phi}$, which would give us an extra
$2i$.

This looks like a contradiction.  However, we assumed here that there
was a $\delta$-function at $-R$, and that $f(r)$ was a symmetric
function, simply because the three-dimensional function is symmetric.
What if there is only one spike at $R$ and $f(r)$ is asymmetric?  Then
we would have
\begin{align}
  \tilde{f}(k) &= \int_{-\infty}^\infty f(r) e^{ikr} dr \\
  &= -\int_{-\infty}^{2R} e^{ik2R} dr
\end{align}
This integral isn't very nicely behaved.  But if I were to ignore the
lower bound---which is actually okay for computing the slope, which is
all we need---then I would find that
\begin{align}
  \tilde{f}(k) &= -\frac{e^{ikr}}{ik} + C
\end{align}
When I solve for $\tilde{w}_2$ I get something similar:
\begin{align}
  w_2(r) &= \delta(r - R) \\
  \tilde{w}_2(k) &= \int_{-\infty}^\infty \delta(r-R) e^{ikr} dr \\
  &= e^{ikR}
\end{align}
And now it's obvious that the solution is correct, apart from an
unexplained minus sign in $\tilde{f}$, which I imagine I could find in
time.  So it looks like we want to assume that the slope of $f(r)$ is
zero for $r<0$, and therefore that $w_2(r<0)=0$.

\bibliography{paper}% Produces the bibliography via BibTeX.

\end{document}
