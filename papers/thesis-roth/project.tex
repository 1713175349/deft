\documentclass[letterpaper,twocolumn,amsmath,amssymb,prb]{revtex4-1}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{color}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Definitions

% 1/k_B/T
\newcommand{\kT}{\ensuremath{k_BT}}

% vector
\newcommand{\rr}{\ensuremath{\bf{r}}}

% special values for n
\newcommand{\npart}{\ensuremath{n_{particular}}}
\newcommand{\nliq}{\ensuremath{n_{liquid}}}
\newcommand{\nvap}{\ensuremath{n_{vapor}}}

% Free energy terms
\newcommand{\fid}{\ensuremath{f_\text{ID}(T,n)}}
\newcommand{\fhs}{\ensuremath{f_\text{HS}(T,n)}}
\newcommand{\fdisp}{\ensuremath{f_\text{disp}(T,n)}}
\newcommand{\fattr}{\ensuremath{f_\text{attr}(T,n)}}

% pair potential
\newcommand{\1}{\ensuremath{\textbf{r}_1}}
\newcommand{\2}{\ensuremath{\textbf{r}_2}}

% fixme
\newcommand{\fixme}[1]{\textcolor{red}{\textbf{[#1]}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\title{Applying Renormalization Group Theory to the Square Well Liquid}

\author{Dan Roth}
\affiliation{Department of Physics, Oregon State University, Corvallis, OR
97331}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

Near the critical point of a liquid, there are density \fixme{is saying $g(\rr)$ more accurate?} fluctuations at all length scales. In this regime, mean field theories break down, for obvious reasons. As one approaches the critical point, there becomes less and less of a difference in free energy of the liquid and vapor states; this causes difficulty in modeling liquid-vapor coexistence. This work develops a method for calculating liquid-vapor coexistence, and applies renormalization group theory to the square well liquid.

%\tableofcontents
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theory}\label{sec:theory}

This work applies entirely to the homogeneous case---that is, there are no walls containing our liquid, nor are there any sort of solutes in the liquid. Since our fluid is of infinite extent, the free energy is infinite. Therefore, I work with free energy density:
\begin{align}
  f(T,n) &\equiv \frac{F(T,n)}{V}
\end{align}

\subsection{Renormalization Group Theory}\label{subsec:RGT}
Renormalization group (RG) theory is an iterative procedure that was
developed to deal with large-scale fluctuations of the order parameter
near the critical point of a system. The formulation used here is provided by Forte~\textit{et al}.\cite{Forte11}

\fixme{Discuss Wilson phase cell}

We begin with a baseline free enrgy $f_0(T,n)$. We assume this baseline accounts for all fluctuations of wavelength $\lambda < \lambda_0$. We then double the size of our phase cell and add a correction to the free energy $\delta f_1(T,n)$. This correction accounts for fluctuations with a wavelength $\lambda = 2\lambda_0$. The new free energy is $f_1(T,n) = f_0(T,n) + \delta f_1(T,n)$. Then double the length scale again; $\delta f_2(T,n)$ accounts for fluctionations with $\lambda = 4\lambda_0$ and $f_2(T,n) = f_1(T,n) + \delta f_2(T,n)$. As we continue this process, the $i^{th}$ correction accounts for fluctuations with $\lambda = 2^i\lambda_0$, and $f_i(T,n) = f_{i-1}(T,n) + \delta f_i(T,n)$. In the end, your free energy is
\begin{align}
  f(T,n) = f_0(T,n) + \sum_{i=1}^\infty\delta f_i(T,n) + \fattr
\end{align}

Where $\fattr$ is the contribution due to the longest-wavelenght density fluctuations. At this stage, I do not entirely understand why Forte splits up $\fattr$.

%% \fixme{The following comes from Forte~\cite{Forte11} and doesn't make a whole lot of sense to me}

%% The free energy for each iteration is given by
%% \begin{equation}
%%   f_i(T,n) = f_{i-1}(T,n) + \delta f_i(T,n)\ .
%% \end{equation}
%% The total free is obtained when one takes the
%% iterations to infinity and adds in the attractive component:
%% \begin{equation}
%%   f(T,n) = \lim_{i \to \infty} f_i(T,n) + \fattr\ .
%% \end{equation}
%% The initial free energy density, $f_0$ depends on the liquid model of study. For this work, I use the square well model:
%% \begin{equation}
%%   f_0(T,n) = \fid + \fhs + \frac{a_2^{SW}(T,n)}{\kT}\ ,
%% \end{equation}
%% where $a_2^{SW}(T,n)$ is the second-order term in a high-temperature expansion around $1/\kT$. (See ref~\cite{Gil-Villegas97}.)
%% \fixme{End of Forte confusion}

\subsection{Square well liquid free enrgy}\label{subsec:SW}
For the baseline, this work is based on the square well liquid free energy:\cite{Hughes13}
\begin{align}
  f_0(T,n) &= \fid + \fhs + \left( \fdisp - n a_1(n) \right) \ .
\end{align}
The long-range attractive term, $\fattr$ is given by
\begin{align}
  \fattr &= n a_1(n) \ .
\end{align}
$\fid$ is the ideal gas free energy, $\fhs$ is the hard sphere repulsion, and $\fdisp$ is the attraction. The function $a_1(n)$ is the first term from a high-temperature perturbation expansion, described in further detail in sections~\ref{sub2sec:disp} and~\ref{subsec:TPT}. Each function is outlined below.

\subsubsection{Ideal gas}\label{sub2sec:ID}
The ideal gas term is purely local \fixme{whatever that means}:
\begin{align}
  \fid &= n\kT\left(\log(n) - 1\right)
\end{align}

\subsubsection{Hard sphere repulsion}\label{sub2sec:HS}
Hard sphere repulsive forces are dealt with by the White Bear version of Fundamental-Mearuse Theory.\cite{Roth02} The hard sphere excess free energy is given in the homogeneous case as
\begin{align}
  \fhs &= \kT\left( \Phi_1(n) + \Phi_2(n) + \Phi_3(n) \right)
\end{align}
The $\Phi_j(n)$ terms are given as
\begin{align}
  \Phi_1(n) &= -n_0\ln(1 - n_3) \\
  \Phi_2(n) &= \frac{n_1n_2}{1 - n_3} \\
  \Phi_3(n) &= n_2^3\left( \frac{n_3 + (1 - n_3)^2\ln(1 - n_3)}{36\pi n_3^2(1 - n_3)^2} \right)
\end{align}
The \emph{fundamental measure densities} are
\begin{align}
  n_0(n) &= \frac{n_2}{4\pi R^2} \nonumber \\
  &= n \\
  n_1(n) &= \frac{n_2}{4\pi R} \nonumber \\
  &= nR \\
  n_2(n) &= n4\pi R^2 \\
  n_3(n) &= n\frac{4}{3}\pi R^3 \nonumber \\
  &= \eta
\end{align}
where $\eta$ is the packing fraction.

\subsubsection{Attraction}\label{sub2sec:disp}
The attractive free energy includes van der Waals attraction between hard spheres and is founded in Thermodynamic Perturbation Theory (TPT).
\begin{align}
  \fdisp &= n \left( a_1(n) + \frac{1}{\kT}a_2(n) \right)
\end{align}
The $a_j(n)$ terms come from TPT, outlined in section~\ref{subsec:TPT}.

The first term, $a_1$, is the mean-field dispersion interaction. The second term, $a_2$, describes the effect of fluctuations resulting from compression of the fluid due to the dispersion interaction itself, and is approximated using the local compressibility approximation (LCA), which assumes the energy fluctuation is simply related to the compressibility of a hard-sphere reference fluid.\cite{Barker76}

In Gil-Villegas' paper, HS and Dispersion are wrapped up into the
\textit{monomer} contribution, expressed in terms of energy densities
as:
\begin{align}
  f_\text{mono} = f_\text{HS} - \frac{\alpha^\text{VDW}n}{kT}
\end{align}
with $\alpha^\text{VDW}$ given by
\begin{align}
  \alpha^\text{VDW} &= 2\pi\epsilon\int_\sigma^\infty r^2\phi(r)\,dr \\
  \intertext{using reduced units of $x = r/\sigma$, we have}
  &= 2\pi\sigma^3\int_1^\infty x^2\phi(x)\,dx \\
  &= 3b^\text{VDW}\epsilon\int_1^\infty x^2\phi(x)\,dx
\end{align}
where $b^\text{VDW}$ is the van der Waals size parameter. It corresponds to the volume excluded by two spherical particles of volume $b$: $b^\text{VDW} = 4b = 4\left(\pi\sigma^3/6\right)$.

Then, the high-temp expansion is an expansion of the monomer term:
\begin{align}
  f_\text{mono} &= f_\text{HS} + \beta a_1 + \beta^2 a_2 + \cdots
\end{align}

The term $a_1$ is given by
\begin{align}
  a_1 &= -2\pi n \epsilon\int_\sigma^\infty r^2\phi(r)g^\text{HS}(r)\,dr \\
  &= -3 n  b^\text{VDW}\epsilon\int_1^\infty x^2\phi(x)g^\text{HS}(x)\,dx
\end{align}
If we assume random correlations between the particles' positions, for all distances, we have $g^\text{HS}(r) = 1$. This yields
\begin{align}
  a_1^\text{VDW} = - n \alpha^\text{VDW},
\end{align}
the van der Waals mean-field energy.

The second-order term is quite a bit more complicated; one must have knowledge of higher-order correlation functions to determine $a_2$. This term describes the response of the attractive energy due to the compression of the fluid from the attractive well. Gil-Villegas \emph{et al.} base their expression on an approximation by Barker and Henderson.\cite{Barker67} Barker and Henderson's approximation considers fluctuations in the number of particles in the potential well. In this way, the fluctuations in $a_2$ are related to the pressure and compressibility of the liquid. Given pressure $P^\text{HS}$ and isothermal compressibility $K^\text{HS} = kT\left(\partial n  /\partial P^\text{HS}\right)_T$, we have:
\begin{align}
  a_2 &= -\pi n \epsilon^2kT\int_0^\infty r^2\left[\phi(r)\right]^2\frac{\partial n  g^\text{HS}(r)}{\partial P^\text{HS}}\,dr \\
  &= -\pi n \epsilon^2K^\text{HS}\frac{\partial}{\partial n }\left[\int_\sigma^\infty r^2\left[\phi(r)\right]^2 n  g^\text{HS}\,dr\right] \\
  &= \frac{1}{2}\epsilon K^\text{HS}\frac{\partial}{\partial n }\left[-3 n  b^\text{VDW}\epsilon\int_1^\infty x^2\left[\phi(x)\right]^2 g^\text{HS}(x)\,dx \right]
\end{align}

We use the isothermal compressibility in terms of packing fraction $\eta$, given by the Percus-Yevick exprssion:\cite{Barker76}
\begin{align}
  K^\text{HS} &= \frac{\left(1 - \eta\right)^4}{1 + 4\eta + 4\eta^2}
\end{align}

\subsection{Thermodynamic perturbation theory}\label{subsec:TPT}


\fixme{And introduction to TPT---why do we use it?}
This discussion follows primarily from \textit{Theory of Simple Liquids}, by Hansen and McDonald\cite{Hansen06}.

Thermodynamic perturbation theory treats the intermolecular potential as separable into two parts, one for short-range repulsion and another for long-range attraction.

The pair potential $v(\1,\2)$ describes the interaction between two hard spheres. For the square-well model, the pair potential is
\begin{align}
  v_\text{SW}(\1,\2) &=
    \begin{cases}
      \infty & r < \sigma \\
      -\epsilon & \sigma < r < \lambda\sigma \\
      0 & \lambda\sigma < r
    \end{cases}
\end{align}

Now, consider this to be the reference, and add a small perturbation:
\begin{align}
  v_\lambda(\1,\2) &= v_\text{SW}(\1,\2) + \lambda w(\1,\2) \label{eqn:small-perturbation}
\end{align}

The total potential energy of our system is
\begin{align}
  V_N(\lambda) = \sum_{i=1}^N\sum_{j>i}^N v_\lambda(\mathbf{r}_i,\mathbf{r}_j)
\end{align}

Given the \emph{configuration integral} (the potenial energy component of the partition function)
\begin{align}
  Z_N &= \int d\mathbf{r}^N\, e^{-\beta V_N}
\end{align}
and the non-ideal part of the free energy (i.e.~the excess free energy) is
\begin{align}
  F &= -\kT\ln\left( \frac{Z_N}{V^N} \right)
\end{align}
where $V^N$ is the total volume \fixme{I think?}, then the derivative of the excess free energy with respect to the coupling parameter $\lambda$ is
\begin{align}
  \frac{\partial F}{\partial\lambda} &= -\kT\left( \frac{1}{Z_N}\frac{\partial Z_N}{\partial\lambda} \right) \\
  &= -\kT\frac{1}{Z_N}\int d\mathbf{r}^N\, e^{-\beta V_N}(-\beta)\frac{\partial V_N}{\partial\lambda} \\
  \hookrightarrow \beta\frac{\partial F}{\partial\lambda} &= \beta\left\langle V_N^{'}(\lambda) \right\rangle_\lambda \\
  \hookrightarrow \beta F &= \beta F_0 + \beta\int_0^1 d\lambda\, \left\langle V_N^{'}(\lambda) \right\rangle_\lambda
\end{align}
where $\left\langle V_N^{'}(\lambda) \right\rangle_\lambda$ is the canonical ensemble average. We can take a series expansion of this average:
\begin{align}\begin{split} % too long; use split environment, and align to a space (&{})
  \left\langle V_N^{'}(\lambda) \right\rangle_\lambda = &{} \left\langle V_N^{'}(\lambda)\right\rangle_{\lambda = 0} + (\lambda)\frac{\partial}{\partial\lambda}\left\langle V_N^{'}(\lambda) \right\rangle_{\lambda}\bigg|_{\lambda = 0} \\ &{} + \mathcal{O}(\lambda^2)
\end{split}\end{align}
The derivative term is
\begin{align}
  \frac{\partial}{\partial\lambda}\left\langle V_N^{'}(\lambda) \right\rangle_{\lambda} &= \left\langle V_N^{''} \right\rangle_\lambda - \beta\sigma_\lambda^2
\end{align}
where
\begin{align}
  \sigma_\lambda^2 &\equiv \left\langle \left[ V_N^{'}(\lambda) \right]^2 \right\rangle_\lambda - \left\langle V_N^{'}(\lambda) \right\rangle^2_\lambda
\end{align}
Putting this together, we have
\begin{align}
  \begin{split}
    \beta F = &{} \beta F_0 + \beta(1 - 0)\left\langle V_N^{'}(\lambda) \right\rangle_{\lambda = 0} \\ &{} - \beta\frac{1}{2}(1 - 0)^2\left(\left\langle V_N^{''}(\lambda = 0) \right\rangle_{\lambda = 0} - \beta^2\sigma^2_{\lambda = 0} \right)
  \end{split} \\
  \begin{split}
    =&{}  \beta F_0 + \beta\left\langle V_N^{'}(\lambda) \right\rangle_{\lambda = 0} \\ &{} - \beta\frac{1}{2}\left(\left\langle V_N^{''}(\lambda = 0) \right\rangle_{\lambda = 0} - \beta^2\sigma^2_{\lambda = 0} \right) \label{eqn:complicated-HTE}
  \end{split}
\end{align}
Now, we can define the total perturbation energy as
\begin{align}
  W_N &= \sum_{i=1}^N\sum_{j>i}^N w_\lambda(\mathbf{r}_i,\mathbf{r}_j)
\end{align}
Then, following from equation~\ref{eqn:small-perturbation},
\begin{align}
  V_N^{'} &= \frac{\partial}{\partial\lambda}\left(\sum_{i=1}^N\sum_{j>i}^N \lambda w(\mathbf{r}_i,\mathbf{r}_j)\right) \nonumber \\
  &= W_N \\
  \therefore V_N^{''} &= 0
\end{align}
With this in mind, we can simplify equation~\ref{eqn:complicated-HTE} to the \emph{high-temperature expansion}, first derived by Zwanzig:\cite{Zwanzig54}
\begin{align}
  \begin{split}
    \beta F = &{} \beta F_0 + \beta\left\langle W_N \right\rangle_0  \\ &{} - \frac{1}{2}\beta^2\left( \left\langle W_N^2 \right\rangle_0 - \left\langle W_N \right\rangle_0^2 \right) + \mathcal{O}(\beta^3)
  \end{split}
\end{align}
Zwanzig further showed that the $n^{th}$ term could be written in terms of the mean fluctuations $\left\langle \left[ W_N - \left\langle W_N\right\rangle_0 \right]^\nu \right\rangle_0$ with $\nu \leq n$.

Writing the statistical averages in terms of the pair density $n_\lambda^{(2)}(\1,\2)$ (i.e. the probability of having a sphere at \1 and \2 \fixme{make this more clear?}) gives us
\begin{align}
  \frac{\beta F}{N} &= \frac{\beta F_0}{N} + \frac{\beta}{2N}\int_0^1 d\lambda\, \iint d\1 d\2\, n_\lambda^{(2)}(\1,\2)w(\1,\2) \label{eqn:Henderson5-2-12}
\end{align}
The pair density itself can be expanded as
\begin{align}
  n_\lambda^{(2)}(\1,\2) &= n_0^{(2)}(\1,\2) + \lambda\frac{\partial n_\lambda^{(2)}(\1,\2)}{\partial\lambda}\bigg|_{\lambda = 0} + \mathcal{O}(\lambda^2)
\end{align}
Applying this to the second term in equation~\ref{eqn:Henderson5-2-12}, we have
\begin{align}
  \frac{\beta F_1}{N} &= \frac{\beta}{2N}\iint d\1 d\2\, n_0^{(2)}(\1,\2)w(\1,\2) \\
  &= \frac{\beta n}{2}\int d\mathbf{r}_{12}\, g_0(\1,\2)
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}\label{sec:methods}

\subsection{Coexistence Curve Algorithm}\label{subsec:coexis}
Coexistence curves are found by modifying the chemical potential $\mu$
in the grand free energy per volume $\phi(T,n)/V$. Grand free energy
density is defined as
\begin{align}
  \frac{\Phi(T,n)}{V} &= \phi(T,n) \nonumber \\
                 &= f(T,n) - n\mu \nonumber \\
                 &= f(T,n) - n\frac{df(T,n)}{dn}\bigg|_{\npart}\ .
\end{align}
It is the value $\npart$ that we adjust to find coexistence curves.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{figs/SW-phi-lowT}
  \caption{Grand free energy per unit volume, SW, low temp}
  \label{fig:SW-phi-lowT}
\end{figure}

The grand free energy density generally has two distinct minima when
plotted versus density. (See fig.~\ref{fig:SW-phi-lowT} for an example.) The liquid will be in liquid-vapor equilibrium
when those minima have the same value for $\phi(T,n)$. There is a local
maximum between those minima, and the value of the density at that
maximum is used for $\npart$. Find this value at a given temperature
then plot $\phi(T,n)$ vs $n$ at slightly higher temperature. Find the new
value for $\npart$ such that the two minima have the same value for
$\phi(T,n)$. (It is helpful to note that if $\npart$ is increased,
$\phi(T,\nliq)$ increases, and $\phi(T,\nliq)$ decreases if $\npart$ is
decresed.) The program I wrote uses the previous
temperature's $\npart$ as a ``first guess,'' maximizing
$\phi(T,\npart)$. From there, the program adjusts $\npart$
until $\phi(T,\nvap) = \phi(T,\nliq)$. When that condition is met, it
uses this new value of $\npart$ as the ``first guess'' at $\npart$ for the next
higher temperature.

The algorithm is as follows; start at some temperature $T=T_{start}$, with an intial guess for $\npart$.
\begin{enumerate}
  \item Calculate $\nvap$ and $\nliq$ by calculating the minima in $\phi(T_{start},n)$ over appropriate regions
  \item Calculate $\phi(T_{start},\nvap)$ and $\phi(T_{start},\nliq)$ \label{while-start}
  \item Calculate \[\delta\mu = \frac{\phi(T_{start},\nvap) - \phi(T_{start},\nliq)}{\nliq - \nvap}\]
  \item Calculate $\phi^*(T_{start},n) = \phi(T_{start},n) + \delta\mu$
  \item Calculate a new $\npart$, $\npart^*$, based on $\phi^*(T_{start},n)$ by finding the local maximum between $\nvap$ and $\nliq$
  \item Calculate $\phi(T_{start},\npart^*)$
  \item Re-caluclate $\nvap$, $\nliq$, $\phi(T_{start},\nvap)$, and $\phi(T_{start},\nliq)$, using $\npart^*$
  \item Go back to step~\ref{while-start} and repeat until \[ \frac{\phi(T_{start},\nvap) - \phi(T_{start},\nliq)}{\phi(T_{start},\npart^*)} > tol  \] where $tol$ is some computational tolerance (I used $tol=10^{-5}$)
  \item Increase the temperature to $T = T + \delta T$ and repeat
\end{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results and discussion}

\begin{figure}
  \begin{center}
  \includegraphics[width=\columnwidth]{figs/coexistance_SW}
  \end{center}
  \caption{Liquid-vapor coexistance for a square well liquid.}
  \label{fig:coexistance_SW}
\end{figure}

\begin{figure}
  \begin{center}
  \includegraphics[width=\columnwidth]{figs/SW-RG-compare-phi-lowT}
  \end{center}
  \caption{Free energy density for RG at low temperature}
  \label{fig:SW-RG-compare-lowT}
\end{figure}

\begin{figure}
  \begin{center}
  \includegraphics[width=\columnwidth]{figs/SW-RG-compare-phi-highT}
  \end{center}
  \caption{Free energy density for RG near critical temp}
  \label{fig:SW-RG-compare-highT}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Conclusion}
I have implemented a the use of renormalization group theory in calculations for the square well liquid. The program is not entirely de-bugged. I have also developed an algorithm that calculates liqiud-vapor coexistence curves, even close to the critical point.


\bibliographystyle{unsrt}
\bibliography{project} % Produces the bibliography via BibTeX.

\end{document}

